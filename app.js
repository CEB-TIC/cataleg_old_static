!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("Pinia"),require("Vue"),require("VueRouter"),require("furaVue"),require("llescaVue"),require("pdfFonts"),require("pdfMake")):"function"==typeof define&&define.amd?define(["Pinia","Vue","VueRouter","furaVue","llescaVue","pdfFonts","pdfMake"],t):"object"==typeof exports?exports.app=t(require("Pinia"),require("Vue"),require("VueRouter"),require("furaVue"),require("llescaVue"),require("pdfFonts"),require("pdfMake")):e.app=t(e.Pinia,e.Vue,e.VueRouter,e.furaVue,e.llescaVue,e.pdfFonts,e.pdfMake)}(self,((e,t,a,n,i,l,o)=>(()=>{"use strict";var r={744:(e,t)=>{t.Z=(e,t)=>{const a=e.__vccOpts||e;for(const[e,n]of t)a[e]=n;return a}},713:t=>{t.exports=e},740:e=>{e.exports=t},88:e=>{e.exports=a},283:e=>{e.exports=n},111:e=>{e.exports=i},732:e=>{e.exports=l},525:e=>{e.exports=o}},d={};function s(e){var t=d[e];if(void 0!==t)return t.exports;var a=d[e]={exports:{}};return r[e](a,a.exports,s),a.exports}s.d=(e,t)=>{for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var u={};return(()=>{s.d(u,{default:()=>Kr});var e={};s.r(e),s.d(e,{getRoutes:()=>nl});var t={};s.r(t),s.d(t,{getRoutes:()=>fo});var a={};s.r(a),s.d(a,{getRoutes:()=>To});var n=s(740),i=s(713),l=s(283),o=s(111),r=s(88);function d(e){const t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),a=decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(a)}function c(e){if("string"==typeof e&&e){const t=d(e),a=1e3*t.exp,n=1e3*t.iat,i=Date.now();return n<i&&i<a}return!1}const m=(0,i.defineStore)({id:"session",state(){const e=localStorage.getItem("jwt");return{jwt:c(e)?e:null}},getters:{data:e=>function(e){if("string"==typeof e&&e){const t=d(e);return{name:t.unique_name,role:t.role}}return{name:null,role:null}}(e.jwt)},actions:{setJwt(e){"string"==typeof e&&e&&c(e)?(localStorage.setItem("jwt",e),this.jwt=e):(localStorage.removeItem("jwt"),this.jwt=null)}}}),p=[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Agent",type:"string",required:!0,maxlength:120},{name:"CODI",label:"Codi",type:"string",required:!0,maxlength:16},{name:"AGENTOROL",label:"Agent o Rol",type:"choice",options:["Agent","Rol"],required:!0,maxlength:12,defaultValue:"Agent"},{name:"ID_TIPUSAGENT",label:"Tipus",type:"dictionary",entityName:"TIPUSAGENT",required:!0},{name:"TIPUSDEPENDENCIA",label:"Tipus dependència",type:"choice",options:["Depén de","Staff de"],maxlength:12,defaultValue:"Depén de"},{name:"ID_DEPENDE",label:"Depen de",type:"lookupCache",entity:{name:"AGENT",navigationKey:"AGENT1",primaryKey:"ID",targetKey:"CODIINOM",cache:["ID_TIPUSAGENT"]},useFilter:e=>t=>e.ID_TIPUSAGENT&&t.ID_TIPUSAGENT===e.ID_TIPUSAGENT},{name:"CONTACTE",label:"Persona de Contacte",type:"string",maxlength:120},{name:"MAILCONTACTE",label:"Mail del contacte",type:"string",maxlength:120,pattern:/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/},{name:"COMENTARIS",label:"Comentaris",type:"string",maxlength:8e3,multiline:!0},{name:"ALTA",label:"Data alta",type:"date",defaultValue:()=>new Date(Date.now())},{name:"BAIXA",label:"Data de baixa",type:"date",defaultValue:()=>new Date(2099,11,31)},{name:"CODIINOM",label:"Codi i Nom Agent",type:"string",readonly:!0},{name:"AGENT_FORMATPER",label:"Format per",type:"lookupMultiCache",junction:{name:"AGENT_FORMATPER",primaryKey:"ID",ownerKey:"ID_AGENT",targetKey:"ID_AGENT_ROL"},data:{name:"AGENT",primaryKey:"ID",targetKey:"CODIINOM"}},{name:"CREATED",type:"date"},{name:"CREATEDBY",type:"string",maxlength:64},{name:"MODIFIED",type:"date"},{name:"MODIFIEDBY",type:"string",maxlength:64},{name:"VIGENT",label:"Vigent",type:"boolean",readonly:!0},{name:"AGENT1/odata.count",type:"childCount",navigationKey:"AGENT1",loadAlwaysInView:!0}],y={__name:"details-cell-boolean",props:{field:{type:Object,default:void 0},row:{type:Object,default:void 0}},setup(e){const t=e,a=(0,n.computed)((()=>t.row[t.field.name]));return(e,t)=>{const i=(0,n.resolveComponent)("fura-icon");return(0,n.openBlock)(),(0,n.createElementBlock)("div",null,[!0===(0,n.unref)(a)||1===(0,n.unref)(a)?((0,n.openBlock)(),(0,n.createBlock)(i,{key:0,class:"detailsCellBoolean-true",name:"CheckMark"})):((0,n.openBlock)(),(0,n.createBlock)(i,{key:1,class:"detailsCellBoolean-false",name:"Cancel"}))])}}};var I=s(744);const f=(0,I.Z)(y,[["__scopeId","data-v-3f173500"]]),E={__name:"form-field-boolean",props:{label:{type:String,default:void 0},boxSide:{type:String,default:void 0},disabled:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},nullable:{type:Boolean,default:void 0},align:{type:String,default:void 0,validator:e=>!e||["left","center","right"].includes(e)}},emits:["change"],setup(e,{emit:t}){const a=e;a.validations?.createField(a.name??a.field.name,(0,n.computed)((()=>a.entity[a.name??a.field.name])));const i=(0,n.computed)((()=>(a.nullable??a.field.nullable)&&null===a.entity[a.name??a.field.name])),l=(0,n.computed)((()=>{const e=a.align??a.field.align;return["left","center","right"].includes(e)?`formFieldBoolean-${e}`:null}));function o(e){const n=a.name??a.field.name;t("change",(t=>{t[n]=e}))}return(0,n.watch)([()=>a.disabled,()=>a.field?.disabled],(([e,n])=>{if(null!=(e??n)&&(a.clearValueOnDisabled??a.field.clearValueOnDisabled)){const e=a.name??a.field.name;a.nullable??a.field.nullable?t("change",(t=>{t[e]=null})):t("change",(t=>{t[e]=!1}))}})),(t,a)=>{const r=(0,n.resolveComponent)("fura-checkbox");return(0,n.openBlock)(),(0,n.createElementBlock)("div",{class:(0,n.normalizeClass)((0,n.unref)(l))},[(0,n.createVNode)(r,{label:e.label??e.field.label,"box-side":e.boxSide??e.field.boxSide,disabled:e.disabled??e.field.disabled,readonly:e.readonly??e.field.readonly,indeterminate:(0,n.unref)(i),"model-value":e.entity[e.name??e.field.name],"onUpdate:modelValue":o},null,8,["label","box-side","disabled","readonly","indeterminate","model-value"])],2)}}},A=(0,I.Z)(E,[["__scopeId","data-v-2f45898e"]]),T={__name:"grid-field-boolean",props:{boxSide:{type:String,default:void 0},disabled:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},nullable:{type:Boolean,default:void 0},alignGrid:{type:String,default:"center"}},emits:["change"],setup(e,{emit:t}){const a=e;return(i,l)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(A),(0,n.mergeProps)({...a,label:""},{align:e.alignGrid??e.field.alignGrid,class:"field",onChange:l[0]||(l[0]=e=>t("change",e))}),null,16,["align"]))}};function C(e,t){return t[e.name]?"Sí":!1===t[e.name]?"No":""}const D={detailsCell:f,formField:A,gridField:(0,I.Z)(T,[["__scopeId","data-v-1198e7f8"]]),getDetailsODataQuery:e=>({$select:e.name}),getOrderbySentence:e=>e.name,getFilterCondition(e){if("eq"===e.operation)return`${e.name} eq @${e.name}`},getFilterInterface(e){if("eq"===e.operation)return{type:"checkbox",name:e.name,label:e.label}},getPropertyDefinition:(e,t)=>({keys:[e.name]}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):"boolean"==typeof e.defaultValue&&(t[e.name]=e.defaultValue))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity:C,getCsvValueFromEntity:C},N={eq:40,ne:30,gt:70,ge:50,lt:80,le:60,and:20,or:10,add:100,sub:90,mul:130,div:120,mod:110,has:150,in:140},g=Object.keys(N),v=["cast","ceiling","concat","contains","date","day","endswith","fractionalseconds","floor","hassubsequence","hassubset","hour","indexof","isof","length","matchesPattern","maxdatetime","mindatetime","minute","month","now","replace","round","second","startswith","substring","substringof","time","tolower","totaloffsetminutes","totalseconds","toupper","trim","year"],O=["all","any"];class S extends Error{constructor(e,t,a){super(`${e}. Starting at position ${t} and ending at ${a}.`),this.displayMessage=e,this.indexStart=t,this.indexEnd=a}}const b=new RegExp(`^(${g.join("|")})\\b`,"i"),h=new RegExp(`^(${v.join("|")})\\b`,"i"),R=new RegExp(`^(${["not","true","false","null","NaN","INF"].join("|")})\\b`);function _(e){return function(t,a){const n=t.substring(a),[i]=n.match(e);return{value:i,newIndex:a+i.length}}}const M=[{name:"EOS",test:(e,t)=>t>=e.length,reader:(e,t)=>({value:null,newIndex:e.length})},{name:"WHITESPACE",test:(e,t)=>/\s/.test(e[t]??""),reader:_(/^(\s+)/)},{name:"LITERAL",test:(e,t)=>"$"===e[t],reader:_(/^(\$[a-zA-Z]\w+)/)},{name:"ALIAS",test:(e,t)=>"@"===e[t],reader:_(/^(@[a-zA-Z]\w+)/)},{name:"GUID",test:(e,t)=>/^\d{8}-\d{4}-\d{4}-\d{4}-\d{12}/.test(e.substring(t)),reader:_(/^(\d{8}-\d{4}-\d{4}-\d{4}-\d{12})/)},{name:"DATE",test:(e,t)=>/^\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+(?:[+-][0-2]\d:[0-5]\d|Z)/.test(e.substring(t)),reader:function(e,t){const a=_(/^(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+(?:[+-][0-2]\d:[0-5]\d|Z))/)(e,t);return a.value=new Date(a.value),a}},{name:"NUMBER",test:(e,t)=>/^-?\d/.test(e.substring(t)),reader:function(e,t){const a=_(/^(-?\d+(?:\.\d+)?(?:e-?\d+)?)/)(e,t);return a.value=Number(a.value),a}},{name:"PUNCTUATION",test:(e,t)=>["/","(",")","[","]",",",".",":","-"].includes(e[t]),reader:(e,t)=>({value:e[t],newIndex:t+1})},{name:"STRING",test:(e,t)=>"'"===e[t],reader:function(e,t){let a="",n=t+1,i=!0;for(;i;){if(n>=e.length)throw new S("Unclosed string",t,n);const l=e[n];n+=1,"'"===l?"'"===e[n]?(a+="'",n+=1):i=!1:a+=l}return{value:a,newIndex:n}}},{name:"OPERATOR",test:(e,t)=>b.test(e.substring(t)),reader:_(b)},{name:"FUNCTION",test:(e,t)=>h.test(e.substring(t)),reader:_(h)},{name:"KEYWORD",test:(e,t)=>R.test(e.substring(t)),reader:_(R)},{name:"NAME",test:(e,t)=>/[a-zA-Z]/.test(e[t]??""),reader:_(/^\w*/)}];function x(e,t){for(const a of M)if(a.test(e,t)){const{value:n,newIndex:i}=a.reader(e,t);return{type:a.name,value:n,indexStart:Math.min(t,e.length),indexEnd:i}}throw new S(`Unexpected character '${e[t]}'`,t,t+1)}function L(e,t){let a=x(e,t);for(;"WHITESPACE"===a.type;)a=x(e,a.indexEnd);return a}function P(e){return w(e)}function w(e){if(e.check("PUNCTUATION","(")){e.advance("PUNCTUATION","(");const t=V(e);return e.advance("PUNCTUATION",")"),t}if(e.check("PUNCTUATION","[")){e.advance("PUNCTUATION","[");const t=V(e);return e.advance("PUNCTUATION","]"),t}if(e.check("KEYWORD",["true","false"]))return function(e){return{type:"boolean",value:e.advance("KEYWORD",["true","false"]).value}}(e);if(e.check("KEYWORD",["null","NaN","INF"]))return function(e){return{type:"constant",value:e.advance("KEYWORD",["null","NaN","INF"]).value}}(e);if(e.check("DATE"))return function(e){return{type:"date",value:e.advance("DATE").value}}(e);if(e.check("NUMBER"))return function(e){return{type:"number",value:e.advance("NUMBER").value}}(e);if(e.check("GUID"))return function(e){return{type:"guid",value:e.advance("GUID").value}}(e);if(e.check("STRING"))return function(e){return{type:"string",value:e.advance("STRING").value}}(e);if(e.check("ALIAS"))return function(e){return{type:"alias",value:e.advance("ALIAS").value}}(e);if(e.check("PUNCTUATION","-")||e.check("KEYWORD","not"))return function(e){return e.check("PUNCTUATION","-")?e.advance("PUNCTUATION","-"):e.check("KEYWORD","not")&&e.advance("KEYWORD","not"),{type:"negative",value:w(e)}}(e);if(e.check("FUNCTION"))return function(e){const t=e.advance("FUNCTION"),a=function(e){const t=[];let a=!0;for(e.advance("PUNCTUATION","(");!e.check("EOS")&&!e.check("PUNCTUATION",")");)a?a=!1:e.advance("PUNCTUATION",","),t.push(P(e));return e.advance("PUNCTUATION",")"),t}(e);return{type:"functionCall",name:t.value,parameters:a}}(e);if(e.check("NAME")||e.check("LITERAL"))return function(e){const t=[];for(;e.check(["NAME","LITERAL"])&&e.checkNext("PUNCTUATION","/");)t.push(e.advance(["NAME","LITERAL"]).value),e.advance("PUNCTUATION","/");if(O.some((t=>e.check("NAME",t)))&&e.checkNext("PUNCTUATION","(")){const a=e.advance("NAME").value;e.advance("PUNCTUATION","(");const n=e.advance("NAME").value;e.advance("PUNCTUATION",":");const i=U(e);return e.advance("PUNCTUATION",")"),{type:"lambda",navigation:t.length>0?t:null,operation:a,name:n,expression:i}}if(e.check("NAME"))return{type:"property",navigation:t.length>0?t:null,value:e.advance("NAME").value};if(e.check("LITERAL"))return{type:"literal",navigation:t.length>0?t:null,value:e.advance("LITERAL").value};throw new S(`Unexpected token ${e.current.type}.`,e.current.indexStart,e.current.indexEnd)}(e);throw new S(`Unexpected token ${e.current.type}.`,e.current.indexStart,e.current.indexEnd)}function V(e){const t=[U(e)];for(;e.check("PUNCTUATION",",");)e.advance("PUNCTUATION",","),t.push(U(e));return{type:"collection",value:t}}function B(e,t,a=0){if(e.check("OPERATOR")){const n=N[e.current.value];if(n>a){const i=e.advance("OPERATOR").value,l=B(e,w(e),n);return B(e,{type:"binaryOp",operator:i,left:t,right:l},a)}}return t}function U(e){if(e.check("PUNCTUATION","(")){e.advance("PUNCTUATION","(");const t=V(e);return e.advance("PUNCTUATION",")"),B(e,t)}if(e.check("PUNCTUATION","[")){e.advance("PUNCTUATION","[");const t=V(e);return e.advance("PUNCTUATION","]"),B(e,t)}return B(e,w(e))}const k={collection:e=>1===e.value.length?q(e.value[0]):e.value.map(q),boolean(e){if("true"===e.value)return!0;if("false"===e.value)return!1;throw new Error},constant(e){if("null"===e.value)return null;if("NaN"===e.value)return NaN;if("INF"===e.value)return Number.POSITIVE_INFINITY;throw new Error},date:e=>e.value,number:e=>e.value,string:e=>e.value,guid:e=>({guid:e.value}),alias:e=>({alias:e.value}),negative:e=>({not:F(e.value)}),functionCall:e=>({[e.name]:e.parameters.map(F)}),lambda:e=>({lambda:e.operation,path:e.navigation?.join("/"),name:e.name,expression:q(e.expression)}),property:e=>({property:Array.isArray(e.navigation)?[...e.navigation,e.value].join("/"):e.value}),literal:e=>({literal:Array.isArray(e.navigation)?[...e.navigation,e.value].join("/"):e.value})};function F(e){return Array.isArray(e)?e.map((e=>q(e))):e.type in k?k[e.type](e):void 0}function $(e){if(["and","or","add","sub","mul","div"].includes(e.operator)){const t=[],a=a=>"binaryOp"===a.type&&a.operator===e.operator?t.push(...$(a)[e.operator]):t.push(q(a));return a(e.left),a(e.right),{[e.operator]:t}}return{[e.operator]:[q(e.left),q(e.right)]}}function q(e){return"collection"===e.type?1===e.value.length&&["binaryOp","collection","lambda","functionCall"].includes(e.value[0].type)?q(e.value[0]):e.value.map(q):"binaryOp"===e.type?$(e):F(e)}function K(e){const t=function(e){let t=0,a=L(e,t),n=L(e,a.indexEnd);return t=n.indexEnd,{get current(){return a},get next(){return n},check(e,t){if(null!=e){if(Array.isArray(e))return e.includes(a.type);if(e!==a.type)return!1}if(null!=t){if(Array.isArray(t))return t.includes(a.value);if(t!==a.value)return!1}return!0},checkNext(e,t){if(null!=e){if(Array.isArray(e))return e.includes(n.type);if(e!==n.type)return!1}if(null!=t){if(Array.isArray(t))return t.includes(n.value);if(t!==n.value)return!1}return!0},advance(i,l){if(null!=i)if(Array.isArray(i)){if(!i.includes(a.type))throw new S(`Expected a token with a set of types, but found '${a.type}'`,a.indexStart,a.indexEnd)}else if(a.type!==i)throw new S(`Expected a token with type '${i}', but found '${a.type}'`,a.indexStart,a.indexEnd);if(null!=l)if(Array.isArray(l)){if(!l.includes(a.value))throw new S(`Expected a token with a set of values, but found '${a.value}'`,a.indexStart,a.indexEnd)}else if(a.value!==l)throw new S(`Expected a token with value '${l}', but found '${a.value}'`,a.indexStart,a.indexEnd);const o=a;return a=n,n=L(e,t),t=n.indexEnd,o},advanceIfExists(e,t){if(e&&a.type!==e)return null;if(null!=t)if(Array.isArray(t)){if(!t.includes(a.value))return null}else if(a.value!==t)return null;return this.advance(e,t)}}}(e);var a;return q(B(a=t,U(a)))}function G(e,t){if(void 0===e||"symbol"==typeof e)return;if(null===e)return"null";if(e===Number.POSITIVE_INFINITY)return"INF";if(e===isNaN)return"NaN";if(e instanceof Date)return e.toISOString();if("string"==typeof e)return e.includes("'")?`'${e.replace(/'/g,"''")}'`:`'${e}'`;if("number"==typeof e||"bigint"==typeof e||"boolean"==typeof e)return String(e);if(e.not)return"-"+G(e.not,t);if(Array.isArray(e))return`(${e.map((e=>G(e,t))).join()})`;if(e.lambda)return`${e.path}/${e.lambda}(${e.name}:${G(e.expression,t)})`;if(e.guid)return e.guid;if(e.alias){const a=e.alias.substring(1),n=Array.isArray(t)&&t.find((([e])=>e===a));return n?G(n[1],t):e.alias}if(e.property)return e.property;if(e.literal)return e.literal;const a=v.find((t=>t in e));if(a)return Array.isArray(e[a])?`${a}(${e[a].map((e=>G(e,t))).join()})`:`${a}(${G(e[a],t)})`;const n=g.find((t=>t in e));if(n)return`(${e[n].map((e=>G(e,t))).join(` ${n} `)})`;throw new Error("El filtro odata no se reconoce.")}const j={collection(e,t,a,n){for(let i=0;i<e.length;i+=1)if(z(e[i],t,a,[...n,i]))return!0},negative(e,t,a,n){if("pre"===a.order){if(t(e,n))return!0;if(z(e.not,t,a,[...n,"not"]))return!0}else if("post"===a.order){if(z(e.not,t,a,[...n,"not"]))return!0;if(t(e,n))return!0}},functionCall(e,t,a,n){const i=v.find((t=>t in e));if("pre"===a.order){if(t(e,n))return!0;if(j.collection(e[i],t,a,[...n,i]))return!0}else if("post"===a.order){if(j.collection(e[i],t,a,[...n,i]))return!0;if(t(e,n))return!0}},lambda(e,t,a,n){const i=`${e.path}/${e.lambda}`;if("pre"===a.order){if(t(e,n))return!0;if(z(e.expression,t,a,[...n,i]))return!0}else if("post"===a.order){if(z(e.expression,t,a,[...n,i]))return!0;if(t(e,n))return!0}},operators(e,t,a,n){const i=g.find((t=>t in e));if("pre"===a.order){if(t(e,n))return!0;if(j.collection(e[i],t,a,[...n,i]))return!0}else if("post"===a.order){if(j.collection(e[i],t,a,[...n,i]))return!0;if(t(e,n))return!0}}};function z(e,t,a={order:"post"},n=[]){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e||e===isNaN||e===Number.POSITIVE_INFINITY||e instanceof Date||e.guid||e.alias||e.property||e.literal?t(e,n):Array.isArray(e)?j.collection(e,t,a,n):e.not?j.negative(e,t,a,n):v.some((t=>t in e))?j.functionCall(e,t,a,n):e.lambda?j.lambda(e,t,a,n):g.some((t=>t in e))?j.operators(e,t,a,n):void 0}function W(e,t,a){if(Array.isArray(a)&&"string"==typeof e?.alias&&1===Object.keys(e).length)return a.push([e.alias.substring(1),t]),!0;if(typeof e==typeof t){if(Array.isArray(e)&&Array.isArray(t)&&e.length===t.length){const n=Array.isArray(a)?[]:null;let i=!0;for(let a=0;a<e.length;a+=1){const l=W(e[a],t[a],n);if(!1===l)return!1;Array.isArray(l)&&(i=l)}return i&&n?.length>0&&a.push(...n),i}if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();if("object"==typeof e){const n=Object.keys(e),i=Object.keys(t);if(n.length===i.length&&n.every((e=>i.includes(e)))){const i=Array.isArray(a)?[]:null;let l=!0;for(const a of n){const n=W(e[a],t[a],i);if(!1===n)return!1;Array.isArray(n)&&(l=n)}return l&&i?.length>0&&a.push(...i),l}}return e===t}return!1}class Y{constructor(e,t=null){this.conditions=[];for(const t of e)if(t instanceof Y)this.conditions.push(t);else{if("string"!=typeof t)throw new Error;{const e=K(t),a=[];z(e,((e,t)=>{e.alias&&a.push({name:e.alias.substring(1),path:e.path})})),this.conditions.push({filter:t,structure:e,aliases:a})}}this.aggrupationOperation=t}getConditionValue(e){const t=[];for(const a of this.conditions)if(a instanceof Y){const n=a.getConditionValue(e);n.length>0&&t.push(...n)}else W(a.structure,e,t);return t}readFilter(e){if(!this.aggrupationOperation)throw new Error;const t=[];if(e){const a=K(e),n=Array.isArray(a[this.aggrupationOperation])?[a,...a[this.aggrupationOperation]]:[a];for(const e of n){const a=this.getConditionValue(e);a.length>0&&t.push(...a)}}return t}findValuesInFilter(e){const t=[];return z(K(e),(e=>{const a=this.getConditionValue(e);a.length>0&&t.push(...a)})),t}writeFilter(e){if(!this.aggrupationOperation)throw new Error;const t=[];for(const a of this.conditions)if(a instanceof Y){const n=a.writeFilter(e);n&&t.push(n)}else a.aliases.every((t=>e.some((([e])=>t.name===e))))&&t.push(G(a.structure,e));return t.length>0?`(${t.join(` ${this.aggrupationOperation} `)})`:""}}const X=["textContent"],H={__name:"details-cell-generic",props:{field:{type:Object,default:void 0},row:{type:Object,default:void 0}},setup(e){const t=e,a=(0,n.ref)("");return(0,n.watchEffect)((async()=>{if(t.field&&t.row){const e=Dt[t.field.type];a.value="function"==typeof e?.getTextValueFromEntity?await e.getTextValueFromEntity(t.field,t.row):t.row[t.field.name]}else a.value=""})),(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",{textContent:(0,n.toDisplayString)(a.value)},null,8,X))}},Z=(0,I.Z)(H,[["__scopeId","data-v-29f5092a"]]);function J(e,t){return t[e.navigationKey]?.["@odata.count"]??""}const Q={detailsCell:Z,getDetailsODataQuery:e=>({$expand:`${e.navigationKey}($count=true;$top=0)`}),getOrderbySentence:e=>`${e.navigationKey}/$count`,getFilterCondition:e=>"eq"===e.operation?`${e.navigationKey}/$count eq @${e.name}`:"between"===e.operation?new Y([`${e.navigationKey}/$count gt @${e.name}_gt`,`${e.navigationKey}/$count lt @${e.name}_lt`],"and"):void 0,getFilterInterface:e=>"eq"===e.operation?{type:"number",name:e.name,label:e.label}:"between"===e.operation?[{type:"number",name:`${e.name}_gt`,label:`${e.label} Menor`},{type:"number",name:`${e.name}_lt`,label:`${e.label} Major`}]:void 0,getTextValueFromEntity:J,getCsvValueFromEntity:J},ee={__name:"form-field-choice",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},options:{type:Array,default:void 0},placeholder:{type:String,default:void 0},readonly:{type:Boolean,default:void 0},immediateScroll:{type:Boolean,default:void 0},createField:{type:Function,default:void 0},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,i=(0,n.computed)((()=>(a.options||a.field.options).map((e=>"string"==typeof e?{value:e,text:e}:e))));function l(e){const n=a.name??a.field.name;t("change",(t=>{t[n]=e}))}return(a,o)=>{const r=(0,n.resolveComponent)("llesca-field-dropdown");return(0,n.openBlock)(),(0,n.createBlock)(r,{label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,options:(0,n.unref)(i),placeholder:e.placeholder??e.field.placeholder,readonly:e.readonly??e.field.readonly,"immediate-scroll":e.immediateScroll??e.field.immediateScroll,"create-field":e.validations?.createField,name:e.name??e.field.name,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,"model-value":e.entity[e.name??e.field.name],"onUpdate:modelValue":l,onFocus:o[0]||(o[0]=e=>t("focus",e)),onBlur:o[1]||(o[1]=e=>t("blur",e))},null,8,["label","description","invalid","borderless","underlined","options","placeholder","readonly","immediate-scroll","create-field","name","required","disabled","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","model-value"])}}};function te({focusHandler:e,blurHandler:t,$emit:a}={}){const i=(0,n.ref)(!1),l=(0,n.computed)((()=>!i.value));return{focus:i,borderless:l,handleFocus(t){i.value=!0,e?.(t),a?.("focus",t)},handleBlur(e){i.value=!1,t?.(e),a?.("blur",e)}}}const ae={__name:"grid-field-choice",props:{invalid:{type:Boolean,default:void 0},options:{type:Array,default:void 0},placeholder:{type:String,default:void 0},readonly:{type:Boolean,default:void 0},immediateScroll:{type:Boolean,default:void 0},createField:{type:Function,default:void 0},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:i,handleFocus:l,handleBlur:o}=te({$emit:t});return(e,r)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(ee),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(i),description:null,underlined:!1,onChange:r[0]||(r[0]=e=>t("change",e)),onFocus:(0,n.unref)(l),onBlur:(0,n.unref)(o)}),null,16,["borderless","onFocus","onBlur"]))}};function ne(e,t){return t[e.name]??""}const ie={detailsCell:Z,formField:ee,gridField:(0,I.Z)(ae,[["__scopeId","data-v-ce6a5b82"]]),getDetailsODataQuery:e=>({$select:e.name}),getOrderbySentence:e=>e.name,getFilterCondition:e=>"eq"===e.operation?`${e.name} eq @${e.name}`:"in"===e.operation?`${e.name} in @${e.name}`:void 0,getFilterInterface(e){if(["eq","in"].includes(e.operation))return{type:"combo",name:e.name,label:e.label,multiple:"in"===e.operation}},loadCache:async e=>e.options.map((e=>"string"==typeof e?{value:e,text:e}:e)),getPropertyDefinition:(e,t)=>({keys:[e.name]}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):null!=e.defaultValue&&(t[e.name]=e.defaultValue))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity:ne,getCsvValueFromEntity:ne},le={__name:"form-field-date",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},notWritable:{type:Boolean,default:void 0},days:{type:Array,default:void 0},months:{type:Array,default:void 0},goToday:{type:String,default:void 0},firstDayOfTheWeek:{type:Number,default:void 0},today:{type:Date,default:void 0},parse:{type:Function,default:void 0},stringifyFocus:{type:Function,default:void 0},createField:{type:Function,default:void 0},stringify:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},min:{type:Date,default:void 0},max:{type:Date,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e;function i(e){const n=a.name??a.field.name;t("change",(t=>{t[n]=e}))}return(a,l)=>{const o=(0,n.resolveComponent)("llesca-field-date");return(0,n.openBlock)(),(0,n.createBlock)(o,{label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,readonly:e.readonly??e.field.readonly,placeholder:e.placeholder??e.field.placeholder,"not-writable":e.notWritable??e.field.notWritable,days:e.days??e.field.days,months:e.months??e.field.months,"go-today":e.goToday??e.field.goToday,"first-day-of-the-week":e.firstDayOfTheWeek??e.field.firstDayOfTheWeek,today:e.today??e.field.today,parse:e.parse??e.field.parse,"stringify-focus":e.stringifyFocus??e.field.stringifyFocus,stringify:e.stringify??e.field.stringify,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,min:e.min??e.field.min,max:e.max??e.field.max,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,name:e.name??e.field.name,"create-field":e.validations?.createField,"model-value":e.entity[e.name??e.field.name],"onUpdate:modelValue":i,onFocus:l[0]||(l[0]=e=>t("focus",e)),onBlur:l[1]||(l[1]=e=>t("blur",e))},null,8,["label","description","invalid","borderless","underlined","readonly","placeholder","not-writable","days","months","go-today","first-day-of-the-week","today","parse","stringify-focus","stringify","required","disabled","min","max","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","name","create-field","model-value"])}}},oe={__name:"grid-field-date",props:{invalid:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},notWritable:{type:Boolean,default:void 0},days:{type:Array,default:void 0},months:{type:Array,default:void 0},goToday:{type:String,default:void 0},firstDayOfTheWeek:{type:Number,default:void 0},today:{type:Date,default:void 0},parse:{type:Function,default:void 0},stringifyFocus:{type:Function,default:void 0},createField:{type:Function,default:void 0},stringify:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},min:{type:Date,default:void 0},max:{type:Date,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:i,handleFocus:l,handleBlur:o}=te({$emit:t});return(e,r)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(le),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(i),description:null,underlined:!1,onChange:r[0]||(r[0]=e=>t("change",e)),onFocus:(0,n.unref)(l),onBlur:(0,n.unref)(o)}),null,16,["borderless","onFocus","onBlur"]))}};function re(e,t=2){return e.toString().padStart(t,"0")}function de(e,t){if(!t[e.name])return"";const a=new Date(t[e.name]);return a?`${re(a.getDate())}/${re(a.getMonth()+1)}/${re(a.getFullYear(),4)}`:void 0}const se={detailsCell:Z,formField:le,gridField:(0,I.Z)(oe,[["__scopeId","data-v-1980b3b4"]]),getDetailsODataQuery:e=>({$select:e.name}),getOrderbySentence:e=>e.name,getFilterCondition:e=>"eq"===e.operation?`${e.name} eq @${e.name}`:"between"===e.operation?new Y([`${e.name} gt @${e.name}_gt`,`${e.name} lt @${e.name}_lt`],"and"):void 0,getFilterInterface:e=>"eq"===e.operation?{type:"date",name:e.name,label:e.label}:"between"===e.operation?[{type:"date",name:`${e.name}_gt`,label:`${e.label} Menor`},{type:"date",name:`${e.name}_lt`,label:`${e.label} Major`}]:void 0,getPropertyDefinition:(e,t)=>({keys:[e.name],dateKeys:[e.name]}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):e.defaultValue instanceof Date&&(t[e.name]=new Date(e.defaultValue.getTime())))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity:de,getCsvValueFromEntity:de},ue=(0,i.defineStore)({id:"dialog",state:()=>({loading:new Set,alertList:[],confirmList:[]}),actions:{loadStart(e){this.loading.add(e)},loadEnd(e){this.loading.delete(e)},alert(e){this.alertList.push(e)},alertClose(){const e=this.alertList.shift();if("function"==typeof e?.close)return e.close()},confirm(e){this.confirmList.push(e)},confirmAccept(){const e=this.confirmList.shift();if("function"==typeof e?.accept)return e.accept()},confirmCancel(){const e=this.confirmList.shift();if("function"==typeof e?.cancel)return e.cancel()}}}),ce="cataleg",me="Sistema de Govern de la Informació",pe="https://car-pro-wa.azurewebsites.net",ye="LLESCA_VIEW",Ie="ID",fe="ENTITY",Ee="VIEWNAME",Ae="DEF_VIEW",Te="DEFAULT_VIEW",Ce="/home";async function De(e,t,a){const n=ue();a||n.loadStart(e);try{const a=await t();return n.loadEnd(e),a}catch(t){throw n.loadEnd(e),t}}function Ne(e,t,a={},{withoutDialog:n=!1}={}){return De(Symbol("requestGet"),(()=>o.odata.requestGet([pe,e].flat(),t,{Authorization:m().jwt,...a})),n)}function ge(e,t,a={},{withoutDialog:n=!1}={}){return De(Symbol("requestDelete"),(()=>o.odata.requestDelete([pe,e].flat(),t,{Authorization:m().jwt,...a})),n)}function ve(e){const t=[],a=[];for(const n of e){const i=Dt[n.type];if(i){const l=i.getDetailsODataQuery(n,e);l.$select&&!t.includes(l.$select)&&t.push(l.$select),!l.$expand||a.includes(l.$expand)||a.some((e=>e.startsWith(l.$expand)||l.$expand.startsWith(e)))||a.push(l.$expand)}}return{$select:t.length>0?t:void 0,$expand:a.length>0?a:void 0}}function Oe(e){return Dt[e.type]?.getOrderbySentence(e)}function Se(e,t,{notOverwrite:a}={}){for(const n of e.fields)Dt[n.type].setDetaultValueToEntity?.(n,t,{notOverwrite:a})}function be(e){return Object.fromEntries(Ti().filter((e=>"dictionary"===e.type)).map((t=>[t.name,"function"==typeof e?e():e])))}const he=(0,i.defineStore)({id:"dictionary",state:()=>({data:be(null),loading:be((()=>({state:!1,callbacks:null})))}),actions:{loadDictionary(e,{force:t=!1}={}){const a=(0,n.unref)(e);if(Ti(a)&&"dictionary"===Ti(a).type){if(this.loading[a].state)return new Promise((e=>{this.loading[a].callbacks.push(e)}));if(!this.data[a]||t)return new Promise((e=>{const t=ue();this.loading[a].state=!0,this.loading[a].callbacks=[],t.loadStart(`dictionary/${a}/load`),Ne(a,{...ve(Ti(a).fields)}).then((n=>{this.data[a]=n.value,t.loadEnd(`dictionary/${a}/load`);const i=[e,...this.loading[a].callbacks];this.loading[a].state=!1,this.loading[a].callbacks=null,i.forEach((e=>e()))}))}))}return Promise.resolve()}}});function Re(e,t){const a=(0,n.shallowRef)([]);return(0,n.watchEffect)((()=>{const i=e.filter??e.field?.filter,l=e.useFilter??e.field?.useFilter;a.value="function"==typeof i?(0,n.unref)(t).filter(i):"function"==typeof l?(0,n.unref)(t).filter(l(e.entity)):(0,n.unref)(t)})),{filteredData:a}}const _e={__name:"form-field-dictionary",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},createField:{type:Function,default:void 0},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},entityName:{type:String,default:void 0},filter:{type:Function,default:void 0},useFilter:{type:Function,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,i=he(),l=(0,n.computed)((()=>a.entityName??a.field.entityName)),o=(0,n.shallowRef)([]);(0,n.watch)(l,(async e=>{await i.loadDictionary(e),o.value=i.data[e]}),{immediate:!0});const{filteredData:r}=Re(a,o),d=(0,n.computed)((()=>Ti(l.value))),s=(0,n.computed)((()=>d.value.fields.find((e=>e.primary)).name)),u=(0,n.computed)((()=>d.value.fields.find((e=>e.defaultField)).name)),c=(0,n.computed)((()=>r.value.map((e=>({value:e[s.value],text:e[u.value]})))));function m(e){const n=a.name??a.field.name;t("change",(t=>{t[n]=e}))}return(a,i)=>{const l=(0,n.resolveComponent)("llesca-field-combo");return(0,n.openBlock)(),(0,n.createBlock)(l,{label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,readonly:e.readonly??e.field.readonly,"allow-freeform":e.allowFreeform??e.field.allowFreeform,"auto-complete":e.autoComplete??e.field.autoComplete,"accent-insensitive":e.accentInsensitive??e.field.accentInsensitive,placeholder:e.placeholder??e.field.placeholder,"immediate-scroll":e.immediateScroll??e.field.immediateScroll,"create-field":e.validations?.createField,name:e.name??e.field.name,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,options:(0,n.unref)(c),"model-value":e.entity[e.name??e.field.name],"onUpdate:modelValue":m,onFocus:i[0]||(i[0]=e=>t("focus",e)),onBlur:i[1]||(i[1]=e=>t("blur",e))},null,8,["label","description","invalid","borderless","underlined","readonly","allow-freeform","auto-complete","accent-insensitive","placeholder","immediate-scroll","create-field","name","required","disabled","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","options","model-value"])}}},Me={__name:"grid-field-dictionary",props:{invalid:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},createField:{type:Function,default:void 0},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},entityName:{type:String,default:void 0},filter:{type:Function,default:void 0},useFilter:{type:Function,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:i,handleFocus:l,handleBlur:o}=te({$emit:t});return(r,d)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(_e),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(i),description:null,underlined:!1,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,onChange:d[0]||(d[0]=e=>t("change",e)),onFocus:(0,n.unref)(l),onBlur:(0,n.unref)(o)}),null,16,["borderless","clear-value-on-disabled","onFocus","onBlur"]))}};async function xe(e,t){const a=he();await a.loadDictionary(e.entityName);const n=Ti(e.entityName),i=n.fields.find((e=>e.primary)).name,l=n.fields.find((e=>e.defaultField)).name,o=t[e.name],r=a.data[e.entityName]?.find((e=>e[i]===o));return r?.[l]??""}const Le={detailsCell:Z,formField:_e,gridField:(0,I.Z)(Me,[["__scopeId","data-v-52de4e9c"]]),getDetailsODataQuery:e=>({$select:e.name}),getOrderbySentence:e=>`${e.navigationKey||e.entityName}/${Ti(e.entityName).fields.find((e=>e.defaultField)).name}`,getFilterCondition:e=>"eq"===e.operation?`${e.name} eq @${e.name}`:"in"===e.operation?`${e.name} in @${e.name}`:"contains"===e.operation?`contains(${e.navigationKey||e.entityName}/${Ti(e.entityName).fields.find((e=>e.defaultField)).name}, @${e.name})`:void 0,getFilterInterface(e){if("eq"===e.operation){const t=Ti(e.entityName);return{type:"combo",name:e.name,label:e.label,valueKey:t.fields.find((e=>e.primary)).name,textKey:t.fields.find((e=>e.defaultField)).name}}if("in"===e.operation){const t=Ti(e.entityName);return{type:"combo",name:e.name,label:e.label,multiple:!0,valueKey:t.fields.find((e=>e.primary)).name,textKey:t.fields.find((e=>e.defaultField)).name}}if("contains"===e.operation)return{type:"text",name:e.name,label:e.label}},async loadCache(e){const t=he();return await t.loadDictionary(e.entityName),t.data[e.entityName]},getPropertyDefinition:(e,t)=>({keys:[e.name]}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):null!=e.defaultValue&&(t[e.name]=e.defaultValue))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity:xe,getCsvValueFromEntity:xe},Pe={__name:"form-field-dictionary-multi",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},multiple:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},maxSelectedOptions:{type:Number,default:void 0},createField:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},entityName:{type:String,default:void 0},junctionEntityName:{type:String,default:void 0},junctionNavigationKey:{type:String,default:void 0},junctionOwnerKey:{type:String,default:void 0},junctionDictionaryKey:{type:String,default:void 0},filter:{type:Function,default:void 0},useFilter:{type:Function,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,i=he(),l=(0,n.computed)((()=>a.entityName??a.field.entityName)),o=(0,n.shallowRef)([]);(0,n.watch)(l,(async e=>{await i.loadDictionary(e),o.value=i.data[e]}),{immediate:!0});const{filteredData:r}=Re(a,o),d=(0,n.computed)((()=>Ti(l.value))),s=(0,n.computed)((()=>d.value.fields.find((e=>e.primary)).name)),u=(0,n.computed)((()=>d.value.fields.find((e=>e.defaultField)).name)),c=(0,n.computed)((()=>r.value.map((e=>({value:e[s.value],text:e[u.value]}))))),m=(0,n.computed)((()=>{const e=a.junctionNavigationKey??a.field.junction.navigationKey,t=a.junctionEntityName??a.field.junction.name;return e||t})),p=(0,n.computed)({get(){const e=a.junctionDictionaryKey??a.field.junction.dictionaryKey;return a.entity[m.value].map((t=>t[e]))},set(e){const n=a.junctionDictionaryKey??a.field.junction.dictionaryKey;t("change",(t=>{const a=t[m.value];for(let t=a.length-1;t>=0;t-=1)e.includes(a[t][n])||a.delete(t);for(const t of e){const e=a.some((e=>e[n]===t));e||a.add({[n]:t})}}))}});return(a,i)=>{const l=(0,n.resolveComponent)("llesca-field-combo");return(0,n.openBlock)(),(0,n.createBlock)(l,{multiple:"",label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,readonly:e.readonly??e.field.readonly,"allow-freeform":e.allowFreeform??e.field.allowFreeform,"auto-complete":e.autoComplete??e.field.autoComplete,"accent-insensitive":e.accentInsensitive??e.field.accentInsensitive,placeholder:e.placeholder??e.field.placeholder,"immediate-scroll":e.immediateScroll??e.field.immediateScroll,"max-selected-options":e.maxSelectedOptions??e.field.maxSelectedOptions,options:(0,n.unref)(c),"create-field":e.validations?.createField,name:e.name??e.field.name,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,modelValue:(0,n.unref)(p),"onUpdate:modelValue":i[0]||(i[0]=e=>(0,n.isRef)(p)?p.value=e:null),onFocus:i[1]||(i[1]=e=>t("focus",e)),onBlur:i[2]||(i[2]=e=>t("blur",e))},null,8,["label","description","invalid","borderless","underlined","readonly","allow-freeform","auto-complete","accent-insensitive","placeholder","immediate-scroll","max-selected-options","options","create-field","name","required","disabled","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","modelValue"])}}},we={__name:"grid-field-dictionary-multi",props:{invalid:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},multiple:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},maxSelectedOptions:{type:Number,default:void 0},createField:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},entityName:{type:String,default:void 0},junctionEntityName:{type:String,default:void 0},junctionNavigationKey:{type:String,default:void 0},junctionOwnerKey:{type:String,default:void 0},junctionDictionaryKey:{type:String,default:void 0},filter:{type:Function,default:void 0},useFilter:{type:Function,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:i,handleFocus:l,handleBlur:o}=te({$emit:t});return(e,r)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Pe),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(i),description:null,underlined:!1,onChange:r[0]||(r[0]=e=>t("change",e)),onFocus:(0,n.unref)(l),onBlur:(0,n.unref)(o)}),null,16,["borderless","onFocus","onBlur"]))}};async function Ve(e,t){const a=he();await a.loadDictionary(e.entityName);const n=Ti(e.entityName),i=n.fields.find((e=>e.primary)).name,l=n.fields.find((e=>e.defaultField)).name,o=e.junction.navigationKey||e.junction.name,r=a.data[e.entityName];return t[o]?.map((t=>r?.find((a=>a[i]===t[e.junction.dictionaryKey]))?.[l])).filter((e=>e)).join(", ")||""}const Be={detailsCell:Z,formField:Pe,gridField:(0,I.Z)(we,[["__scopeId","data-v-e6e02e5c"]]),getDetailsODataQuery:e=>({$expand:`${e.junction.navigationKey||e.junction.name}($select=${e.junction.primaryKey},${e.junction.dictionaryKey})`}),getOrderbySentence:e=>null,getFilterCondition(e){const t=e.junction.navigationKey||e.junction.name;return"in"===e.operation?`${t}/any(o: o/${e.junction.dictionaryKey} in @${e.name})`:"contains"===e.operation?`contains(${t}/${Ti(e.entityName).fields.find((e=>e.defaultField)).name}, @${e.name})`:void 0},getFilterInterface(e){if("in"===e.operation){const t=Ti(e.entityName);return{type:"combo",name:e.name,label:e.label,multiple:"in"===e.operation,valueKey:t.fields.find((e=>e.primary)).name,textKey:t.fields.find((e=>e.defaultField)).name}}if("contains"===e.operation)return{type:"text",name:e.name,label:e.label}},async loadCache(e){const t=he();return await t.loadDictionary(e.entityName),t.data[e.entityName]},getPropertyDefinition(e,t){const{navigationKey:a,name:n,primaryKey:i,ownerKey:l,dictionaryKey:o}=e.junction;return{children:[{navigationKey:a,entityName:n,primaryKey:i,foreingKey:l,keys:[i,l,o]}]}},getEntityValue(e,t){const a=e.junction.navigationKey||e.junction.name,n=e.junction.dictionaryKey;return t[a].map((e=>e[n]))},getTextValueFromEntity:Ve,getCsvValueFromEntity:Ve},Ue={__name:"details-cell-file",props:{field:{type:Object,default:void 0},row:{type:Object,default:void 0}},setup(e){const t=e,a=(0,n.computed)((()=>t.row[t.field.name]));return(e,t)=>{const i=(0,n.resolveComponent)("fura-icon");return(0,n.openBlock)(),(0,n.createElementBlock)("div",null,[(0,n.unref)(a).length>0?((0,n.openBlock)(),(0,n.createBlock)(i,{key:0,class:"detailsCellFile",name:"Attach"})):(0,n.createCommentVNode)("v-if",!0)])}}};function ke(e){const t=qe(e,e.form);return(0,o.useEntity)(t)}function Fe(e){const t=m();return(0,o.entitySave)(e,pe,{Authorization:t.jwt})}function $e(e){const t=m();return(0,o.entityDelete)(e,pe,{Authorization:t.jwt})}function qe(e,{navigationKey:t=null,children:a=[],foreingKey:n=null,detailFields:i=[]}){const l={navigationKey:t,entityName:e.name||e.entityName,primaryKey:e.fields.find((e=>e.primary)).name,foreingKey:n,keys:null,dateKeys:null,children:null,details:null};for(const e of a){const t=Ti(e.listName);l.children=je(l.children,[qe(t,e)])}for(const t of e.fields){const{getPropertyDefinition:e}=Dt[t.type]||{};if("function"==typeof e){const a=e(t,!0===i||i?.includes(t.name));l.keys=Ge(l.keys,a.keys),l.ignoredKeys=Ge(l.ignoredKeys,a.ignoredKeys),l.dateKeys=Ge(l.dateKeys,a.dateKeys),l.children=je(l.children,a.children),l.details=je(l.details,a.details)}}return l}function Ke(e,...t){for(const a of t)Ge(e.keys,a.keys),Ge(e.dateKeys,a.dateKeys),je(e.children,a.children),je(e.details,a.details);return e}function Ge(e,t){if(ze(e)&&ze(t))for(const a of t)e.includes(a)||e.push(a);else if(!ze(e)&&ze(t))return t;return e}function je(e,t){if(ze(e)&&ze(t)){const a=[...t];for(const t of e){const e=a.findIndex((e=>t.navigationKey==e.navigationKey&&t.entityName===e.entityName&&t.primaryKey===e.primaryKey&&t.foreingKey===e.foreingKey));if(e>=0){const[n]=a.splice(e,1);Ke(t,n)}}e.push(...a)}else if(!ze(e)&&ze(t))return t;return e}function ze(e){return Array.isArray(e)&&e.length>0}function We(e,t){const{navigationKey:a,name:n,nameKey:i}=e.entity;return t[a||n]?.map((e=>e[i])).join()??""}const Ye={detailsCell:(0,I.Z)(Ue,[["__scopeId","data-v-e9d017ea"]]),formField:{__name:"form-field-file-multi",props:{label:{type:String,default:void 0},disabled:{type:Boolean,default:void 0},required:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},maxFiles:{type:Number,default:void 0},modelValue:{type:Array,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},entityName:{type:String,default:void 0},navigationKey:{type:String,default:void 0},primaryKey:{type:String,default:void 0},foreingKey:{type:String,default:void 0},nameKey:{type:String,default:void 0},contentKey:{type:String,default:void 0},typeKey:{type:String,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,i=ue();function l(e){const t=new FileReader;t.addEventListener("load",(t=>{const n=a.entityName??a.field.entity?.name,i=a.navigationKey??a.field.entity?.navigationKey,l=a.nameKey??a.field.entity?.nameKey,o=a.contentKey??a.field.entity?.contentKey,r=a.typeKey??a.field.entity?.typeKey;a.entity[i??n].add({[l]:e.name,[r]:e.type,[o]:t.target.result.replace(/^.+,/,"")})})),t.addEventListener("error",(()=>i.alert({title:"Error",message:"Error al llegir el arxiu."}))),t.readAsDataURL(e)}function r(e){const t=a.entityName??a.field.entity?.name,n=a.navigationKey??a.field.entity?.navigationKey;a.entity[n??t].delete(e)}const d=(0,n.computed)((()=>{const e=a.entityName??a.field.entity?.name,t=a.navigationKey??a.field.entity?.navigationKey,n=a.primaryKey??a.field.entity?.primaryKey,i=a.nameKey??a.field.entity?.nameKey,l=a.contentKey??a.field.entity?.contentKey,r=a.typeKey??a.field.entity?.typeKey;return(0,o.entityData)(a.entity[t??e]).map((t=>[t[i],async()=>{if(!t[l]){const a=await Ne(`${e}(${t[n]})`,{$select:l});t[l]=a[l]}return`data:application/octet-stream;base64,${t[l]}`},t[r]]))}));return(a,i)=>{const o=(0,n.resolveComponent)("fura-file-multi");return(0,n.openBlock)(),(0,n.createBlock)(o,{label:e.label??e.field.label,disabled:e.disabled??e.field.disabled,required:e.required??e.field.required,readonly:e.readonly??e.field.readonly,"max-files":e.maxFiles??e.field.maxFiles,"model-value":(0,n.unref)(d),onLoad:l,onDelete:r,onFocus:i[0]||(i[0]=e=>t("focus",e)),onBlur:i[1]||(i[1]=e=>t("blur",e))},null,8,["label","disabled","required","readonly","max-files","model-value"])}}},getDetailsODataQuery(e){const{name:t,navigationKey:a,primaryKey:n,foreingKey:i,nameKey:l,contentKey:o,typeKey:r}=e.entity;return{$expand:`${a||t}($select=${n},${i},${l},${o},${r})`}},getOrderbySentence:e=>null,getFilterCondition(e){if("has"===e.operation)return`(${e.entity.navigationKey||e.entity.name}/$count ne 0) eq @${e.name}`},getFilterInterface(e){if("has"===e.operation)return{type:"checkbox",name:e.name,label:e.label}},getPropertyDefinition(e,t){const{name:a,navigationKey:n,primaryKey:i,foreingKey:l,nameKey:o,contentKey:r,typeKey:d}=e.entity;return{children:[{navigationKey:n,entityName:a,primaryKey:i,foreingKey:l,keys:[i,l,o,r,d],ignoredKeys:[r]}]}},getTextValueFromEntity:We,getCsvValueFromEntity:We},Xe=["value"];function He(e,t){return t[e.name]??""}const Ze={detailsCell:Z,formField:{__name:"form-field-hidden",props:{name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0}},emits:["change","focus","blur"],setup(e){const t=e,a=t.name||t.field.name,i=(0,n.computed)((()=>t.entity[a]));return t.validations.createField(a,i),(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("input",{type:"hidden",value:String((0,n.unref)(i))},null,8,Xe))}},getDetailsODataQuery:e=>({$select:e.name}),getOrderbySentence:e=>e.name,getFilterCondition(e){},getFilterInterface(e){},getPropertyDefinition:(e,t)=>({keys:[e.name]}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):"string"==typeof e.defaultValue&&(t[e.name]=e.defaultValue))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity:He,getCsvValueFromEntity:He},Je={__name:"form-field-lookup",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},createField:{type:Function,default:void 0},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},navigationKey:{type:String,default:void 0},entityName:{type:String,default:void 0},primaryKey:{type:String,default:void 0},targetKey:{type:String,default:void 0},filter:{type:String,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,i=m(),l=ue(),r=(0,n.computed)((()=>a.entityName??a.field.entity.name)),d=(0,n.computed)((()=>a.primaryKey??a.field.entity.primaryKey)),s=(0,n.computed)((()=>a.targetKey??a.field.entity.targetKey)),{options:u,isLoading:c}=(0,o.useOptionsLoader)(pe,r,d,s,{$filter:(0,n.computed)((()=>a.filter??a.field.filter))},{Authorization:i.jwt});function p(e){const n=a.name??a.field.name,i=(a.navigationKey??a.field.entity.navigationKey)||r.value,l=u.value.find((t=>t.value===e))?.text;t("change",(t=>{t[n]=e,t[i]={[s.value]:l}}))}return(0,n.watch)(c,(e=>e&&r.value?l.loadStart(`list/${r.value}/load`):l.loadEnd(`list/${r.value}/load`)),{immediate:!0}),(a,i)=>{const l=(0,n.resolveComponent)("llesca-field-combo");return(0,n.openBlock)(),(0,n.createBlock)(l,{label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,readonly:e.readonly??e.field.readonly,"allow-freeform":e.allowFreeform??e.field.allowFreeform,"auto-complete":e.autoComplete??e.field.autoComplete,"accent-insensitive":e.accentInsensitive??e.field.accentInsensitive,placeholder:e.placeholder??e.field.placeholder,"immediate-scroll":e.immediateScroll??e.field.immediateScroll,"create-field":e.validations?.createField,name:e.name??e.field.name,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,options:(0,n.unref)(u),"model-value":e.entity[e.name??e.field.name],"onUpdate:modelValue":p,onFocus:i[0]||(i[0]=e=>t("focus",e)),onBlur:i[1]||(i[1]=e=>t("blur",e))},null,8,["label","description","invalid","borderless","underlined","readonly","allow-freeform","auto-complete","accent-insensitive","placeholder","immediate-scroll","create-field","name","required","disabled","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","options","model-value"])}}},Qe={__name:"grid-field-lookup",props:{invalid:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},createField:{type:Function,default:void 0},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},navigationKey:{type:String,default:void 0},entityName:{type:String,default:void 0},primaryKey:{type:String,default:void 0},targetKey:{type:String,default:void 0},filter:{type:String,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:i,handleFocus:l,handleBlur:o}=te({$emit:t});return(r,d)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Je),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(i),description:null,underlined:!1,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,onChange:d[0]||(d[0]=e=>t("change",e)),onFocus:(0,n.unref)(l),onBlur:(0,n.unref)(o)}),null,16,["borderless","clear-value-on-disabled","onFocus","onBlur"]))}};function et(e,t){const{navigationKey:a,name:n,targetKey:i}=e.entity;return t[a||n]?.[i]??""}const tt={detailsCell:Z,formField:Je,gridField:(0,I.Z)(Qe,[["__scopeId","data-v-3746c692"]]),getDetailsODataQuery(e){const t=e.entity.navigationKey||e.entity.name;return{$select:e.name,$expand:`${t}($select=${e.entity.targetKey})`}},getOrderbySentence:e=>`${e.entity.navigationKey||e.entity.name}/${e.entity.targetKey}`,getFilterCondition:e=>"eq"===e.operation?`${e.name} eq @${e.name}`:"in"===e.operation?`${e.name} in @${e.name}`:"contains"===e.operation?`contains(${e.entity.navigationKey||e.entity.name}/${e.entity.targetKey}, @${e.name})`:void 0,getFilterInterface:e=>"eq"===e.operation?{type:"combo",name:e.name,label:e.label,valueKey:e.entity.primaryKey,textKey:e.entity.targetKey}:"in"===e.operation?{type:"combo",name:e.name,label:e.label,multiple:!0,valueKey:e.entity.primaryKey,textKey:e.entity.targetKey}:"contains"===e.operation?{type:"text",name:e.name,label:e.label}:void 0,getPropertyDefinition:(e,t=!1)=>({keys:[e.name],details:t?[{navigationKey:e.entity.navigationKey,entityName:e.entity.name,keys:[e.entity.targetKey]}]:null}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):null!=e.defaultValue&&(t[e.name]=e.defaultValue))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity:et,getCsvValueFromEntity:et},at=(0,i.defineStore)({id:"listCache",state:()=>({contextName:null,data:{}}),actions:{setContextName(e){const t=(0,n.toRaw)(e);this.contextName!==t&&(this.contextName=t,this.data={})},async load(e,{force:t=!1}={}){const a=(0,n.toRaw)(e);if(t||!(a in this.data)){const e=Ti(a);if(e){this.data[a]={};const t=[];for(const a of e.fields)Dt[a.type]?.loadCache&&t.push({name:a.name,promise:Dt[a.type].loadCache(a,e.fields)});const n=await Promise.all(t.map((e=>e.promise)));for(let e=0;e<n.length;e+=1){const i=t[e].name;this.data[a][i]=n[e]}}}},async reloadField(e,t){const a=(0,n.toRaw)(e);if(this.data[a]){const e=Ti(a);if(e){const i=e.fields.find((e=>e.name===(0,n.toRaw)(t)));if(i){const t=Dt[i.type];t&&t.loadCache&&(this.data[a][i.name]=await t.loadCache(i,e.fields))}}}},setData(e,t){this.data[e]=t}}}),nt={__name:"form-field-lookup-cache",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},createField:{type:Function,default:void 0},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},cacheName:{type:String,default:void 0},filter:{type:Function,default:void 0},useFilter:{type:Function,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,i=at(),l=(0,n.computed)((()=>i.data[a.cacheName]?.[a.field.name]||[])),{filteredData:o}=Re(a,l),r=(0,n.computed)((()=>a.field.entity.primaryKey)),d=(0,n.computed)((()=>a.field.entity.targetKey)),s=(0,n.computed)((()=>o.value.map((e=>({value:e[r.value],text:e[d.value]})))));function u(e){const n=a.name??a.field.name,i=a.field.entity.navigationKey||a.field.entity.name,l=s.value.find((t=>t.value===e))?.text;t("change",(t=>{t[n]=e,t[i]={[d.value]:l}}))}return(a,i)=>{const l=(0,n.resolveComponent)("llesca-field-combo");return(0,n.openBlock)(),(0,n.createBlock)(l,{label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,readonly:e.readonly??e.field.readonly,"allow-freeform":e.allowFreeform??e.field.allowFreeform,"auto-complete":e.autoComplete??e.field.autoComplete,"accent-insensitive":e.accentInsensitive??e.field.accentInsensitive,placeholder:e.placeholder??e.field.placeholder,"immediate-scroll":e.immediateScroll??e.field.immediateScroll,"create-field":e.validations?.createField,name:e.name??e.field.name,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,options:(0,n.unref)(s),"model-value":e.entity[e.name??e.field.name],"onUpdate:modelValue":u,onFocus:i[0]||(i[0]=e=>t("focus",e)),onBlur:i[1]||(i[1]=e=>t("blur",e))},null,8,["label","description","invalid","borderless","underlined","readonly","allow-freeform","auto-complete","accent-insensitive","placeholder","immediate-scroll","create-field","name","required","disabled","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","options","model-value"])}}},it={__name:"grid-field-lookup-cache",props:{invalid:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},createField:{type:Function,default:void 0},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},cacheName:{type:String,default:void 0},filter:{type:Function,default:void 0},useFilter:{type:Function,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:i,handleFocus:l,handleBlur:o}=te({$emit:t});return(e,r)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(nt),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(i),description:null,underlined:!1,onChange:r[0]||(r[0]=e=>t("change",e)),onFocus:(0,n.unref)(l),onBlur:(0,n.unref)(o)}),null,16,["borderless","onFocus","onBlur"]))}},lt=(0,I.Z)(it,[["__scopeId","data-v-bccf8768"]]),ot={...tt,formField:nt,gridField:lt,loadCache:async e=>(await Ne(e.entity.name,{$select:[e.entity.primaryKey,e.entity.targetKey,...e.entity.cache||[]],$orderby:e.entity.targetKey})).value},rt={__name:"form-field-lookup-multi",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},multiple:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},maxSelectedOptions:{type:Number,default:void 0},createField:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},junctionEntityName:{type:String,default:void 0},junctionNavigationKey:{type:String,default:void 0},junctionOwnerKey:{type:String,default:void 0},junctionTargetKey:{type:String,default:void 0},dataEntityName:{type:String,default:void 0},dataPrimaryKey:{type:String,default:void 0},dataTargetKey:{type:String,default:void 0},filter:{type:String,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,i=(0,n.shallowRef)([]);(0,n.watchEffect)((async()=>{const e=a.dataEntityName??a.field.data?.name,t=a.dataPrimaryKey??a.field.data?.primaryKey,n=a.dataTargetKey??a.field.data?.targetKey,l=a.filter??a.field.data.filter,o=await Ne(e,{$select:`${t},${n}`,$filter:l||void 0,$orderby:`${n} asc`});i.value=o.value.map((e=>({value:e[t],text:e[n]})))}));const l=(0,n.computed)((()=>{const e=a.junctionNavigationKey??a.field.junction.navigationKey,t=a.junctionEntityName??a.field.junction.name;return e||t})),r=(0,n.computed)({get(){const e=a.junctionTargetKey??a.field.junction.targetKey;return(0,o.entityData)(a.entity[l.value]).map((t=>t[e]))},set(e){const n=a.junctionTargetKey??a.field.junction.targetKey;t("change",(t=>{const a=t[l.value];for(let t=a.length-1;t>=0;t-=1)e.includes(a[t][n])||a.delete(t);for(const t of e){const e=a.some((e=>e[n]===t));e||a.add({[n]:t})}}))}});return(a,l)=>{const o=(0,n.resolveComponent)("llesca-field-combo");return(0,n.openBlock)(),(0,n.createBlock)(o,{multiple:"",label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,readonly:e.readonly??e.field.readonly,"allow-freeform":e.allowFreeform??e.field.allowFreeform,"auto-complete":e.autoComplete??e.field.autoComplete,"accent-insensitive":e.accentInsensitive??e.field.accentInsensitive,placeholder:e.placeholder??e.field.placeholder,"immediate-scroll":e.immediateScroll??e.field.immediateScroll,"max-selected-options":e.maxSelectedOptions??e.field.maxSelectedOptions,options:(0,n.unref)(i),"create-field":e.validations?.createField,name:e.name??e.field.name,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,modelValue:(0,n.unref)(r),"onUpdate:modelValue":l[0]||(l[0]=e=>(0,n.isRef)(r)?r.value=e:null),onFocus:l[1]||(l[1]=e=>t("focus",e)),onBlur:l[2]||(l[2]=e=>t("blur",e))},null,8,["label","description","invalid","borderless","underlined","readonly","allow-freeform","auto-complete","accent-insensitive","placeholder","immediate-scroll","max-selected-options","options","create-field","name","required","disabled","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","modelValue"])}}},dt={__name:"grid-field-lookup-multi",props:{invalid:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},multiple:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},maxSelectedOptions:{type:Number,default:void 0},createField:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},junctionEntityName:{type:String,default:void 0},junctionNavigationKey:{type:String,default:void 0},junctionOwnerKey:{type:String,default:void 0},junctionTargetKey:{type:String,default:void 0},dataEntityName:{type:String,default:void 0},dataPrimaryKey:{type:String,default:void 0},dataTargetKey:{type:String,default:void 0},filter:{type:String,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:i,handleFocus:l,handleBlur:o}=te({$emit:t});return(r,d)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(rt),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(i),description:null,underlined:!1,onChange:d[0]||(d[0]=e=>t("change",e)),"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,onFocus:(0,n.unref)(l),onBlur:(0,n.unref)(o)}),null,16,["borderless","clear-value-on-disabled","onFocus","onBlur"]))}};function st(e,t){const a=e.junction.navigationKey||e.junction.name,n=e.data.navigationKey||e.data.name,i=e.data.targetKey;return t[a]?.map((e=>e[n][i])).join(", ")??""}const ut={detailsCell:Z,formField:rt,gridField:(0,I.Z)(dt,[["__scopeId","data-v-a34b1a5c"]]),getDetailsODataQuery:e=>({$expand:`${e.junction.navigationKey||e.junction.name}($expand=${e.data.navigationKey||e.data.name}($select=${e.data.primaryKey},${e.data.targetKey};$orderby=${e.data.targetKey}))`}),getOrderbySentence:e=>null,getFilterCondition(e){const t=e.junction.navigationKey||e.junction.name;return"in"===e.operation?`${t}/any(o: o/${e.junction.targetKey} in @${e.name})`:"contains"===e.operation?`contains(${t}/${e.entity.targetKey}, @${e.name})`:void 0},getFilterInterface:e=>"in"===e.operation?{type:"combo",name:e.name,label:e.label,multiple:"in"===e.operation,valueKey:e.data.primaryKey,textKey:e.data.targetKey}:"contains"===e.operation?{type:"text",name:e.name,label:e.label}:void 0,getPropertyDefinition(e,t){const{navigationKey:a,name:n,primaryKey:i,ownerKey:l,targetKey:o}=e.junction;return{children:[{navigationKey:a,entityName:n,primaryKey:i,foreingKey:l,keys:[i,l,o]}]}},getEntityValue(e,t){const a=e.junction.navigationKey||e.junction.name,n=e.junction.targetKey;return t[a].map((e=>e[n]))},getTextValueFromEntity:st,getCsvValueFromEntity:st},ct={__name:"form-field-lookup-multi-cache",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},multiple:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},maxSelectedOptions:{type:Number,default:void 0},createField:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},junctionEntityName:{type:String,default:void 0},junctionNavigationKey:{type:String,default:void 0},junctionOwnerKey:{type:String,default:void 0},junctionTargetKey:{type:String,default:void 0},dataEntityName:{type:String,default:void 0},dataPrimaryKey:{type:String,default:void 0},dataTargetKey:{type:String,default:void 0},cacheName:{type:String,default:void 0},filter:{type:Function,default:void 0},useFilter:{type:Function,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,i=at(),l=(0,n.computed)((()=>i.data[a.cacheName]?.[a.field.name]||[])),{filteredData:r}=Re(a,l),d=(0,n.computed)((()=>a.field.data.primaryKey)),s=(0,n.computed)((()=>a.field.data.targetKey)),u=(0,n.computed)((()=>r.value.map((e=>({value:e[d.value],text:e[s.value]}))))),c=(0,n.computed)((()=>{const e=a.junctionNavigationKey??a.field.junction.navigationKey,t=a.junctionEntityName??a.field.junction.name;return e||t})),m=(0,n.computed)({get(){const e=a.junctionTargetKey??a.field.junction.targetKey;return(0,o.entityData)(a.entity[c.value]).map((t=>t[e]))},set(e){const n=a.junctionTargetKey??a.field.junction.targetKey;t("change",(t=>{const a=t[c.value];for(let t=a.length-1;t>=0;t-=1)e.includes(a[t][n])||a.delete(t);for(const t of e){const e=a.some((e=>e[n]===t));e||a.add({[n]:t})}}))}});return(a,i)=>{const l=(0,n.resolveComponent)("llesca-field-combo");return(0,n.openBlock)(),(0,n.createBlock)(l,{multiple:"",label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,readonly:e.readonly??e.field.readonly,"allow-freeform":e.allowFreeform??e.field.allowFreeform,"auto-complete":e.autoComplete??e.field.autoComplete,"accent-insensitive":e.accentInsensitive??e.field.accentInsensitive,placeholder:e.placeholder??e.field.placeholder,"immediate-scroll":e.immediateScroll??e.field.immediateScroll,"max-selected-options":e.maxSelectedOptions??e.field.maxSelectedOptions,options:(0,n.unref)(u),"create-field":e.validations?.createField,name:e.name??e.field.name,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,modelValue:(0,n.unref)(m),"onUpdate:modelValue":i[0]||(i[0]=e=>(0,n.isRef)(m)?m.value=e:null),onFocus:i[1]||(i[1]=e=>t("focus",e)),onBlur:i[2]||(i[2]=e=>t("blur",e))},null,8,["label","description","invalid","borderless","underlined","readonly","allow-freeform","auto-complete","accent-insensitive","placeholder","immediate-scroll","max-selected-options","options","create-field","name","required","disabled","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","modelValue"])}}},mt={__name:"grid-field-lookup-multi-cache",props:{invalid:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},multiple:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},maxSelectedOptions:{type:Number,default:void 0},createField:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},junctionEntityName:{type:String,default:void 0},junctionNavigationKey:{type:String,default:void 0},junctionOwnerKey:{type:String,default:void 0},junctionTargetKey:{type:String,default:void 0},dataEntityName:{type:String,default:void 0},dataPrimaryKey:{type:String,default:void 0},dataTargetKey:{type:String,default:void 0},cacheName:{type:String,default:void 0},filter:{type:Function,default:void 0},useFilter:{type:Function,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:i,handleFocus:l,handleBlur:o}=te({$emit:t});return(e,r)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(ct),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(i),description:null,underlined:!1,onChange:r[0]||(r[0]=e=>t("change",e)),onFocus:(0,n.unref)(l),onBlur:(0,n.unref)(o)}),null,16,["borderless","onFocus","onBlur"]))}},pt=(0,I.Z)(mt,[["__scopeId","data-v-754a3117"]]),yt={...ut,formField:ct,gridField:pt,loadCache:async e=>(await Ne(e.data.name,{$select:[e.data.primaryKey,e.data.targetKey,...e.data.cache||[]],$orderby:e.data.targetKey})).value},It={__name:"form-field-number",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},prefix:{type:String,default:void 0},suffix:{type:String,default:void 0},multiline:{type:Boolean,default:void 0},icon:{type:String,default:void 0},readonly:{type:Boolean,default:void 0},maxlength:{type:Number,default:void 0},unresizable:{type:Boolean,default:void 0},autoAdjustHeight:{type:Boolean,default:void 0},formatStyle:{type:String,default:void 0},useGrouping:{type:Boolean,default:void 0},minimumIntegerDigits:{type:Number,default:void 0},minimumFractionDigits:{type:Number,default:void 0},maximumFractionDigits:{type:Number,default:void 0},minimumSignificantDigits:{type:Number,default:void 0},maximumSignificantDigits:{type:Number,default:void 0},parse:{type:Function,default:void 0},stringify:{type:Function,default:void 0},stringifyFocus:{type:Function,default:void 0},align:{type:String,default:void 0},alignFocus:{type:String,default:void 0},createField:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},min:{type:Number,default:void 0},max:{type:Number,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0}},emits:["change","click","focus","blur"],setup(e,{emit:t}){const a=e;function i(e){const n=a.name??a.field.name;t("change",(t=>{t[n]=e}))}return(a,l)=>{const o=(0,n.resolveComponent)("llesca-field-number");return(0,n.openBlock)(),(0,n.createBlock)(o,{label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,placeholder:e.placeholder??e.field.placeholder,prefix:e.prefix??e.field.prefix,suffix:e.suffix??e.field.suffix,multiline:e.multiline??e.field.multiline,icon:e.icon??e.field.icon,readonly:e.readonly??e.field.readonly,maxlength:e.maxlength??e.field.maxlength,unresizable:e.unresizable??e.field.unresizable,"auto-adjust-height":e.autoAdjustHeight??e.field.autoAdjustHeight,"format-style":e.formatStyle??e.field.formatStyle,"use-grouping":e.useGrouping??e.field.useGrouping,"minimum-integer-digits":e.minimumIntegerDigits??e.field.minimumIntegerDigits,"minimum-fraction-digits":e.minimumFractionDigits??e.field.minimumFractionDigits,"maximum-fraction-digits":e.maximumFractionDigits??e.field.maximumFractionDigits,"minimum-significant-digits":e.minimumSignificantDigits??e.field.minimumSignificantDigits,"maximum-significant-digits":e.maximumSignificantDigits??e.field.maximumSignificantDigits,parse:e.parse??e.field.parse,stringify:e.stringify??e.field.stringify,"stringify-focus":e.stringifyFocus??e.field.stringifyFocus,align:e.align??e.field.align,"align-focus":e.alignFocus??e.field.alignFocus,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,min:e.min??e.field.min,max:e.max??e.field.max,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,name:e.name??e.field.name,"create-field":e.validations?.createField,"model-value":e.entity[e.name??e.field.name],"onUpdate:modelValue":i,onFocus:l[0]||(l[0]=e=>t("focus",e)),onBlur:l[1]||(l[1]=e=>t("blur",e))},null,8,["label","description","invalid","borderless","underlined","placeholder","prefix","suffix","multiline","icon","readonly","maxlength","unresizable","auto-adjust-height","format-style","use-grouping","minimum-integer-digits","minimum-fraction-digits","maximum-fraction-digits","minimum-significant-digits","maximum-significant-digits","parse","stringify","stringify-focus","align","align-focus","required","disabled","min","max","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","name","create-field","model-value"])}}},ft={__name:"grid-field-number",props:{invalid:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},prefix:{type:String,default:void 0},suffix:{type:String,default:void 0},multiline:{type:Boolean,default:void 0},icon:{type:String,default:void 0},readonly:{type:Boolean,default:void 0},maxlength:{type:Number,default:void 0},unresizable:{type:Boolean,default:void 0},autoAdjustHeight:{type:Boolean,default:void 0},formatStyle:{type:String,default:void 0},useGrouping:{type:Boolean,default:void 0},minimumIntegerDigits:{type:Number,default:void 0},minimumFractionDigits:{type:Number,default:void 0},maximumFractionDigits:{type:Number,default:void 0},minimumSignificantDigits:{type:Number,default:void 0},maximumSignificantDigits:{type:Number,default:void 0},parse:{type:Function,default:void 0},stringify:{type:Function,default:void 0},stringifyFocus:{type:Function,default:void 0},align:{type:String,default:void 0},alignFocus:{type:String,default:void 0},createField:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},min:{type:Number,default:void 0},max:{type:Number,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0}},emits:["change","click","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:i,handleFocus:l,handleBlur:o}=te({$emit:t});return(e,r)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(It),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(i),description:null,underlined:!1,onChange:r[0]||(r[0]=e=>t("change",e)),onClick:r[1]||(r[1]=e=>t("click",e)),onFocus:(0,n.unref)(l),onBlur:(0,n.unref)(o)}),null,16,["borderless","onFocus","onBlur"]))}},Et={detailsCell:Z,formField:It,gridField:(0,I.Z)(ft,[["__scopeId","data-v-794c5b06"]]),getDetailsODataQuery:e=>({$select:e.name}),getOrderbySentence:e=>e.name,getFilterCondition:e=>"eq"===e.operation?`${e.name} eq @${e.name}`:"between"===e.operation?new Y([`${e.name} gt @${e.name}_gt`,`${e.name} lt @${e.name}_lt`],"and"):void 0,getFilterInterface:e=>"eq"===e.operation?{type:"number",name:e.name,label:e.label}:"between"===e.operation?[{type:"number",name:`${e.name}_gt`,label:`${e.label} Menor`},{type:"number",name:`${e.name}_lt`,label:`${e.label} Major`}]:void 0,getPropertyDefinition:(e,t)=>({keys:[e.name]}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):"number"==typeof e.defaultValue&&(t[e.name]=e.defaultValue))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity(e,t){const a=t[e.name];if(null==a||isNaN(a))return"";const n={style:e.formatStyle,currency:"EUR",useGrouping:e.useGrouping,minimumIntegerDigits:e.minimumIntegerDigits,minimumFractionDigits:e.minimumFractionDigits,maximumFractionDigits:e.maximumFractionDigits};return e.minimumSignificantDigits>0&&e.minimumSignificantDigits<22&&(n.minimumSignificantDigits=e.minimumSignificantDigits),e.maximumSignificantDigits>0&&e.maximumSignificantDigits<22&&(n.maximumSignificantDigits=e.maximumSignificantDigits),("percent"===e.formatStyle?a/100:a).toLocaleString("ca-ES",n)},getCsvValueFromEntity(e,t){const a=t[e.name];return null==a||isNaN(a)?"":String(a)}},At={__name:"form-field-string",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},prefix:{type:String,default:void 0},suffix:{type:String,default:void 0},multiline:{type:Boolean,default:void 0},icon:{type:String,default:void 0},readonly:{type:Boolean,default:void 0},unresizable:{type:Boolean,default:void 0},autoAdjustHeight:{type:Boolean,default:void 0},password:{type:Boolean,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},maxlength:{type:Number,default:void 0},pattern:{type:RegExp,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0}},emits:["change","click","focus","blur","keydown"],setup(e,{emit:t}){const a=e;function i(e){const n=a.name??a.field.name;t("change",(t=>{t[n]=e}))}return(a,l)=>{const o=(0,n.resolveComponent)("llesca-field-text");return(0,n.openBlock)(),(0,n.createBlock)(o,{label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,placeholder:e.placeholder??e.field.placeholder,prefix:e.prefix??e.field.prefix,suffix:e.suffix??e.field.suffix,multiline:e.multiline??e.field.multiline,icon:e.icon??e.field.icon,readonly:e.readonly??e.field.readonly,unresizable:e.unresizable??e.field.unresizable,"auto-adjust-height":e.autoAdjustHeight??e.field.autoAdjustHeight,password:e.password??e.field.password,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,maxlength:e.maxlength??e.field.maxlength,pattern:e.pattern??e.field.pattern,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,name:e.name??e.field.name,"create-field":e.validations?.createField,"model-value":e.entity[e.name??e.field.name],"onUpdate:modelValue":i,onClick:l[0]||(l[0]=e=>t("click")),onFocus:l[1]||(l[1]=e=>t("focus",e)),onBlur:l[2]||(l[2]=e=>t("blur",e)),onKeydown:l[3]||(l[3]=e=>t("keydown",e))},null,8,["label","description","invalid","borderless","underlined","placeholder","prefix","suffix","multiline","icon","readonly","unresizable","auto-adjust-height","password","required","disabled","maxlength","pattern","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","name","create-field","model-value"])}}},Tt={__name:"grid-field-string",props:{invalid:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},prefix:{type:String,default:void 0},suffix:{type:String,default:void 0},multiline:{type:Boolean,default:void 0},icon:{type:String,default:void 0},readonly:{type:Boolean,default:void 0},unresizable:{type:Boolean,default:void 0},autoAdjustHeight:{type:Boolean,default:void 0},password:{type:Boolean,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},maxlength:{type:Number,default:void 0},pattern:{type:RegExp,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0}},emits:["change","click","focus","blur","keydown"],setup(e,{emit:t}){const a=e,{borderless:i,handleFocus:l,handleBlur:o}=te({$emit:t});return(r,d)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(At),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(i),description:null,underlined:!1,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,onChange:d[0]||(d[0]=e=>t("change",e)),onClick:d[1]||(d[1]=e=>t("click",e)),onFocus:(0,n.unref)(l),onBlur:(0,n.unref)(o),onKeydown:d[2]||(d[2]=e=>t("keydown",e))}),null,16,["borderless","clear-value-on-disabled","onFocus","onBlur"]))}};function Ct(e,t){return t[e.name]??""}const Dt={boolean:D,childCount:Q,choice:ie,date:se,dictionary:Le,dictionaryMulti:Be,fileMulti:Ye,lookup:tt,hidden:Ze,lookupCache:ot,lookupMulti:ut,lookupMultiCache:yt,number:Et,string:{detailsCell:Z,formField:At,gridField:(0,I.Z)(Tt,[["__scopeId","data-v-2a27fa3a"]]),getDetailsODataQuery:e=>({$select:e.name}),getOrderbySentence:e=>e.name,getFilterCondition:e=>"eq"===e.operation?`${e.name} eq @${e.name}`:"contains"===e.operation?`contains(${e.name}, @${e.name})`:"in"===e.operation?`${e.name} in @${e.name}`:void 0,getFilterInterface:e=>["eq","contains"].includes(e.operation)?{type:"text",name:e.name,label:e.label}:"in"===e.operation?{type:"csv",name:e.name,label:e.label}:void 0,getPropertyDefinition:(e,t)=>({keys:[e.name]}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):"string"==typeof e.defaultValue&&(t[e.name]=e.defaultValue))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity:Ct,getCsvValueFromEntity:Ct}},Nt={__name:"form-field-collection",props:{fields:{type:Array,required:!0},entity:{type:Object,required:!0},validations:{type:Object,required:!0},withClass:{type:[Boolean,Function],default:null},withAreaName:{type:[Boolean,Function],default:null},cacheName:{type:String,default:""}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,i=(0,n.computed)((()=>a.fields.filter((e=>!e.primary&&e.type))));function l(e,t){return!0===a.withClass?`formField-${e.name}`:"function"==typeof a.withClass?a.withClass.call(null,e,t):void 0}function o(e){return!0===a.withAreaName?{gridArea:e.name}:"function"==typeof a.withAreaName?{gridArea:a.withAreaName.call(null,e)}:void 0}return(r,d)=>((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)((0,n.unref)(i),(i=>((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)((0,n.unref)(Dt)[i.type].formField),{key:i.name,entity:e.entity,field:i,validations:e.validations,class:(0,n.normalizeClass)(l(i,e.entity)),style:(0,n.normalizeStyle)(o(i,e.entity)),"cache-name":e.cacheName,onChange:e=>async function(e,n){if(t("change",{field:e,action:n}),"function"==typeof e.onChange){const n=await e.onChange(a.entity);"function"==typeof n&&t("change",{field:e,action:n})}}(i,e),onFocus:e=>async function(e,n){if("function"==typeof e.onFocus){const i=await e.onFocus(a.entity,n);"function"==typeof i&&t("change",{field:e,action:i})}}(i,e),onBlur:e=>async function(e,n){if("function"==typeof e.onBlur){const i=await e.onBlur(a.entity,n);"function"==typeof i&&t("change",{field:e,action:i})}}(i,e)},null,40,["entity","field","validations","class","style","cache-name","onChange","onFocus","onBlur"])))),128))}};async function gt(e,t,a,n){const i=Ti(e),l=Ci(i,a);console.log(l);const o=a.map((function(e){console.log(e,l.find((t=>t.name===e)).type);const a=["string","choice"].includes(l.find((t=>t.name===e)).type)?"'":"";return e+" eq "+a+(t[e]||[]).toString().replace(/'/g,"''")+a})).join(" "+n+" "),{"@odata.count":r}=await Ne(e,{$filter:"number"==typeof t.ID?`ID ne ${t.ID} and (${o})`:o,$count:!0,$top:0});if(r>0)return`Hi ha ${i.label} amb codis i/o noms duplicats`}const vt={class:"AGENT-editItem-layout"},Ot={style:{"margin-top":"4px","grid-area":"errorMessage"}},St={__name:"form-agent",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,i=(0,o.entityDefinition)(a.entity).entityName;at().load(i);const l=Ci(Ti(i),["CODI","TITLE","ID_TIPUSAGENT","AGENTOROL",{name:"AGENT_FORMATPER",required:"Rol"===a.entity.AGENTOROL,disabled:"Rol"!==a.entity.AGENTOROL,clearValueOnDisabled:!0},"TIPUSDEPENDENCIA",{name:"ID_DEPENDE",disabled:"Agent"!==a.entity.AGENTOROL,clearValueOnDisabled:!0},"CONTACTE","MAILCONTACTE","ALTA","BAIXA"]),{errorMessage:r}=a.validations.createValidation("generals",{rules:[async e=>await gt(i,e,["CODI","TITLE"],"or")]});return(a,o)=>{const d=(0,n.resolveComponent)("fura-message-bar");return(0,n.openBlock)(),(0,n.createElementBlock)("div",vt,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(l),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(i),onChange:o[0]||(o[0]=e=>t("change",e.action))},null,8,["fields","entity","validations","cache-name"]),(0,n.createElementVNode)("div",Ot,[(0,n.unref)(r)?((0,n.openBlock)(),(0,n.createBlock)(d,{key:0,type:"error",singleline:""},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(r)),1)])),_:1})):(0,n.createCommentVNode)("v-if",!0)])])}}},bt=(0,I.Z)(St,[["__scopeId","data-v-99e4ebae"]]),ht={name:"AGENT",type:"listSplitted",label:"Agents",fields:p,filter:[{name:"CODI",operation:"contains",label:"Codi agent conté"},{name:"TITLE",label:"Nom agent conté",operation:"contains"},{name:"ID_TIPUSAGENT",operation:"in"},{name:"AGENTOROL",operation:"eq"},{name:"AGENT_FORMATPER",operation:"in"},{name:"TIPUSDEPENDENCIA",operation:"eq"},{name:"VIGENT",operation:"eq"}],form:{component:(0,n.markRaw)(bt),maxWidth:"930px",children:[{listName:"PROCES",foreingKey:"ID_RESPONSABLE",detailFields:["ID_PROCES"]},{listName:"TASCA",foreingKey:"ID_AGENT",detailFields:["ID_PROCES"]},{listName:"EVIDENCIA",foreingKey:"ID_PRODUCTOR",detailFields:["ID_PROCES"]},{listName:"SERIEDOCUMENTAL",foreingKey:"ID_PRODUCTOR",detailFields:["ID_PROCES"]},{listName:"SISTEMAINFORMACIO",foreingKey:"ID_PROMOTOR"},{listName:"TRACTAMENTDADESPERSONALS",foreingKey:"ID_RESPONSABLE"}],tabs:[{name:"COMENTARIS",title:"Comentaris",component:"auto",fields:e=>[{name:"COMENTARIS",label:" "}]},{name:"PROCES",title:"Responsable procesos",type:"child",readonly:!0,listName:"PROCES",fields:["CODIINOM","TIPUS","AMBIT"]},{name:"TASQUES",title:"Tasques",type:"child",readonly:!0,listName:"TASCA",fields:["ID_PROCES","CODI","TITLE"]},{name:"EVIDENCIA",title:"Productor evidències",type:"child",readonly:!0,listName:"EVIDENCIA",fields:["ID_PROCES","CODI","TITLE","TIPUS"]},{name:"SERIEDOCUMENTAL",title:"Productor Séries Doc.",type:"child",readonly:!0,listName:"SERIEDOCUMENTAL",fields:["ID_PROCES","CODIINOM"]},{name:"SISTEMAINFORMACIO",title:"Promotor dels sistemes",type:"child",readonly:!0,listName:"SISTEMAINFORMACIO",fields:["CODIINOM","RESPFUNCIONAL","GESTORTIC"]},{name:"TRACTAMENTDADESPERSONALS",title:"Responsable tractaments",type:"child",readonly:!0,listName:"TRACTAMENTDADESPERSONALS",fields:["TITLE","FINALITAT","PERSONESAFECTADES"]}]}},Rt={class:"RELACIO-edit-layout"},_t={__name:"form-dadaelemental-entitat",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,i=(0,o.entityDefinition)(a.entity).entityName;at().load(i);const l=Ti(i),r="DADAELEMENTAL_SISTEMA"===i?"SISTEMAINFORMACIO":"DADAELEMENTAL_TRACTAMENT"===i?"TRACTAMENTDADESPERSONALS":i.substr(i.indexOf("_")+1),d=[{name:"ID_OBJECTEDADA",disabled:!0},{name:"ID_TIPUSDADA",disabled:!0}];"DADAELEMENTAL_EVIDENCIA"===i?(d.push("ID_PROCES"),d.push({name:"ID_EVIDENCIA",required:!0,useFilter:e=>t=>e.ID_PROCES&&t.ID_PROCES===e.ID_PROCES}),d.push("CARACTER_VARIABLE")):d.push("ID_"+r);const s=Ci(l,d);return t("change",(e=>{e.ID_TIPUSDADA=(0,o.entityParent)((0,o.entityBase)(a.entity)??a.entity).ID_TIPUSDADA})),t("change",(e=>{e.ID_OBJECTEDADA=(0,o.entityParent)((0,o.entityBase)(a.entity)??a.entity).ID_OBJECTEDADA})),(a,l)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",Rt,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(s),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(i),onChange:l[0]||(l[0]=e=>t("change",e.action))},null,8,["fields","entity","validations","cache-name"])]))}},Mt=(0,I.Z)(_t,[["__scopeId","data-v-3288286c"]]),xt={name:"DADAELEMENTAL",type:"listSplitted",label:"Dades elementals",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Dada elemental",type:"string",required:!0,maxlength:120},{name:"ID_OBJECTEDADA",label:"Objecte de la dada",type:"lookupCache",entity:{name:"OBJECTEDADA",primaryKey:"ID",targetKey:"TITLE"},required:!0},{name:"ID_TIPUSDADA",label:"Tipus de dada",type:"dictionary",entityName:"TIPUSDADA",required:!0},{name:"DESCRIPCIO",label:"Descripció",type:"string",maxlength:8e3,multiline:!0},{name:"REGLESVALIDACIO",label:"Regles de validació",type:"string",maxlength:8e3,multiline:!0},{name:"NIVELLDESEGURETAT",label:"Nivell RGPD",type:"choice",options:["Bàsic","Mitjà","Alt"],required:!0,maxlength:12},{name:"DADAELEMENTAL_INTEROPERABILITAT",label:"Disponible per Interoperabilitat",type:"lookupMultiCache",junction:{name:"DADAELEMENTAL_INTEROPERABILITAT",primaryKey:"ID",ownerKey:"ID_DADAELEMENTAL",targetKey:"ID_AGENT"},data:{name:"AGENT",primaryKey:"ID",targetKey:"CODIINOM"}},{name:"DADAELEMENTAL_SISTEMA",label:"Codi i nom sistemes d'informació",type:"lookupMultiCache",junction:{name:"DADAELEMENTAL_SISTEMA",primaryKey:"ID",ownerKey:"ID_DADAELEMENTAL",targetKey:"ID_SISTEMAINFORMACIO"},data:{name:"SISTEMAINFORMACIO",primaryKey:"ID",targetKey:"CODIINOM"}},{name:"DADAELEMENTAL_TRACTAMENT",label:"Tractaments dades personals",type:"lookupMultiCache",junction:{name:"DADAELEMENTAL_TRACTAMENT",primaryKey:"ID",ownerKey:"ID_DADAELEMENTAL",targetKey:"ID_TRACTAMENTDADESPERSONALS"},data:{name:"TRACTAMENTDADESPERSONALS",primaryKey:"ID",targetKey:"TITLE"}},{name:"CREATED",type:"date"},{name:"CREATEDBY",type:"string",maxlength:64},{name:"MODIFIED",type:"date"},{name:"MODIFIEDBY",type:"string",maxlength:64}],filter:[{name:"TITLE",label:"Nom de la dada conté",operation:"contains"},{name:"ID_TIPUSDADA",operation:"in"},{name:"DADAELEMENTAL_INTEROPERABILITAT",operation:"in"},{name:"ID_OBJECTEDADA",operation:"in"},{name:"DADAELEMENTAL_SISTEMA",operation:"in"},{name:"NIVELLDESEGURETAT",operation:"eq"},{name:"DADAELEMENTAL_TRACTAMENT",operation:"in"}],form:{component:"auto",class:"DADAELEMENTAL-editItem-layout",maxWidth:"990px",fields:e=>["TITLE","ID_TIPUSDADA","DADAELEMENTAL_INTEROPERABILITAT","ID_OBJECTEDADA","NIVELLDESEGURETAT"],rules:[async e=>await gt("DADAELEMENTAL",e,["TITLE","ID_TIPUSDADA","ID_OBJECTEDADA"],"and")],children:[{listName:"DADAELEMENTAL_EVIDENCIA",foreingKey:"ID_DADAELEMENTAL",detailFields:["ID_PROCES","ID_EVIDENCIA"]},{listName:"DADAELEMENTAL_QUADRECOMANDAMENT",foreingKey:"ID_DADAELEMENTAL",detailFields:["ID_QUADRECOMANDAMENT"]},{listName:"DADAELEMENTAL_INTERFICIECONNEXIO",foreingKey:"ID_DADAELEMENTAL",detailFields:["ID_INTERFICIECONNEXIO"]},{listName:"DADAELEMENTAL_SISTEMA",foreingKey:"ID_DADAELEMENTAL",detailFields:["ID_SISTEMAINFORMACIO"]},{listName:"DADAELEMENTAL_TRACTAMENT",foreingKey:"ID_DADAELEMENTAL",detailFields:["ID_TRACTAMENTDADESPERSONALS"]}],tabs:[{name:"DESCRIPCIO",title:"Descripció",component:"auto",fields:e=>[{name:"DESCRIPCIO",label:" "}]},{name:"REGLESVALIDACIO",title:"Regles validació",component:"auto",fields:e=>[{name:"REGLESVALIDACIO",label:" "}]},{name:"DADAELEMENTAL_EVIDENCIA",title:"Evidències",type:"child",listName:"DADAELEMENTAL_EVIDENCIA",fields:["ID_PROCES","ID_EVIDENCIA","CARACTER_VARIABLE"],form:{component:(0,n.markRaw)(Mt),maxWidth:"780px"}},{name:"DADAELEMENTAL_QUADRECOMANDAMENT",title:"Quadres comandament",type:"child",listName:"DADAELEMENTAL_QUADRECOMANDAMENT",fields:["ID_QUADRECOMANDAMENT"],form:{component:(0,n.markRaw)(Mt),maxWidth:"780px"}},{name:"DADAELEMENTAL_INTERFICIECONNEXIO",title:"Interfícies connexió",type:"child",listName:"DADAELEMENTAL_INTERFICIECONNEXIO",fields:["ID_INTERFICIECONNEXIO"],form:{component:(0,n.markRaw)(Mt),maxWidth:"780px"}},{name:"DADAELEMENTAL_SISTEMA",title:"Sistemes informació",type:"child",listName:"DADAELEMENTAL_SISTEMA",fields:["ID_SISTEMAINFORMACIO"],form:{component:(0,n.markRaw)(Mt),maxWidth:"780px"}},{name:"DADAELEMENTAL_TRACTAMENT",title:"Tractament D.personals",type:"child",listName:"DADAELEMENTAL_TRACTAMENT",fields:["ID_TRACTAMENTDADESPERSONALS"],form:{component:(0,n.markRaw)(Mt),maxWidth:"780px"}}]}},Lt=[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Nom curt",type:"string",required:!0,maxlength:255},{name:"CODI",label:"Codi",type:"string",required:!0,maxlength:24},{name:"NOMLLARG",label:"Disposició normativa",type:"string",required:!0,maxlength:8e3},{name:"AMBIT",label:"Àmbit",type:"choice",options:["Estatal","Autonòmic","Local","Europeu","Internacional"],required:!0,maxlength:80},{name:"RANG",label:"Rang",type:"choice",options:["Llei","Decret","Ordre","Disposició no publicada"],required:!0,maxlength:80},{name:"URLDISPOSICIO",label:"URL",type:"string",maxlength:255},{name:"ALTA",label:"Data vigència",type:"date",defaultValue:()=>new Date(Date.now())},{name:"BAIXA",label:"Data derogació",type:"date",defaultValue:()=>new Date(2099,11,31)},{name:"CREATED",type:"date"},{name:"CREATEDBY",type:"string",maxlength:64},{name:"MODIFIED",type:"date"},{name:"MODIFIEDBY",type:"string",maxlength:64},{name:"VIGENT",label:"Vigent",type:"boolean",readonly:!0}],Pt={class:"DISPOSICIONORMATIVA-editItem-layout"},wt={style:{"margin-top":"4px","grid-area":"errorMessage"}},Vt={__name:"form-disposicio",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,i=(0,o.entityDefinition)(a.entity).entityName;at().load(i);const l=Ci(Ti(i),["CODI","TITLE","NOMLLARG","RANG","AMBIT","URLDISPOSICIO","ALTA","BAIXA"]),{errorMessage:r}=a.validations.createValidation("generals",{rules:[async e=>await gt(i,e,["CODI"],"or")]});return(a,o)=>{const d=(0,n.resolveComponent)("fura-message-bar");return(0,n.openBlock)(),(0,n.createElementBlock)("div",Pt,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(l),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(i),onChange:o[0]||(o[0]=e=>t("change",e.action))},null,8,["fields","entity","validations","cache-name"]),(0,n.createElementVNode)("div",wt,[(0,n.unref)(r)?((0,n.openBlock)(),(0,n.createBlock)(d,{key:0,type:"error",singleline:""},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(r)),1)])),_:1})):(0,n.createCommentVNode)("v-if",!0)])])}}},Bt=(0,I.Z)(Vt,[["__scopeId","data-v-1cf08b05"]]),Ut={class:"DISPOSICIONORMATIVA-TRACTAMENTDADESPERSONALS-editItem-layout"},kt={style:{"margin-top":"4px","grid-area":"errorMessage"}},Ft={__name:"form-tractament",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,i=(0,o.entityDefinition)(a.entity).entityName;at().load(i);const l=Ci(Ti(i),[{name:"ID_DISPOSICIONORMATIVA",disabled:!0},"TITLE","FINALITAT","RECOLLIDADEDADES","ID_TIPUSPROCEDENCIA","ID_PROCEDENCIA","ID_TIPUSRESPONSABLE","ID_RESPONSABLE","ID_TIPUSRESPONSABLEARCO","ID_RESPONSABLEARCO","PERSONESAFECTADES","CESSIONSDEDADES","TRACTAMENT","SISTEMATRACTAMENT","TRANSFERENCIESINT","NIVELLDESEGURETAT","MESURESSEGURETAT","ALTA","BAIXA"]),{errorMessage:r}=a.validations.createValidation("generals",{rules:[async e=>await gt(i,e,["TITLE"],"or")]});return(a,o)=>{const d=(0,n.resolveComponent)("fura-message-bar");return(0,n.openBlock)(),(0,n.createElementBlock)("div",Ut,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(l),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(i),onChange:o[0]||(o[0]=e=>t("change",e.action))},null,8,["fields","entity","validations","cache-name"]),(0,n.createElementVNode)("div",kt,[(0,n.unref)(r)?((0,n.openBlock)(),(0,n.createBlock)(d,{key:0,type:"error",singleline:""},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(r)),1)])),_:1})):(0,n.createCommentVNode)("v-if",!0)])])}}},$t=(0,I.Z)(Ft,[["__scopeId","data-v-34d18808"]]),qt={name:"DISPOSICIONORMATIVA",type:"listSplitted",label:"Disposicions normatives",fields:Lt,filter:[{name:"CODI",label:"Codi Disposició normativa conté",operation:"contains"},{name:"TITLE",label:"Nom de la disposició normativa conté",operation:"contains"},{name:"RANG",operation:"eq"},{name:"AMBIT",operation:"eq"},{name:"TRACTAMENTS",operation:"in",type:"lookupCache",label:"Tractaments",entity:{entityName:"TRACTAMENTDADESPERSONALS",primaryKey:"ID",targetKey:"TITLE"}},{name:"PROCESSOS",operation:"in",type:"lookupCache",label:"Processos",entity:{entityName:"PROCES",primaryKey:"ID",targetKey:"CODIINOM"}},{name:"VIGENT",operation:"eq"}],form:{component:(0,n.markRaw)(Bt),maxWidth:"1200px",children:[{listName:"TRACTAMENTDADESPERSONALS",foreingKey:"ID_DISPOSICIONORMATIVA"}],tabs:[{name:"TRACTAMENTDADESPERSONALS",title:"Tractament Dades personals",type:"child",listName:"TRACTAMENTDADESPERSONALS",fields:["TITLE","FINALITAT"],component:"auto",form:{component:(0,n.markRaw)($t),maxWidth:"1200px"}}]}},Kt=[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"ID_PROCES",label:"Codi i nom procés",type:"lookupCache",entity:{name:"PROCES",primaryKey:"ID",targetKey:"CODIINOM"},required:!0},{name:"CODI",label:"Codi Evidència",type:"string",required:!0,maxlength:16},{name:"TITLE",label:"Evidència",type:"string",required:!0,maxlength:255},{name:"TIPUS",label:"Tipus",type:"choice",options:["Document","Dades"],required:!0,maxlength:24},{name:"CARACTER",label:"Caràcter",type:"choice",options:["Original","Còpia simple","Còpia autèntica"],required:!0,maxlength:24},{name:"ID_FORMAT",label:"Format",type:"dictionary",entityName:"FORMAT",required:!0},{name:"AUTENTIFICACIO",label:"Autentificació",type:"choice",options:["Sense autentificació","Signatura autògrafa","Segellat manual","Signatura electrònica","Segellat electrònic","Codi de verificació","Pista d'auditoria","Metadades"],required:!0,maxlength:24},{name:"REGISTREENTRADA",label:"Registre d'entrada",type:"choice",options:["Sí","No"],maxlength:24},{name:"REGISTRESORTIDA",label:"Registre de sortida",type:"choice",options:["Sí","No"],maxlength:24},{name:"ESSENCIAL",label:"Essencial",type:"boolean"},{name:"ID_TIPUSPRODUCTOR",label:"Tipus productor",type:"dictionary",entityName:"TIPUSAGENT",required:!0},{name:"ID_PRODUCTOR",label:"Codi i nom productor",type:"lookupCache",entity:{name:"AGENT",primaryKey:"ID",targetKey:"CODIINOM",cache:["ID_TIPUSAGENT"]},required:!0,useFilter:e=>t=>e.ID_TIPUSPRODUCTOR&&t.ID_TIPUSAGENT===e.ID_TIPUSPRODUCTOR},{name:"ID_TIPUSDESTINATARI",label:"Tipus destinatari",type:"dictionary",entityName:"TIPUSAGENT",navigationKey:"TIPUSAGENT1"},{name:"ID_DESTINATARI",label:"Codi i nom destinatari",type:"lookupCache",entity:{name:"AGENT",navigationKey:"AGENT1",primaryKey:"ID",targetKey:"CODIINOM",cache:["ID_TIPUSAGENT"]},useFilter:e=>t=>e.ID_TIPUSDESTINATARI&&t.ID_TIPUSAGENT===e.ID_TIPUSDESTINATARI},{name:"ID_SISTEMA",label:"Codi i nom sistema",type:"lookupCache",entity:{name:"SISTEMAINFORMACIO",primaryKey:"ID",targetKey:"CODIINOM"}},{name:"ID_DEPENDENCIA",label:"Depen de",type:"lookup",entity:{name:"EVIDENCIA",navigationKey:"EVIDENCIA2",primaryKey:"ID",targetKey:"CODIINOM"}},{name:"ID_SERIEDOCUMENTAL",label:"Codi i nom sèrie documental",type:"lookup",entity:{name:"SERIEDOCUMENTAL",navigationKey:"SERIEDOCUMENTAL1",primaryKey:"ID",targetKey:"CODIINOM"}},{name:"ID_TIPUSMODEL",label:"Tipus document",type:"dictionary",entityName:"TIPUSMODELDOCUMENT"},{name:"CRITERI",label:"Criteri per donar nom als documents",type:"string",maxlength:8e3,multiline:!0},{name:"ALTA",label:"Data alta",type:"date",defaultValue:()=>new Date(Date.now())},{name:"BAIXA",label:"Data de baixa",type:"date",defaultValue:()=>new Date(2099,11,31)},{name:"CODIINOM",label:"Codi i nom evidència",type:"string",readonly:!0},{name:"EVIDENCIA_MODELDOCUMENT",label:"Codi i nom models de document",type:"lookupMulti",junction:{name:"EVIDENCIA_MODELDOCUMENT",primaryKey:"ID",ownerKey:"ID_EVIDENCIA",targetKey:"ID_MODELDOCUMENT"},data:{name:"MODELDOCUMENT",primaryKey:"ID",targetKey:"CODIINOM"}},{name:"CREATED",type:"date"},{name:"CREATEDBY",type:"string",maxlength:64},{name:"MODIFIED",type:"date"},{name:"MODIFIEDBY",type:"string",maxlength:64},{name:"VIGENT",label:"Vigent",type:"boolean",readonly:!0},{name:"EVIDENCIA1/odata.count",type:"childCount",navigationKey:"EVIDENCIA1",loadAlwaysInView:!0},{name:"TASCA_EVIDENCIAENTRADA/odata.count",type:"childCount",navigationKey:"TASCA_EVIDENCIAENTRADA",loadAlwaysInView:!0},{name:"TASCA_EVIDENCIASORTIDA/odata.count",type:"childCount",navigationKey:"TASCA_EVIDENCIASORTIDA",loadAlwaysInView:!0}],Gt=[async e=>await gt("EVIDENCIA",e,["ID_PROCES","CODI"],"and")],jt={class:"EVIDENCIA-editItem-layout"},zt={style:{"margin-top":"4px","grid-area":"errorMessage"}},Wt={__name:"form-evidencia",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,i=(0,o.entityDefinition)(a.entity).entityName;at().load(i);const l=Ti(i),r=(0,n.computed)((()=>Ci(l,[{name:"ID_PROCES"},"CODI","TITLE","TIPUS","CARACTER","ID_SERIEDOCUMENTAL",{name:"ID_SERIEDOCUMENTAL",filter:`ID_PROCES eq ${a.entity.ID_PROCES||0}`},"REGISTREENTRADA","REGISTRESORTIDA","ID_TIPUSPRODUCTOR","ID_PRODUCTOR","AUTENTIFICACIO","ID_TIPUSDESTINATARI","ID_DESTINATARI","ID_FORMAT","ESSENCIAL","ID_SISTEMA",{name:"ID_DEPENDENCIA",filter:`ID_PROCES eq ${a.entity.ID_PROCES||0}`},"ID_TIPUSMODEL",{name:"EVIDENCIA_MODELDOCUMENT",filter:`ID_TIPUS eq ${a.entity.ID_TIPUSMODEL||0}`},"ALTA","BAIXA"]))),{errorMessage:d}=a.validations.createValidation("generals",{rules:Gt});return(a,l)=>{const o=(0,n.resolveComponent)("fura-message-bar");return(0,n.openBlock)(),(0,n.createElementBlock)("div",jt,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(r),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(i),onChange:l[0]||(l[0]=e=>t("change",e.action))},null,8,["fields","entity","validations","cache-name"]),(0,n.createElementVNode)("div",zt,[(0,n.unref)(d)?((0,n.openBlock)(),(0,n.createBlock)(o,{key:0,type:"error",singleline:""},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(d)),1)])),_:1})):(0,n.createCommentVNode)("v-if",!0)])])}}},Yt=(0,I.Z)(Wt,[["__scopeId","data-v-c6ceca4c"]]);function Xt(){const e=(0,n.ref)(window.opener),t=(0,n.ref)(!!window.opener),a=[];function i(e){for(const t of a)t(e.detail)}return(0,n.onScopeDispose)((()=>{window.removeEventListener("message",i)})),(0,n.readonly)({isChildWindow:t,parentWindow:e,close:function(){window.close()},onMessage:function(e){a.push(e)},sendMessage:function(t){const a=new CustomEvent("message",{detail:t});e.value?.dispatchEvent(a)}})}const Ht=[];function Zt(e){Ht.length>0&&"function"==typeof e&&Ht[Ht.length-1].push(e)}function Jt(){Ht.push([])}function Qt(){Ht.pop()}function ea(...e){if(Ht.length>0){const t=Ht[Ht.length-1];for(const a of t)a(...e)}}const ta={class:"RELACIO-edit-layout"},aa={__name:"form-entitat-dadaelemental",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,i=(0,o.entityDefinition)(a.entity).entityName,l=at();l.load(i);const r=Ti(i),{open:d,onMessage:s}=function(){const e=(0,n.ref)(!1),t=(0,n.ref)(null);let a;const i=[],l=[];function o(e){for(const t of l)t(e.detail)}return(0,n.onScopeDispose)((()=>{clearInterval(a),window.removeEventListener("message",o)})),(0,n.readonly)({isOpen:e,childWindow:t,open:function(l,r="_blank",d){t.value=window.open((0,n.unref)(l),(0,n.unref)(r),(0,n.unref)(d)),e.value=!0,a=setInterval((()=>{if(t.value.closed){clearInterval(a),window.removeEventListener("message",o),a=null,e.value=!1;for(const e of i)e()}}),0),window.addEventListener("message",o)},close:function(){t.value.close()},onClose:function(e){i.push(e)},onMessage:function(e){l.push(e)},sendMessage:function(e){const a=new CustomEvent("message",{detail:e});t.value?.dispatchEvent(a)}})}();s((({action:e})=>{"save"===e&&l.reloadField(i,"ID_DADAELEMENTAL")})),Zt((()=>{const e="DADAELEMENTAL_EVIDENCIA"===i?(0,o.entityParent)((0,o.entityBase)(a.entity)??a.entity).ID_PROCES:0;t("change",(t=>{t.ID_PROCES=e}))}));const u=(0,n.computed)((()=>Ci(r,"DADAELEMENTAL_EVIDENCIA"===i?[{name:"ID_PROCES",disabled:!0,useFilter:e=>t=>t.ID===e.ID_PROCES},"ID_OBJECTEDADA","ID_TIPUSDADA","CARACTER_VARIABLE",{name:"ID_DADAELEMENTAL",useFilter:e=>t=>e.ID_TIPUSDADA&&e.ID_OBJECTEDADA&&t.ID_TIPUSDADA===e.ID_TIPUSDADA&&t.ID_OBJECTEDADA===e.ID_OBJECTEDADA}]:["ID_OBJECTEDADA","ID_TIPUSDADA",{name:"ID_DADAELEMENTAL",useFilter:e=>t=>e.ID_TIPUSDADA&&e.ID_OBJECTEDADA&&t.ID_TIPUSDADA===e.ID_TIPUSDADA&&t.ID_OBJECTEDADA===e.ID_OBJECTEDADA}])));return(a,l)=>{const o=(0,n.resolveComponent)("fura-button");return(0,n.openBlock)(),(0,n.createElementBlock)("div",ta,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(u),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(i),onChange:l[0]||(l[0]=e=>t("change",e.action))},null,8,["fields","entity","validations","cache-name"]),(0,n.createVNode)(o,{class:"alta",text:"Afegir nova dada elemental",disabled:!!e.entity.ID_DADAELEMENTAL,onClick:l[1]||(l[1]=e=>(0,n.unref)(d)(`/${(0,n.unref)(ce)}/DADAELEMENTAL/create?popup`))},null,8,["disabled"])])}}},na=(0,I.Z)(aa,[["__scopeId","data-v-0ec929a4"]]),ia={name:"EVIDENCIA",type:"listSplitted",label:"Evidències",fields:Kt,filter:[{name:"ID_PROCES",operation:"in"},{name:"ID_SERIEDOCUMENTAL",operation:"in"},{name:"ID_SISTEMA",operation:"in"},{name:"CODI",operation:"contains"},{name:"TITLE",operation:"contains"},{name:"ID_PRODUCTOR",operation:"in"},{name:"ID_DESTINATARI",operation:"in"},{name:"TIPUS",operation:"eq"},{name:"CARACTER",operation:"eq"},{name:"AUTENTIFICACIO",operation:"eq"},{name:"ID_FORMAT",operation:"in"},{name:"REGISTREENTRADA",operation:"eq"},{name:"REGISTRESORTIDA",operation:"eq"},{name:"ESSENCIAL",operation:"eq"},{name:"VIGENT",operation:"eq"}],form:{component:(0,n.markRaw)(Yt),maxWidth:"1200px",children:[{listName:"DADAELEMENTAL_EVIDENCIA",foreingKey:"ID_EVIDENCIA",detailFields:["ID_OBJECTEDADA","ID_TIPUSDADA","ID_DADAELEMENTAL"]},{listName:"TASCA_EVIDENCIAENTRADA",foreingKey:"ID_EVIDENCIA",detailFields:["ID_TASCA"]},{listName:"TASCA_EVIDENCIASORTIDA",foreingKey:"ID_EVIDENCIA",detailFields:["ID_TASCA"]}],tabs:[{name:"CRITERI",title:"Criteri per donar nom als documents",component:"auto",fields:e=>[{name:"CRITERI",label:" "}]},{name:"DADAELEMENTAL_EVIDENCIA",title:"Dades elementals",type:"child",listName:"DADAELEMENTAL_EVIDENCIA",fields:["ID_OBJECTEDADA","ID_TIPUSDADA","ID_DADAELEMENTAL","CARACTER_VARIABLE"],form:{component:(0,n.markRaw)(na),maxWidth:"780px"}},{name:"TASCA_EVIDENCIAENTRADA",title:"Tasques d'entrada",type:"child",listName:"TASCA_EVIDENCIAENTRADA",fields:["ID_TASCA"],readonly:!0},{name:"TASCA_EVIDENCIASORTIDA",title:"Tasques d'entrada",type:"child",listName:"TASCA_EVIDENCIASORTIDA",fields:["ID_TASCA"],readonly:!0}]},permissionDenied:e=>({create:!1,edit:!1,delete:e&&e["EVIDENCIA1@odata.count"]+e["TASCA_EVIDENCIAENTRADA@odata.count"]+e["TASCA_EVIDENCIASORTIDA@odata.count"]!==0,export:!1})},la=[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Interfície",type:"string",required:!0,maxlength:80},{name:"ID_TIPUSINTERFICIE",label:"Tipus interfície",type:"lookupCache",entity:{name:"TIPUSINTERFICIE",primaryKey:"ID",targetKey:"TITLE"},required:!0},{name:"ID_TIPUSIMPORTACIO",label:"Tipus Importació",type:"lookupCache",entity:{name:"TIPUSIMPORTACIO",primaryKey:"ID",targetKey:"TITLE"},required:!0},{name:"ID_PROCEDIMENTIMPORTACIO",label:"Procediment d'Importació",type:"dictionary",entityName:"PROCEDIMENTIMPORTACIO",required:!0},{name:"ID_PERIODEACTUALITZACIO",label:"Període actualització",type:"dictionary",entityName:"PERIODEACTUALITZACIO",required:!0},{name:"ID_SISTEMAINFORMACIO",label:"Sistema destí de les dades",type:"lookupCache",allowFreeform:!0,immediateScroll:!0,entity:{name:"SISTEMAINFORMACIO",primaryKey:"ID",targetKey:"CODIINOM"},required:!0},{name:"ID_HISTORIFICACIO",label:"Historifiació",type:"dictionary",entityName:"HISTORIFICACIO",required:!0},{name:"ID_SISTEMAORIGENDADES",label:"Sistema origen de les dades",type:"lookupCache",entity:{name:"SISTEMAINFORMACIO",navigationKey:"SISTEMAINFORMACIO1",primaryKey:"ID",targetKey:"CODIINOM"}},{name:"NOMARXIUCARREGA",label:"Nom arxiu càrrega de dades",type:"string",maxlength:120},{name:"OBSERVACIONS",label:"Observacions",type:"string",maxlength:8e3,multiline:!0},{name:"ALTA",label:"Data vigència",type:"date",required:!0,defaultValue:()=>new Date(Date.now())},{name:"BAIXA",label:"Data baixa",type:"date",defaultValue:()=>new Date(2099,11,31)},{name:"INTERFICIECONNEXIO_ATTACHMENT",label:"Adj.",type:"fileMulti",entity:{name:"INTERFICIECONNEXIO_ATTACHMENT",primaryKey:"ID",foreingKey:"ID_INTERFICIECONNEXIO",nameKey:"FILENAME",contentKey:"FILECONTENT",typeKey:"CONTENTTYPE"},detailsColumn:{width:"60px",align:"center"}},{name:"CREATED",type:"date"},{name:"CREATEDBY",type:"string",maxlength:64},{name:"MODIFIED",type:"date"},{name:"MODIFIEDBY",type:"string",maxlength:64},{name:"VIGENT",label:"Vigent",type:"boolean",readonly:!0}],oa={class:"INTERFICIECONNEXIO-editItem-layout"},ra={style:{"margin-top":"4px","grid-area":"errorMessage"}},da={__name:"form-interficie",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,i=(0,o.entityDefinition)(a.entity).entityName;at().load(i);const l=Ti(i),r=(0,n.computed)((()=>Ci(l,["ID_SISTEMAINFORMACIO","TITLE","ID_TIPUSINTERFICIE","ID_TIPUSIMPORTACIO","ID_PROCEDIMENTIMPORTACIO","ID_PERIODEACTUALITZACIO","ID_HISTORIFICACIO",{name:"ID_SISTEMAORIGENDADES",required:!a.entity.NOMARXIUCARREGA},{name:"NOMARXIUCARREGA",required:!a.entity.ID_SISTEMAORIGENDADES},"ALTA","BAIXA"]))),{errorMessage:d}=a.validations.createValidation("generals",{rules:[async e=>await gt(i,e,["ID_SISTEMAINFORMACIO","TITLE"],"and")]});return(a,l)=>{const o=(0,n.resolveComponent)("fura-message-bar");return(0,n.openBlock)(),(0,n.createElementBlock)("div",oa,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(r),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(i),onChange:l[0]||(l[0]=e=>t("change",e.action))},null,8,["fields","entity","validations","cache-name"]),(0,n.createElementVNode)("div",ra,[(0,n.unref)(d)?((0,n.openBlock)(),(0,n.createBlock)(o,{key:0,type:"error",singleline:""},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(d)),1)])),_:1})):(0,n.createCommentVNode)("v-if",!0)])])}}},sa=(0,I.Z)(da,[["__scopeId","data-v-9bf8f21c"]]),ua={name:"INTERFICIECONNEXIO",type:"listSplitted",label:"Interfícies càrrega de dades",fields:la,filter:[{name:"TITLE",label:"Nom de la interfície conté",operation:"contains"},{name:"ID_SISTEMAINFORMACIO",operation:"in"},{name:"DADAELEMENTAL_INTERFICIECONNEXIO",operation:"in"},{name:"ID_TIPUSINTERFICIE",operation:"in"},{name:"ID_TIPUSIMPORTACIO",operation:"in"},{name:"ID_PROCEDIMENTIMPORTACIO",operation:"in"},{name:"ID_PERIODEACTUALITZACIO",operation:"in"},{name:"ID_HISTORIFICACIO",operation:"in"},{name:"ID_SISTEMAORIGENDADES",operation:"in"},{name:"INTERFICIECONNEXIO_ATTACHMENT",label:"Té adjunts",operation:"has"},{name:"VIGENT",operation:"eq"}],form:{component:(0,n.markRaw)(sa),maxWidth:"960px",children:[{listName:"DADAELEMENTAL_INTERFICIECONNEXIO",foreingKey:"ID_INTERFICIECONNEXIO",detailFields:["ID_OBJECTEDADA","ID_TIPUSDADA","ID_DADAELEMENTAL"]}],tabs:[{name:"OBSERVACIONS",title:"Observacions",component:"auto",fields:e=>[{name:"OBSERVACIONS",label:" "}]},{name:"DADAELEMENTAL_INTERFICIECONNEXIO",title:"Dades elementals",type:"child",listName:"DADAELEMENTAL_INTERFICIECONNEXIO",fields:["ID_OBJECTEDADA","ID_TIPUSDADA","ID_DADAELEMENTAL"],form:{component:(0,n.markRaw)(na),maxWidth:"780px"}},{name:"INTERFICIECONNEXIO_ATTACHMENT",title:"Arxius adjunts",component:"auto",fields:e=>[{name:"INTERFICIECONNEXIO_ATTACHMENT",label:" ",multiline:!0}]}]}},ca={name:"MODELDOCUMENT",type:"listSplitted",label:"Models de document",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Model de document",type:"string",required:!0,maxlength:255},{name:"CODI",label:"Codi",type:"string",required:!0,maxlength:16},{name:"ID_TIPUS",label:"Tipus document",type:"lookupCache",entity:{name:"TIPUSMODELDOCUMENT",primaryKey:"ID",targetKey:"TITLE"},required:!0},{name:"VERSIO",label:"Versió",type:"number",required:!0},{name:"ID_FORMAT",label:"Format",type:"dictionary",entityName:"FORMAT",required:!0},{name:"FIDESENVOLUPAMENT",label:"Dt fi desenvolupament",type:"date"},{name:"ACCEPTACIO",label:"Dt acceptació",type:"date"},{name:"POSSADAPRODUCCIO",label:"Dt posada en producció",type:"date"},{name:"URL",label:"URL o nom del model adjunt",type:"string",maxlength:255},{name:"ALTA",label:"Data alta",type:"date",defaultValue:()=>new Date(Date.now())},{name:"BAIXA",label:"Data de baixa",type:"date",defaultValue:()=>new Date(2099,11,31)},{name:"CODIINOM",label:"Codi i Nom Agent",type:"string",readonly:!0},{name:"MODELDOCUMENT_ATTACHMENT",label:"Adj.",type:"fileMulti",entity:{name:"MODELDOCUMENT_ATTACHMENT",primaryKey:"ID",foreingKey:"ID_MODELDOCUMENT",nameKey:"FILENAME",contentKey:"FILECONTENT",typeKey:"CONTENTTYPE"},detailsColumn:{width:"60px",align:"center"}},{name:"CREATED",type:"date"},{name:"CREATEDBY",type:"string",maxlength:64},{name:"MODIFIED",type:"date"},{name:"MODIFIEDBY",type:"string",maxlength:64},{name:"VIGENT",label:"Vigent",type:"boolean",readonly:!0}],filter:[{name:"CODI",operation:"contains"},{name:"TITLE",operation:"contains"},{name:"ID_TIPUS",operation:"in"},{name:"ID_FORMAT",operation:"in"},{name:"FIDESENVOLUPAMENT",operation:"between"},{name:"ACCEPTACIO",operation:"between"},{name:"POSSADAPRODUCCIO",operation:"between"},{name:"MODELDOCUMENT_ATTACHMENT",label:"Té adjunts",operation:"has"},{name:"VIGENT",operation:"eq"}],form:{component:"auto",class:"MODELDOCUMENT-editItem-layout",maxWidth:"930px",fields:e=>[{name:"CODI",async onChange(e){const t=await Ne("MODELDOCUMENT",{$select:"TITLE, ID_TIPUS, VERSIO",$filter:G({and:[{eq:[{property:"CODI"},e.CODI],ne:[{property:"ID"},e.ID]}]}),$orderby:"VERSIO desc",$top:1},{},{withoutDialog:!0});return t.value.length>0?e=>{e.TITLE=t.value[0].TITLE,e.ID_TIPUS=t.value[0].ID_TIPUS,e.VERSIO=t.value[0].VERSIO+1}:e=>{e.TITLE="",e.VERSIO=1}}},{name:"VERSIO",onChange(e){const t=e.ID_FORMAT;return e=>{e.ID_FORMAT=t+1}}},"TITLE","ID_TIPUS",{name:"ID_FORMAT",onChange(e){const t=e.TITLE;return e=>{e.TITLE=t+"1"}}},"ID_FORMAT","FIDESENVOLUPAMENT","ACCEPTACIO","POSSADAPRODUCCIO","URL","ALTA","BAIXA",{name:"MODELDOCUMENT_ATTACHMENT",label:"Arxius adjunts"}],rules:[async e=>await gt("MODELDOCUMENT",e,["CODI","VERSIO"],"and")]}},ma={name:"OBJECTEDADA",type:"listSplitted",label:"Objecte de les dades",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Objecte de la dada",type:"string",defaultField:!0,required:!0,maxlength:120},{name:"TIPUS",label:"Tipus",type:"choice",options:["Cosa","Acció"],maxlength:12},{name:"SUPEROBJECTE",label:"Superobjecte",type:"string",maxlength:80}],filter:[{name:"TITLE",label:"Objecte de la dada conté",operation:"contains"},{name:"TIPUS",operation:"in"},{name:"SUPEROBJECTE",label:"Superobjecte conté",operation:"contains"}],form:{component:"auto",class:"OBJECTEDADA-editItem-layout",maxWidth:"690px",fields:e=>["TITLE","TIPUS","SUPEROBJECTE"],rules:[async e=>await gt("OBJECTEDADA",e,["TITLE"],"or")]}},pa=[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"CODI",label:"Codi",type:"string",required:!0,maxlength:24,detailsColumn:{width:"70px"},gridColumn:{width:"100px"}},{name:"TITLE",label:"Nom del Procés",type:"string",required:!0,maxlength:255,gridColumn:{width:"800px"}},{name:"TIPUS",label:"Tipus procés",type:"choice",options:["Estratègic","Clau","De Suport"],required:!0,maxlength:24},{name:"ID_TIPUSRESPONSABLE",label:"Tipus Responsable",type:"dictionary",entityName:"TIPUSAGENT",required:!0},{name:"ID_RESPONSABLE",label:"Codi i nom unitat responsable",type:"lookupCache",entity:{name:"AGENT",primaryKey:"ID",targetKey:"CODIINOM",cache:["ID_TIPUSAGENT"]},required:!0,useFilter:e=>t=>e.ID_TIPUSRESPONSABLE&&t.ID_TIPUSAGENT===e.ID_TIPUSRESPONSABLE},{name:"AMBIT",label:"Àmbit",type:"choice",options:["Ajuntament","CEB","Generalitat"],required:!0,maxlength:24,defaultValue:"CEB"},{name:"ID_TIPUSINICIACIO",label:"Tipus iniciació",type:"dictionary",entityName:"TIPUSINICIACIO",required:!0},{name:"ID_FAMILIA",label:"Família",type:"dictionary",entityName:"FAMILIA",required:!0},{name:"ID_TIPUSFINALITZACIO",label:"Tipus finalització",type:"dictionary",entityName:"TIPUSFINALITZACIO",required:!0},{name:"ID_FAMILIAOPAE",label:"Família OPAE",type:"dictionary",entityName:"FAMILIAOPAE"},{name:"DESCRIPCIO",label:"Descripció",type:"string",maxlength:8e3,multiline:!0},{name:"ID_TIPUSRECURSPROCES",label:"Tipus recurs",type:"dictionary",entityName:"TIPUSRECURSPROCES",loadAlwaysInView:!0},{name:"NECESSITATDEPAGAMENT",label:"Necessitat de pagament",type:"boolean"},{name:"MACROPROCES",label:"Macro procés",type:"boolean"},{name:"REQUISITSAACREDITAR",label:"Requisits a acreditar",type:"string",maxlength:8e3,multiline:!0},{name:"TERMINISRELLEVANTS",label:"Terminis rellevants",type:"string",maxlength:8e3,multiline:!0},{name:"URLDIAGRAMA",label:"URL diagrama",type:"string",maxlength:255},{name:"DESTINATARIS",label:"Destinataris del procés",type:"string",maxlength:255},{name:"ALTA",label:"Data alta",type:"date",defaultValue:()=>new Date(Date.now())},{name:"BAIXA",label:"Data de baixa",type:"date",defaultValue:()=>new Date(2099,11,31)},{name:"CODIINOM",label:"Codi i nom del procés",type:"string",readonly:!0,loadAlwaysInView:!0},{name:"PROCES_DISPOSICIO",label:"Disposicions",type:"lookupMultiCache",junction:{name:"PROCES_DISPOSICIO",primaryKey:"ID",ownerKey:"ID_PROCES",targetKey:"ID_DISPOSICIONORMATIVA",dictionaryKey:"ID_DISPOSICIONORMATIVA"},data:{name:"DISPOSICIONORMATIVA",primaryKey:"ID",targetKey:"TITLE"}},{name:"ID_RESPONSABLE/TITLE",label:"Nom unitat responsable",type:"lookup",entity:{name:"AGENT",primaryKey:"ID",targetKey:"TITLE"}},{name:"PROCES_ATTACHMENT",label:"Adj.",type:"fileMulti",entity:{name:"PROCES_ATTACHMENT",primaryKey:"ID",foreingKey:"ID_PROCES",nameKey:"FILENAME",contentKey:"FILECONTENT",typeKey:"CONTENTTYPE"},detailsColumn:{width:"40px",align:"center"}},{name:"CREATED",type:"date"},{name:"CREATEDBY",type:"string",maxlength:64},{name:"MODIFIED",type:"date"},{name:"MODIFIEDBY",type:"string",maxlength:64},{name:"VIGENT",label:"Vigent",type:"boolean",readonly:!0},{name:"TASCA/odata.count",type:"childCount",navigationKey:"TASCA",loadAlwaysInView:!0}],ya={class:"PROCES-editItem-layout"},Ia={style:{"margin-top":"4px","grid-area":"errorMessage"}},fa={__name:"form-proces",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,i=(0,o.entityDefinition)(a.entity).entityName;at().load(i);const l=Ci(Ti(i),["CODI","TITLE","TIPUS","ID_TIPUSRESPONSABLE","ID_RESPONSABLE","AMBIT","ID_TIPUSINICIACIO","ID_FAMILIA","ID_TIPUSFINALITZACIO","ID_FAMILIAOPAE","ID_TIPUSRECURSPROCES","MACROPROCES","NECESSITATDEPAGAMENT","PROCES_DISPOSICIO","URLDIAGRAMA","DESTINATARIS","ALTA","BAIXA"]),{errorMessage:r}=a.validations.createValidation("generals",{rules:[async e=>await gt(i,e,["CODI","TITLE"],"or")]});return(a,o)=>{const d=(0,n.resolveComponent)("fura-message-bar");return(0,n.openBlock)(),(0,n.createElementBlock)("div",ya,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(l),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(i),onChange:o[0]||(o[0]=e=>t("change",e.action))},null,8,["fields","entity","validations","cache-name"]),(0,n.createElementVNode)("div",Ia,[(0,n.unref)(r)?((0,n.openBlock)(),(0,n.createBlock)(d,{key:0,type:"error",singleline:""},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(r)),1)])),_:1})):(0,n.createCommentVNode)("v-if",!0)])])}}},Ea=(0,I.Z)(fa,[["__scopeId","data-v-24f2d710"]]),Aa=[e=>1!==e.ID_FORMABPMN&&(!e.TASCA_PRECEDENT||0===e.TASCA_PRECEDENT.length)&&"Exceptuant la tasca 'Inici de procés' totes les tasques han de tenir una o vàries tasques anteriors",e=>1===e.ID_FORMABPMN&&e.TASCA_PRECEDENT&&e.TASCA_PRECEDENT.length>0&&"Tasca inicial no pot tenir tasques anteriors",async e=>{if(1===e.ID_FORMABPMN){const{"@odata.count":t}=await Ne("TASCA",{$filter:"number"==typeof e.ID?`ID_PROCES eq ${e.ID_PROCES} and ID_FORMABPMN eq 1 and ID ne ${e.ID}`:`ID_PROCES eq ${e.ID_PROCES} and ID_FORMABPMN eq 1`,$count:!0,$top:1});if(t>0)return"Un procés no pot incloure dos tasques de tipus 'Inici de procés'."}},e=>"number"==typeof e.ID&&e.TASCA_PRECEDENT&&e.TASCA_PRECEDENT.includes(e.ID)&&"Una tasca no pot tenir com a Tasca precedent a sí mateixa.",e=>gt("TASCA",e,["ID_PROCES","CODI"],"and")],Ta={class:"PROCES-TASCA-editItem-layout"},Ca={style:{"margin-top":"4px","grid-area":"errorMessage"}},Da={__name:"form-tasca",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,i=(0,o.entityDefinition)(a.entity).entityName;at().load(i);const l=Ti(i),r=(0,n.computed)((()=>Ci(l,[{name:"ID_PROCES",disabled:!0},"CODI",{name:"TITLE",onChange:d},"ID_FORMABPMN","NOMCURT","ID_TIPUSAGENT",{name:"ID_AGENT",type:"lookup",filter:`ID_TIPUSAGENT eq ${a.entity.ID_TIPUSAGENT||0}`},"ID_TIPUSTASCA",{name:"TASCA_PRECEDENT",required:1!==a.entity.ID_FORMABPMN,disabled:1===a.entity.ID_FORMABPMN,type:"lookupMulti",junction:{name:"TASCA_PRECEDENT",primaryKey:"ID",ownerKey:"ID_TASCA",targetKey:"ID_TASCA_PRECEDENT"},data:{name:"TASCA",primaryKey:"ID",targetKey:"CODIINOM",filter:`ID_PROCES eq ${a.entity.ID_PROCES||0}`},clearValueOnDisabled:!0},{name:"LINKTITLE",disabled:1===a.entity.ID_FORMABPMN,clearValueOnDisabled:!0},{name:"TASCA_EVIDENCIAENTRADA",data:{name:"EVIDENCIA",primaryKey:"ID",targetKey:"CODIINOM",filter:`ID_PROCES eq ${a.entity.ID_PROCES||0}`}},{name:"TASCA_EVIDENCIASORTIDA",data:{name:"EVIDENCIA",primaryKey:"ID",targetKey:"CODIINOM",filter:`ID_PROCES eq ${a.entity.ID_PROCES||0}`}},"DESCRIPCIO",{name:"ID_PROCES",type:"hidden"}])));function d(e){t("change",(e=>{e.NOMCURT=e.TITLE}))}const{errorMessage:s}=a.validations.createValidation("generals",{rules:Aa});return(a,l)=>{const o=(0,n.resolveComponent)("fura-message-bar");return(0,n.openBlock)(),(0,n.createElementBlock)("div",Ta,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(r),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(i),onChange:l[0]||(l[0]=e=>t("change",e.action))},null,8,["fields","entity","validations","cache-name"]),(0,n.createElementVNode)("div",Ca,[(0,n.unref)(s)?((0,n.openBlock)(),(0,n.createBlock)(o,{key:0,type:"error",singleline:""},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(s)),1)])),_:1})):(0,n.createCommentVNode)("v-if",!0)])])}}},Na=(0,I.Z)(Da,[["__scopeId","data-v-1a9dff61"]]),ga={class:"PROCES-EVIDENCIA-editItem-layout"},va={style:{"margin-top":"4px","grid-area":"errorMessage"}},Oa={__name:"form-evidencia",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,i=(0,o.entityDefinition)(a.entity).entityName;at().load(i);const l=Ti(i),r=(0,n.computed)((()=>Ci(l,[{name:"ID_PROCES",disabled:!0},"CODI","TITLE","TIPUS","CARACTER","ID_SERIEDOCUMENTAL",{name:"ID_SERIEDOCUMENTAL",type:"lookup",filter:`ID_PROCES eq ${a.entity.ID_PROCES}`},"REGISTREENTRADA","REGISTRESORTIDA","ID_TIPUSPRODUCTOR","ID_PRODUCTOR","AUTENTIFICACIO","ID_TIPUSDESTINATARI","ID_DESTINATARI","ID_FORMAT","ESSENCIAL","ID_SISTEMA",{name:"ID_DEPENDENCIA",type:"lookup",filter:`ID_PROCES eq ${a.entity.ID_PROCES}`},"ID_TIPUSMODEL",{name:"EVIDENCIA_MODELDOCUMENT",data:{name:"MODELDOCUMENT",primaryKey:"ID",targetKey:"CODIINOM",filter:`ID_TIPUS eq ${a.entity.ID_TIPUSMODEL||0}`}},"ALTA","BAIXA"]))),{errorMessage:d}=a.validations.createValidation("generals",{rules:Gt});return(a,l)=>{const o=(0,n.resolveComponent)("fura-message-bar");return(0,n.openBlock)(),(0,n.createElementBlock)("div",ga,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(r),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(i),onChange:l[0]||(l[0]=e=>t("change",e.action))},null,8,["fields","entity","validations","cache-name"]),(0,n.createElementVNode)("div",va,[(0,n.unref)(d)?((0,n.openBlock)(),(0,n.createBlock)(o,{key:0,type:"error",singleline:""},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(d)),1)])),_:1})):(0,n.createCommentVNode)("v-if",!0)])])}}},Sa=(0,I.Z)(Oa,[["__scopeId","data-v-38c8aeee"]]),ba=[async e=>await gt("SERIEDOCUMENTAL",e,["ID_PROCES","CODI"],"and")],ha={class:"PROCES-SERIEDOCUMENTAL-editItem-layout"},Ra={style:{"margin-top":"4px","grid-area":"errorMessage"}},_a={__name:"form-serie-documental",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,i=(0,o.entityDefinition)(a.entity).entityName;at().load(i);const l=Ti(i),r=(0,n.computed)((()=>Ci(l,[{name:"ID_PROCES",disabled:!0},"CODI","TITLE","DIGITAL","VITAL","CLASSIFICACIO","TITOLCORPORATIU","CARACTER","ID_TIPUSPRODUCTOR","ID_PRODUCTOR","CRITERINORMALITZACIO","ID_TRACTAMENTDADESPERSONALS","ALTA","BAIXA"]))),{errorMessage:d}=a.validations.createValidation("generals",{rules:ba});return(a,l)=>{const o=(0,n.resolveComponent)("fura-message-bar");return(0,n.openBlock)(),(0,n.createElementBlock)("div",ha,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(r),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(i),onChange:l[0]||(l[0]=e=>t("change",e.action))},null,8,["fields","entity","validations","cache-name"]),(0,n.createElementVNode)("div",Ra,[(0,n.unref)(d)?((0,n.openBlock)(),(0,n.createBlock)(o,{key:0,type:"error",singleline:""},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(d)),1)])),_:1})):(0,n.createCommentVNode)("v-if",!0)])])}}},Ma=(0,I.Z)(_a,[["__scopeId","data-v-7d9d90e6"]]),xa={class:"PROCES-PROCES-editItem-layout"},La={__name:"form-proces-proces",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,i=(0,o.entityDefinition)(a.entity).entityName;at().load(i);const l=Ci(Ti(i),[{name:"ID_PROCES",disabled:!0},"ID_RELACIONATAMB","ID_TIPUSRELACIO","OBS"]);return(a,o)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",xa,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(l),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(i),onChange:o[0]||(o[0]=e=>t("change",e.action))},null,8,["fields","entity","validations","cache-name"])]))}},Pa=(0,I.Z)(La,[["__scopeId","data-v-d2999476"]]),wa={class:"PROCES-INDICADOR-editItem-layout"},Va={style:{"margin-top":"4px","grid-area":"errorMessage"}},Ba={__name:"form-indicador",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,i=(0,o.entityDefinition)(a.entity).entityName;at().load(i);const l=Ci(Ti(i),[{name:"ID_PROCES",disabled:!0},"ID_TIPUSINDICADOR","TITLE","PERIODICITATMESURA","CONCEPTE","DESCRIPCIO","FORMULADECALCUL"]),{errorMessage:r}=a.validations.createValidation("generals",{rules:[async e=>await gt(i,e,["TITLE"],"or")]});return(a,o)=>{const d=(0,n.resolveComponent)("fura-message-bar");return(0,n.openBlock)(),(0,n.createElementBlock)("div",wa,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(l),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(i),onChange:o[0]||(o[0]=e=>t("change",e.action))},null,8,["fields","entity","validations","cache-name"]),(0,n.createElementVNode)("div",Va,[(0,n.unref)(r)?((0,n.openBlock)(),(0,n.createBlock)(d,{key:0,type:"error",singleline:""},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(r)),1)])),_:1})):(0,n.createCommentVNode)("v-if",!0)])])}}},Ua=(0,I.Z)(Ba,[["__scopeId","data-v-58ca086b"]]),ka={component:(0,n.markRaw)(Ea),maxWidth:"1200px",children:[{listName:"TASCA",foreingKey:"ID_PROCES",detailFields:["ID_AGENT"]},{listName:"EVIDENCIA",foreingKey:"ID_PROCES"},{listName:"SERIEDOCUMENTAL",foreingKey:"ID_PROCES",detailFields:["ID_PRODUCTOR"]},{listName:"PROCES_INDICADOR",foreingKey:"ID_PROCES",detailFields:["ID_TIPUSINDICADOR"]},{listName:"PROCES_PROCES",foreingKey:"ID_PROCES",detailFields:["ID_RELACIONATAMB","ID_TIPUSRELACIO"]}],tabs:[{name:"DESCRIPCIO",title:"Descripció",component:"auto",fields:e=>[{name:"DESCRIPCIO",label:" "}]},{name:"REQUISITSAACREDITAR",title:"Requisits a acreditar",component:"auto",fields:e=>[{name:"REQUISITSAACREDITAR",label:" "}]},{name:"TERMINISRELLEVANTS",title:"Terminis rellevants",component:"auto",fields:e=>[{name:"TERMINISRELLEVANTS",label:" "}]},{name:"TASCA",title:"Tasques",type:"child",listName:"TASCA",fields:["CODI","TITLE","ID_AGENT"],form:{component:(0,n.markRaw)(Na),maxWidth:"1200px"}},{name:"EVIDENCIA",title:"Evidències",type:"child",listName:"EVIDENCIA",fields:["CODI","TITLE","TIPUS","CARACTER"],form:{component:(0,n.markRaw)(Sa),maxWidth:"1200px"}},{name:"SERIEDOCUMENTAL",title:"Sèries documentals",type:"child",listName:"SERIEDOCUMENTAL",fields:["CODI","TITLE","CARACTER","ID_PRODUCTOR"],form:{component:(0,n.markRaw)(Ma),maxWidth:"1200px"}},{name:"PROCES_PROCES",title:"Dependències",type:"child",listName:"PROCES_PROCES",fields:["ID_RELACIONATAMB","ID_TIPUSRELACIO","OBS"],form:{component:(0,n.markRaw)(Pa),maxWidth:"870px"}},{name:"PROCES_INDICADOR",title:"Indicadors",type:"child",listName:"PROCES_INDICADOR",fields:["ID_TIPUSINDICADOR","TITLE"],form:{component:(0,n.markRaw)(Ua),maxWidth:"870px"}},{name:"PROCES_ATTACHMENT",title:"Arxius adjunts",component:"auto",fields:e=>[{name:"PROCES_ATTACHMENT"}]}]};var Fa=s(525),$a=s(732);function qa(){const e=(e,t=2)=>e.toString().padStart(t,"0"),t=new Date(Date.now());return`${e(t.getDate())}/${e(t.getMonth()+1)}/${e(t.getFullYear(),4)}`}async function Ka(e){$a?.pdfMake&&(Fa.vfs=$a.pdfMake.vfs);const t=[{name:"Proces",promise:Ne(`PROCES(${e})`,{$select:"CODI,TITLE,TIPUS,AMBIT,DESCRIPCIO,DESTINATARIS,REQUISITSAACREDITAR,MACROPROCES,NECESSITATDEPAGAMENT",$expand:"AGENT($select=CODIINOM,CONTACTE,MAILCONTACTE),FAMILIA($select=TITLE),FAMILIAOPAE($select=TITLE),TIPUSINICIACIO($select=TITLE),TIPUSFINALITZACIO($select=TITLE),TIPUSRECURSPROCES($select=TITLE),PROCES_DISPOSICIO($expand=DISPOSICIONORMATIVA($select=TITLE);$orderby=DISPOSICIONORMATIVA/TITLE),PROCES_PROCES($select=ID;$expand=PROCES1($select=CODIINOM;$expand=FAMILIA($select=TITLE)),TIPUSRELACIOPROCES($select=TITLE);$orderby=PROCES1/CODIINOM),SERIEDOCUMENTAL($select=CODIINOM,CARACTER,CLASSIFICACIO,CRITERINORMALITZACIO;$expand=AGENT($select=CODIINOM);$orderby=CODIINOM),TASCA($select=CODI,TITLE;$expand=AGENT($select=CODIINOM),TASCA_EVIDENCIASORTIDA($select=ID;$expand=EVIDENCIA($select=CODIINOM);$orderby=EVIDENCIA/CODIINOM);$orderby=CODI,TITLE),EVIDENCIA($select=CODI,TITLE,CARACTER,AUTENTIFICACIO;$expand=AGENT($select=CODIINOM),AGENT1($select=CODIINOM);$orderby=CODI,TITLE),PROCES_INDICADOR($select=TITLE,CONCEPTE,PERIODICITATMESURA;$orderby=TITLE)"})},{name:"tracts",promise:Ne("TRACTAMENTDADESPERSONALS",{$select:"TITLE,NIVELLDESEGURETAT",$expand:"AGENT1($select=CODIINOM),DISPOSICIONORMATIVA($select=TITLE)",$filter:`SERIEDOCUMENTAL/any(SERIEDOCUMENTAL:SERIEDOCUMENTAL/ID_PROCES eq ${e})`,$orderby:"TITLE"})},{name:"sists",promise:Ne("SISTEMAINFORMACIO",{$select:"CODIINOM,ABAST,DATAINICIPRODUCCIO",$expand:"CONTROLACCES($select=TITLE),CONTROLINTEGRITAT($select=TITLE),SISTEMAINFORMACIO_ENTORNTECNOLOGIC($select=ID;$expand=ENTORNTECNOLOGIC($select=TITLE);$orderby=ENTORNTECNOLOGIC/TITLE)",$filter:`EVIDENCIA/any(EVIDENCIA:EVIDENCIA/ID_PROCES eq ${e})`,$orderby:"CODIINOM"})},{name:"agents",promise:Ne("AGENT",{$select:"CODIINOM",$expand:"AGENT_FORMATPER($select=ID;$expand=AGENT1($select=CODIINOM);$orderby=AGENT1/CODIINOM)",$filter:`TASCA/any(TASCA:TASCA/ID_PROCES eq ${e})`,$orderby:"CODIINOM"})},{name:"dades",promise:Ne("DADAELEMENTAL",{$select:"TITLE",$expand:"OBJECTEDADA($select=TITLE),TIPUSDADA($select=TITLE)",$filter:`DADAELEMENTAL_EVIDENCIA/any(DADAELEMENTAL_EVIDENCIA:DADAELEMENTAL_EVIDENCIA/ID_PROCES eq ${e})`,$orderby:"OBJECTEDADA/TITLE,TIPUSDADA/TITLE,TITLE"})}],a=await Promise.all(t.map((e=>e.promise))),n=a[0],i=a[1].value,l=a[2].value,o=a[3].value,r=a[4].value,d={codi:n.CODI||"",tipus:n.TIPUS||"",ambit:n.AMBIT||"",descripcio:n.DESCRIPCIO||"",destinataris:n.DESTINATARIS||"",requisits:n.REQUISITSAACREDITAR||"",macroProces:n.MACROPROCES?"Sí":"No",familia:n.FAMILIA?n.FAMILIA.TITLE:"",familiaOpae:n.FAMILIAOPAE?n.FAMILIAOPAE.TITLE:"",nomResponsable:n.AGENT?n.AGENT.CODIINOM:"",contacte:n.AGENT?n.AGENT.CONTACTE:"",mail:n.AGENT?n.AGENT.MAILCONTACTE:"",iniciacio:n.TIPUSINICIACIO?n.TIPUSINICIACIO.TITLE:"",finalitzacio:n.TIPUSFINALITZACIO?n.TIPUSFINALITZACIO.TITLE:"",tipusRecurs:n.TIPUSRECURSPROCES?n.TIPUSRECURSPROCES.TITLE:"",pagament:n.NECESSITATDEPAGAMENT?"Sí":"No"},s=n.PROCES_DISPOSICIO||[],u=[];u.push([{text:"Disposició",style:"header"}]);for(let e=0;e<s.length;e++)u.push([s[e].DISPOSICIONORMATIVA.TITLE]);const c=n.PROCES_PROCES||[],m=[];m.push([{text:"Codi i nom procés relacionat",style:"header"},{text:"Família",style:"header"},{text:"Tipus de relació",style:"header"}]);for(let e=0;e<c.length;e++)m.push([c[e].PROCES1.CODIINOM,c[e].PROCES1.FAMILIA.TITLE||"",c[e].TIPUSRELACIOPROCES.TITLE||""]);const p=n.SERIEDOCUMENTAL||[],y=[];y.push([{text:"Codi i títol",style:"header"},{text:"Productor",style:"header"},{text:"Classificació",style:"header"},{text:"Nominalització",style:"header"},{text:"Caràcter",style:"header"}]);for(let e=0;e<p.length;e++)y.push([p[e].CODIINOM||"",p[e].AGENT&&p[e].AGENT.CODIINOM||"",p[e].CLASSIFICACIO||"",p[e].CRITERINORMALITZACIO||"",p[e].CARACTER||""]);const I=[];I.push([{text:"Nom",style:"header"},{text:"Responsable",style:"header"},{text:"Nivell",style:"header"},{text:"Ordre declaració DOGC",style:"header"}]);for(let e=0;e<i.length;e++)I.push([i[e].TITLE||"",i[e].AGENT1&&i[e].AGENT1.CODIINOM||"",i[e].NIVELLDESEGURETAT||"",i[e].DISPOSICIONORMATIVA&&i[e].DISPOSICIONORMATIVA.TITLE||""]);const f=n.EVIDENCIA||[],E=[];E.push([{text:"Codi",style:"header"},{text:"Nom",style:"header"},{text:"Productor",style:"header"},{text:"Destinatari",style:"header"},{text:"Caràcter",style:"header"},{text:"Autentificació",style:"header"}]);for(let e=0;e<f.length;e++)E.push([f[e].CODI||"",f[e].TITLE||"",f[e].AGENT.CODIINOM||"",f[e].AGENT1.CODIINOM||"",f[e].CARACTER||"",f[e].AUTENTIFICACIO||""]);const A=[],T=n.PROCES_INDICADOR||[];A.push([{text:"Nom",style:"header"},{text:"Descripció",style:"header"},{text:"Periodicitat",style:"header"}]);for(let e=0;e<T.length;e++)A.push([T[e].TITLE||"",T[e].CONCEPTE||"",T[e].PERIODICITATMESURA||""]);const C=[];C.push([{text:"Codi i nom",style:"header"},{text:"Abast",style:"header"},{text:"Entorn",style:"header"},{text:"D. inici producció",style:"header"},{text:"Controls d'integritat",style:"header"},{text:"Control d'accesos",style:"header"}]);for(let e=0;e<l.length;e++)C.push([l[e].CODIINOM||"",l[e].ABAST||"",l[e].ENTORNTECNOLOGIC||"",l[e].DATAINICIPRODUCCIO||"",l[e].CONTROLINTEGRITAT?.TITLE||"",l[e].CONTROLACCES?.TITLE||""]);const D=[],N=n.TASCA;D.push([{text:"ID",style:"header"},{text:"Nom i descripció",style:"header"},{text:"Agent responsable",style:"header"},{text:"Evidències de sortida",style:"header"}]);for(let e=0;e<N.length;e++)D.push([N[e].CODI||"",(N[e].TITLE||"")+"\n"+(N[e].DESCRIPCIO||""),N[e].AGENT&&N[e].AGENT.CODIINOM||"",N[e].TASCA_EVIDENCIASORTIDA.map((e=>e.EVIDENCIA.CODIINOM)).join(", ")||""]);const g=[];g.push([{text:"Rol",style:"header"},{text:"Persones(tipus) / Unitats administratives",style:"header"}]);for(let e=0;e<o.length;e++)g.push([o[e].CODIINOM||"",o[e].AGENT_FORMATPER.map((e=>e.AGENT1.CODIINOM)).join(", ")||""]);const v=[];v.push([{text:"Objecte",style:"header"},{text:"Tipus",style:"header"},{text:"Dada",style:"header"}]);for(let e=0;e<r.length;e++)v.push([r[e].OBJECTEDADA&&r[e].OBJECTEDADA.TITLE||"",r[e].TIPUSDADA&&r[e].TIPUSDADA.TITLE||"",r[e].TITLE||""]);await async function(){const e={pageOrientation:"landscape",pageMargins:[40,75,40,40],header:function(e,t){return{margin:[2,30,40,0],columns:[{text:"CEB. Catàleg de Processos",alignment:"left",width:"25%",margin:[40,0,0,0]},{text:"FITXA DEL PROCÉS",bold:!0,fontSize:14,alignment:"center",width:"*"},{table:{widths:["auto","auto"],body:[[{text:"Pàg. ",alignment:"left",fontSize:8},{text:e+" de "+t,alignment:"right",fontSize:8}],[{text:"Data ",alignment:"left",fontSize:8},{text:qa(),alignment:"right",fontSize:8}]]},layout:"noBorders",width:"63",alignment:"right"}]}},content:[],styles:{title:{bold:!0,fontSize:13,background:"#0078d7",color:"white",fillColor:"#0078d7"},header:{italics:!0,bold:!0}},defaultStyle:{fontSize:11}};e.content.push({layout:"noBorders",table:{widths:["100%"],border:"none",body:[[{text:"DADES DEL PROCÉS",style:"title",alignment:"center"}],[{text:".",fontSize:8,color:"white"}]]}}),e.content.push({table:{widths:["20%","80%"],body:[[{text:"Codi identificador del procés",italics:!0,bold:!0},d.codi],[{text:"Tipus de procés",italics:!0,bold:!0},d.tipus],[{text:"Macroprocés",italics:!0,bold:!0},d.macroProces],[{text:"Família OPAE del procés",italics:!0,bold:!0},d.familiaOpae],[{text:"Àmbit-",italics:!0,bold:!0},d.ambit],[{text:"Descripció del procés",italics:!0,bold:!0},d.descripcio],[{text:"Unitat responsable",italics:!0,bold:!0},d.nomResponsable],[{text:"Persona de contacte",italics:!0,bold:!0},d.contacte],[{text:"eMail de contacte",italics:!0,bold:!0},d.mail],[{text:"Tipus d'iniciació",italics:!0,bold:!0},d.iniciacio],[{text:"Tipus de finalització/silenci",italics:!0,bold:!0},d.finalitzacio],[{text:"Tipus de recurs",italics:!0,bold:!0},d.tipusRecurs],[{text:"Necessitat de pagament",italics:!0,bold:!0},d.pagament],[{text:"Destinataris del procés",italics:!0,bold:!0},d.destinataris],[{text:"Requisits a acreditar",italics:!0,bold:!0},d.requisits]]}}),e.content.push({text:".",fontSize:24,color:"white"}),e.content.push({layout:"noBorders",table:{widths:["100%"],body:[[{text:"DISPOSICIONS QUE REGULEN EL PROCÉS",style:"title"}],[{text:".",fontSize:6,color:"white"}],[{style:"taula",headerRows:1,table:{widths:["100%"],body:u}}]]}}),e.content.push({text:".",fontSize:24,color:"white"}),e.content.push({layout:"noBorders",table:{widths:["100%"],body:[[{text:"AGENTS QUE PARTICIPEN EN EL PROCÉS",style:"title"}],[{text:".",fontSize:6,color:"white"}],[{style:"taula",headerRows:1,table:{widths:["40%","60%"],body:g}}]]}}),e.content.push({text:".",fontSize:24,color:"white"}),e.content.push({layout:"noBorders",table:{widths:["100%"],body:[[{text:"SISTEMES D'INFORMACIÓ QUE DONEN SUPORT AL PROCÉS",style:"title"}],[{text:".",fontSize:6,color:"white"}],[{style:"taula",headerRows:1,table:{widths:["37%","12%","12%","12%","14%","13%"],body:C}}]]}}),e.content.push({text:".",fontSize:24,color:"white"}),e.content.push({layout:"noBorders",table:{widths:["100%"],body:[[{text:"TRACTAMENT DE DADES PERSONALS APLICABLES AL PROCÉS",style:"title"}],[{text:".",fontSize:6,color:"white"}],[{style:"taula",headerRows:1,table:{widths:["32%","19%","4%","45%"],body:I}}]]}}),e.content.push({text:".",fontSize:24,color:"white"}),e.content.push({layout:"noBorders",table:{widths:["100%"],body:[[{text:"INDICADOR DEL PROCÉS",style:"title"}],[{text:".",fontSize:6,color:"white"}],[{style:"taula",headerRows:1,table:{widths:["30%","55%","15%"],body:A}}]]}}),e.content.push({text:".",fontSize:24,color:"white"}),e.content.push({layout:"noBorders",table:{widths:["100%"],body:[[{text:"PROCESSOS RELACIONATS",style:"title"}],[{text:".",fontSize:6,color:"white"}],[{style:"taula",headerRows:1,table:{widths:["45%","40%","15%"],body:m}}]]}}),e.content.push({text:".",fontSize:24,color:"white"}),e.content.push({layout:"noBorders",table:{widths:["100%"],body:[[{text:"TASQUES DEL PROCÉS",style:"title"}],[{text:".",fontSize:4,color:"white"}],[{style:"taula",headerRows:1,table:{headerRows:1,widths:["4%","40%","28%","28%"],body:D}}]]}}),e.content.push({text:".",fontSize:24,color:"white"}),e.content.push({layout:"noBorders",table:{widths:["100%"],body:[[{text:"DOCUMENTS DEL PROCÉS",style:"title"}],[{text:".",fontSize:6,color:"white"}],[{style:"taula",headerRows:1,table:{widths:["5%","25%","22%","23%","10%","15%"],body:E}}]]}}),e.content.push({text:".",fontSize:24,color:"white"}),e.content.push({layout:"noBorders",table:{widths:["100%"],body:[[{text:"SÈRIES DOCUMENTALS DEL PROCÉS",style:"title"}],[{text:".",fontSize:6,color:"white"}],[{style:"taula",headerRows:1,table:{widths:["33%","30%","12%","17%","8%"],body:y}}]]}}),e.content.push({text:".",fontSize:24,color:"white"}),e.content.push({layout:"noBorders",table:{widths:["100%"],body:[[{text:".",fontSize:24,color:"white"}],[{text:"DADES DE LA SÈRIE DOCUMENTAL",style:"title"}],[{text:".",fontSize:6,color:"white"}],[{style:"taula",headerRows:1,table:{widths:["25%","50%","25%"],body:v}}]]}}),await new Promise((t=>{Fa.createPdf(e).download("fitxa.pdf")}))}()}async function Ga(e){$a?.pdfMake&&(Fa.vfs=$a.pdfMake.vfs);const t=await Ne(`PROCES(${e})`,{$select:"CODI,TITLE,TIPUS,DESCRIPCIO",$expand:"FAMILIA($select=TITLE),TASCA($select=CODI,TITLE,DESCRIPCIO;$expand=AGENT($select=CODIINOM),TASCA_EVIDENCIAENTRADA($select=ID;$expand=EVIDENCIA($select=CODIINOM;$orderby=CODIINOM)),TASCA_EVIDENCIASORTIDA($select=ID;$expand=EVIDENCIA($select=CODIINOM;$orderby=CODIINOM));$orderby=CODI)"}),a={pageOrientation:"landscape",pageMargins:[40,75,40,40],header:function(e,t){return{margin:[2,30,40,0],columns:[{text:"CEB. Catàleg de Processos",alignment:"left",width:"25%",margin:[40,0,0,0]},{text:"GUIA DE PROCEDIMENT",bold:!0,fontSize:14,alignment:"center",width:"*"},{table:{widths:["auto","auto"],body:[[{text:"Pàg. ",alignment:"left",fontSize:8},{text:e+" de "+t,alignment:"right",fontSize:8}],[{text:"Data ",alignment:"left",fontSize:8},{text:qa(),alignment:"right",fontSize:8}]]},layout:"noBorders",width:"63",alignment:"right"}]}},content:[],styles:{title:{bold:!0,fontSize:14,background:"#0078d7",color:"white",fillColor:"#0078d7"},subtitle:{bold:!0,fontSize:12,background:"#0078d7",color:"white",fillColor:"#0078d7"},sepBlue:{bold:!0,fontSize:2,background:"#0078d7",color:"white",fillColor:"#0078d7"},header:{italics:!0,bold:!0},link:{italics:!0,color:"#54BAE6"}},defaultStyle:{fontSize:10}};a.content.push({layout:"noBorders",table:{widths:["100%"],border:"none",body:[[{text:"Procés: "+t.CODI+" "+t.TITLE,style:"title",alignment:"center"}],[{text:".",fontSize:8,color:"white"}]]}}),a.content.push({table:{widths:["20%","80%"],body:[[{text:"Família del procés",italics:!0,bold:!0},{text:t.FAMILIA.TITLE}],[{text:"Descripció",italics:!0,bold:!0},{text:t.DESCRIPCIO}]]}}),a.content.push({layout:"noBorders",table:{widths:["7%","43%","25%","25%"],body:[[{text:".",fontSize:24,color:"white",colSpan:4},"","",""],[{text:"TASQUES DEL PROCÉS",style:"subtitle",colSpan:4},{text:"",style:"subtitle"},{text:"",style:"subtitle"},{text:"",style:"subtitle"}],[{text:"Seqüència",style:"header"},{text:"Agent / Descripció",style:"header"},{text:"Entrades",style:"header"},{text:"Sortides",style:"header"}],[{text:".",fontSize:4,color:"white",colSpan:4},"","",""]]}});const n=t.TASCA;for(let e=0;e<n.length;e++)a.content[2].table.body.push([{text:n[e].CODI,bold:!0},{text:[{text:n[e].AGENT.CODIINOM+": ",bold:!0},(n[e].DESCRIPCIO||"").replace("<br/>","").replace("<br>","")+"\n"]},(n[e].TASCA_EVIDENCIAENTRADA||[]).map((e=>e.EVIDENCIA.CODIINOM)).join("\n"),(n[e].TASCA_EVIDENCIASORTIDA||[]).map((e=>e.EVIDENCIA.CODIINOM)).join("\n")]);await new Promise((e=>{Fa.createPdf(a).download("guia.pdf")}))}function ja(e,t){let a=e.indexOf(t);return-1===a&&(a=e.length,e.push(t)),a}function za(e){const t=e.doc.createElement(e.tagName);if(e.attributes)for(const a in e.attributes)t.setAttribute(a,e.attributes[a]);const a=za;e.childs&&e.childs.forEach((function(n){n instanceof Node?t.appendChild(n):!0!==n.exclude&&a({doc:e.doc,parent:t,tagName:n.tagName,attributes:n.attributes,childs:n.childs})})),e.parent.appendChild(t)}function Wa(e){const t=e.doc.createElementNS("http://www.yworks.com/xml/graphml","y:"+e.tagName);if(e.attributes)for(const a in e.attributes)t.setAttribute(a,e.attributes[a]);const a=Wa;return e.childs&&e.childs.forEach((function(n){n instanceof Node?t.appendChild(n):!0!==n.exclude&&a({doc:e.doc,parent:t,tagName:n.tagName,attributes:n.attributes,childs:n.childs})})),e.parent&&e.parent.appendChild(t),t}function Ya(e,t,a,n,i){Wa({doc:e,parent:a,tagName:"GenericNode",attributes:{configuration:"com.yworks.bpmn.Event.withShadow"},childs:[{tagName:"Geometry",attributes:{width:"30.0",height:"30.0",x:n.col*(t.width+t.marginWidth)+"",y:(n.row+1)*(t.height+t.marginHeight)+""}},{tagName:"Fill",attributes:{color:"#FFFFFFE6",color2:"#D4D4D4CC",transparent:"false"}},{tagName:"BorderStyle",attributes:{color:i.borderColor,type:"line",width:"1.0"}},{tagName:"NodeLabel",attributes:{alignment:"center",autoSizePolicy:"content",fontFamily:"Dialog",fontSize:"12",fontStyle:"plain",hasBackgroundColor:"false",hasLineColor:"false",horizontalTextPosition:"center",iconTextGap:"4",modelName:"custom",textColor:"#000000",verticalTextPosition:"bottom",visible:"true",width:t.width-20+"",height:t.height-20+"",x:"10",y:"10"},childs:[e.createTextNode(n.title),{tagName:"LabelModel",childs:[{tagName:"SmartNodeLabelModel",attributes:{distance:"4.0"}}]},{tagName:"ModelParameter",childs:[{tagName:"SmartNodeLabelModelParameter",attributes:{labelRatioX:"0.0",labelRatioY:"-0.5",nodeRatioX:"0.0",nodeRatioY:"0.5",offsetX:"0.0",offsetY:"4.0",upX:"0.0",upY:"-1.0"}}]}]},{tagName:"StyleProperties",childs:[{tagName:"Property",attributes:{class:"com.yworks.yfiles.bpmn.view.EventCharEnum",name:"com.yworks.bpmn.characteristic",value:i.characteristic}},{tagName:"Property",attributes:{class:"java.awt.Color",name:"com.yworks.bpmn.icon.line.color",value:"#000000"}},{tagName:"Property",attributes:{class:"java.awt.Color",name:"com.yworks.bpmn.icon.fill2",value:"#d4d4d4cc"}},{tagName:"Property",attributes:{class:"java.awt.Color",name:"com.yworks.bpmn.icon.fill",value:"#ffffffe6"}},{tagName:"Property",attributes:{class:"com.yworks.yfiles.bpmn.view.BPMNTypeEnum",name:"com.yworks.bpmn.type",value:i.type}}]}]})}function Xa(e,t,a,n,i){Wa({doc:e,parent:a,tagName:"GenericNode",attributes:{configuration:"com.yworks.bpmn.Activity.withShadow"},childs:[{tagName:"Geometry",attributes:{width:t.width+"",height:t.height+"",x:n.col*(t.width+t.marginWidth)+"",y:(n.row+1)*(t.height+t.marginHeight)+""}},{tagName:"Fill",attributes:{color:"#FFFFFFE6",color2:"#D4D4D4CC",transparent:"false"}},{tagName:"BorderStyle",attributes:{color:"#123EA2",type:"line",width:"1.0"}},{tagName:"NodeLabel",attributes:{alignment:"center",autoSizePolicy:"content",fontFamily:"Dialog",fontSize:"12",fontStyle:"plain",hasBackgroundColor:"false",hasLineColor:"false",horizontalTextPosition:"center",iconTextGap:"4",modelName:"custom",textColor:"#000000",verticalTextPosition:"bottom",visible:"true",width:t.width-20+"",height:t.height-20+"",x:"10",y:"10"},childs:[e.createTextNode(n.title),{tagName:"LabelModel",childs:[{tagName:"SmartNodeLabelModel",attributes:{distance:"4.0"}}]},{tagName:"ModelParameter",childs:[{tagName:"SmartNodeLabelModelParameter",attributes:{labelRatioX:"0.0",labelRatioY:"0.0",nodeRatioX:"0.0",nodeRatioY:"0.0",offsetX:"0.0",offsetY:"0.0",upX:"0.0",upY:"-1.0"}}]}]},{tagName:"StyleProperties",childs:[{tagName:"Property",attributes:{class:"java.awt.Color",name:"com.yworks.bpmn.icon.line.color",value:"#000000"}},{tagName:"Property",attributes:{class:"com.yworks.yfiles.bpmn.view.TaskTypeEnum",name:"com.yworks.bpmn.taskType",value:"TASK_TYPE_ABSTRACT"}},{tagName:"Property",attributes:{class:"java.awt.Color",name:"com.yworks.bpmn.icon.fill2",value:"#d4d4d4cc"}},{tagName:"Property",attributes:{class:"java.awt.Color",name:"com.yworks.bpmn.icon.fill",value:"#ffffffe6"}},{tagName:"Property",attributes:{class:"com.yworks.yfiles.bpmn.view.BPMNTypeEnum",name:"com.yworks.bpmn.type",value:"ACTIVITY_TYPE"}},{tagName:"Property",attributes:{class:"com.yworks.yfiles.bpmn.view.ActivityTypeEnum",name:"com.yworks.bpmn.activityType",value:i}}]}]})}function Ha(e,t,a,n,i){Wa({doc:e,parent:a,tagName:"GenericNode",attributes:{configuration:"com.yworks.bpmn.Gateway.withShadow"},childs:[{tagName:"Geometry",attributes:{width:"45.0",height:"45.0",x:n.col*(t.width+t.marginWidth)+"",y:(n.row+1)*(t.height+t.marginHeight)+""}},{tagName:"Fill",attributes:{color:"#FFFFFFE6",color2:"#D4D4D4CC",transparent:"false"}},{tagName:"BorderStyle",attributes:{color:"#E38B00",type:"line",width:"1.0"}},{tagName:"NodeLabel",attributes:{alignment:"center",autoSizePolicy:"content",fontFamily:"Dialog",fontSize:"12",fontStyle:"plain",hasBackgroundColor:"false",hasLineColor:"false",horizontalTextPosition:"center",iconTextGap:"4",modelName:"custom",textColor:"#000000",verticalTextPosition:"bottom",visible:"true",width:t.width-20+"",height:t.height-20+"",x:"10",y:"10"},childs:[e.createTextNode(n.title),{tagName:"LabelModel",childs:[{tagName:"SmartNodeLabelModel",attributes:{distance:"4.0"}}]},{tagName:"ModelParameter",childs:[{tagName:"SmartNodeLabelModelParameter",attributes:{labelRatioX:"-0.5",labelRatioY:"0.5",nodeRatioX:"0.5",nodeRatioY:"-0.5",offsetX:"4.0",offsetY:"-4.0",upX:"0.0",upY:"-1.0"}}]}]},{tagName:"StyleProperties",childs:[{tagName:"Property",attributes:{class:"java.awt.Color",name:"com.yworks.bpmn.icon.line.color",value:"#000000"}},{tagName:"Property",attributes:{class:"java.awt.Color",name:"com.yworks.bpmn.icon.fill2",value:"#d4d4d4cc"}},{tagName:"Property",attributes:{class:"java.awt.Color",name:"com.yworks.bpmn.icon.fill",value:"#ffffffe6"}},{tagName:"Property",attributes:{class:"com.yworks.yfiles.bpmn.view.BPMNTypeEnum",name:"com.yworks.bpmn.type",value:i}}]}]})}function Za(e,t,a,n,i){Wa({doc:e,parent:a,tagName:"GenericNode",attributes:{configuration:"com.yworks.bpmn.Artifact.withShadow"},childs:[{tagName:"Geometry",attributes:{width:"35.0",height:"55.0",x:n.col*(t.width+t.marginWidth)+"",y:(n.row+1)*(t.height+t.marginHeight)+""}},{tagName:"Fill",attributes:{color:"#FFFFFFE6",transparent:"false"}},{tagName:"BorderStyle",attributes:{color:"#000000",type:"line",width:"1.0"}},{tagName:"NodeLabel",attributes:{alignment:"center",autoSizePolicy:"content",fontFamily:"Dialog",fontSize:"12",fontStyle:"plain",hasBackgroundColor:"false",hasLineColor:"false",horizontalTextPosition:"center",iconTextGap:"4",modelName:"custom",textColor:"#000000",verticalTextPosition:"bottom",visible:"true",width:t.width-20+"",height:t.height-20+"",x:"10",y:"10"},childs:[e.createTextNode(n.title),{tagName:"LabelModel",childs:[{tagName:"SmartNodeLabelModel",attributes:{distance:"4.0"}}]},{tagName:"ModelParameter",childs:[{tagName:"SmartNodeLabelModelParameter",attributes:{labelRatioX:"0.0",labelRatioY:"0.5",nodeRatioX:"0.0",nodeRatioY:"-0.5",offsetX:"0.0",offsetY:"-4.0",upX:"0.0",upY:"-1.0"}}]}]},{tagName:"StyleProperties",childs:[{tagName:"Property",attributes:{class:"java.awt.Color",name:"com.yworks.bpmn.icon.line.color",value:"#000000"}},{tagName:"Property",attributes:{class:"java.awt.Color",name:"com.yworks.bpmn.icon.fill2",value:"#d4d4d4cc"}},{tagName:"Property",attributes:{class:"java.awt.Color",name:"com.yworks.bpmn.icon.fill",value:"#ffffffe6"}},{tagName:"Property",attributes:{class:"com.yworks.yfiles.bpmn.view.BPMNTypeEnum",name:"com.yworks.bpmn.type",value:"ARTIFACT_TYPE_DATA_OBJECT"}},{tagName:"Property",attributes:{class:"com.yworks.yfiles.bpmn.view.DataObjectTypeEnum",name:"com.yworks.bpmn.dataObjectType",value:i}}]}]})}function Ja(e,t,a,n){const i=e.createElement("data"),l=e.createCDATASection(n);i.setAttribute("key",a),i.setAttribute("xml:space","preserve"),i.appendChild(l),t.appendChild(i)}async function Qa(e){const t=(await Ne("TASCA",{$select:"ID,TITLE,CODI,NOMCURT,DESCRIPCIO,LINKTITLE,ID_TIPUSTASCA",$filter:`ID_PROCES eq ${e}`,$expand:"PROCES($select=CODIINOM),TIPUSTASCA($select=TITLE),TIPUSAGENT($select=TITLE),AGENT($select=CODIINOM),FORMA_BPMN($select=TITLE),TASCA_PRECEDENT($select=ID_TASCA_PRECEDENT)",$orderby:"CODI"})).value,a=[];for(let e=0;e<t.length;e++){const n=t[e].TASCA_PRECEDENT.map((e=>e.ID_TASCA_PRECEDENT));a.push({code:t[e].ID,title:t[e].NOMCURT||"",agent:t[e].AGENT.CODIINOM||"",NOMTASCA:t[e].TITLE||"",CODI:t[e].CODI||"",TIPUSTASCA:t[e].TIPUSTASCA?.TITLE,DESCRIPCIO:t[e].DESCRIPCIO||"",parent:n,type:t[e].FORMA_BPMN?.TITLE}),n.length>0&&t[e].LINKTITLE&&""!==t[e].LINKTITLE&&(a[a.length-1].labelparent=t[e].LINKTITLE)}!function(e,t){if("function"==typeof window.navigator.msSaveBlob)window.navigator.msSaveBlob(new Blob([t]),e);else{const a=document.createElement("a");if(a.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),a.setAttribute("download",e),document.createEvent){const e=document.createEvent("MouseEvents");e.initEvent("click",!0,!0),a.dispatchEvent(e)}else a.click()}}("bpmn.graphml",function(e,t){const a=function(e){const t=[];let a=0;const n=e.map((function(e){return{code:e.code,row:a++,col:ja(t,e.agent),type:e.type,title:e.title,DESCRIPCIO:e.DESCRIPCIO,CODI:e.CODI,NOMTASCA:e.NOMTASCA,TIPUSTASCA:e.TIPUSTASCA,labelparent:e.labelparent||null}})),i=function(e){for(let t=0;t<n.length;t++)if(n[t].code===e)return n[t]},l=e.reduce((function(e,t){const a=i(t.code);return e.concat(t.parent.map((function(e){return{from:i(e),to:a,text:a.labelparent}})))}),[]);return{agents:t,nodes:n,realationships:l}}(e),n=function(e,t){const a=function(){const e=document.implementation.createDocument("http://graphml.graphdrawing.org/xmlns","graphml",null);e.documentElement.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns","http://graphml.graphdrawing.org/xmlns"),e.documentElement.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:java","http://www.yworks.com/xml/yfiles-common/1.0/java"),e.documentElement.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:sys","http://www.yworks.com/xml/yfiles-common/markup/primitives/2.0"),e.documentElement.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:x","http://www.yworks.com/xml/yfiles-common/markup/2.0"),e.documentElement.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),e.documentElement.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:y","http://www.yworks.com/xml/graphml"),e.documentElement.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:yed","http://www.yworks.com/xml/yed/3"),e.documentElement.setAttributeNS("http://graphml.graphdrawing.org/xmlns","xsi:schemaLocation","http://graphml.graphdrawing.org/xmlns http://www.yworks.com/xml/schema/graphml/1.1/ygraphml.xsd");const t=e.createElement("key");t.setAttribute("for","node"),t.setAttribute("id","d1"),t.setAttribute("yfiles.type","nodegraphics"),e.documentElement.appendChild(t);const a=e.createElement("key");a.setAttribute("for","edge"),a.setAttribute("id","d2"),a.setAttribute("yfiles.type","edgegraphics"),e.documentElement.appendChild(a);const n=e.createElement("key");n.setAttribute("for","port"),n.setAttribute("id","d3"),n.setAttribute("yfiles.type","portuserdata"),e.documentElement.appendChild(n);const i=e.createElement("default");i.setAttribute("xml:space","preserve");const l=e.createElement("key");l.setAttribute("attr.name","CODI"),l.setAttribute("attr.type","string"),l.setAttribute("for","node"),l.setAttribute("id","d4"),l.appendChild(i),e.documentElement.appendChild(l);const o=e.createElement("default");o.setAttribute("xml:space","preserve");const r=e.createElement("key");r.setAttribute("attr.name","NOMTASCA"),r.setAttribute("attr.type","string"),r.setAttribute("for","node"),r.setAttribute("id","d5"),r.appendChild(o),e.documentElement.appendChild(r);const d=e.createElement("default");d.setAttribute("xml:space","preserve");const s=e.createElement("key");s.setAttribute("attr.name","TIPUSTASCA"),s.setAttribute("attr.type","string"),s.setAttribute("for","node"),s.setAttribute("id","d6"),s.appendChild(d),e.documentElement.appendChild(s);const u=e.createElement("key");u.setAttribute("attr.name","url"),u.setAttribute("attr.type","string"),u.setAttribute("for","node"),u.setAttribute("id","d7"),e.documentElement.appendChild(u);const c=e.createElement("key");return c.setAttribute("attr.name","description"),c.setAttribute("attr.type","string"),c.setAttribute("for","node"),c.setAttribute("id","d8"),e.documentElement.appendChild(c),za({doc:e,parent:e.documentElement,tagName:"graph",attributes:{id:"G",edgedefault:"directed"},childs:[{tagName:"node",attributes:{id:"n0","yfiles.foldertype":"group"},childs:[{tagName:"data",attributes:{key:"d1"}},{tagName:"graph",attributes:{id:"n0:",edgedefault:"directed"}}]}]}),e}(),n=e.nodes.map((function(e){return e.row})).reduce((function(e,t){return Math.max(e,t)})),i={width:t.width||125,height:t.height||40,marginWidth:t.marginWidth||25,marginHeight:t.marginHeight||15};return function(e,t,a,n){Wa({doc:e,parent:e.querySelector('node[id="n0"] > data'),tagName:"TableNode",attributes:{configuration:"com.yworks.bpmn.Pool"},childs:[{tagName:"Geometry",attributes:{height:n.tableHeight+"",width:n.colWith*a.length+"",x:"0",y:"0"}},{tagName:"Fill",attributes:{color:"#FFF2BC",color2:"#D4D4D4CC",transparent:"false"}},{tagName:"BorderStyle",attributes:{color:"#000000",type:"line",width:"1.0"}},{tagName:"NodeLabel",attributes:{alignment:"center",autoSizePolicy:"content",fontFamily:"Dialog",fontSize:"15",fontStyle:"plain",hasBackgroundColor:"false",hasLineColor:"false",iconTextGap:"4",modelName:"internal",modelPosition:"t",textColor:"#000000",horizontalTextPosition:"center",verticalTextPosition:"bottom",visible:"true",width:n.colWith*a.length-20+"",height:"22.37646484375",x:"10",y:"4"},childs:[e.createTextNode(t)]}].concat(a.map((function(t,a){return Wa({doc:e,tagName:"NodeLabel",attributes:{alignment:"center",autoSizePolicy:"content",fontFamily:"Dialog",fontSize:"12",fontStyle:"plain",hasBackgroundColor:"false",hasLineColor:"false",height:"18.701171875",horizontalTextPosition:"center",iconTextGap:"4",modelName:"custom",textColor:"#000000",verticalTextPosition:"bottom",visible:"true",width:n.colWith-20,x:"10",y:"33.0"},childs:[e.createTextNode(t),{tagName:"LabelModel",childs:[{tagName:"ColumnNodeLabelModel",attributes:{offset:"3.0"}}]},{tagName:"ModelParameter",childs:[{tagName:"ColumnNodeLabelModelParameter",attributes:{id:"column_"+a,inside:"true",verticalPosition:"0.0"}}]}]})}))).concat([{tagName:"StyleProperties",childs:[{tagName:"Property",attributes:{name:"y.view.tabular.TableNodePainter.ALTERNATE_ROW_STYLE"},childs:[{tagName:"SimpleStyle",attributes:{fillColor:"#474A4340",lineColor:"#000000",lineType:"line",lineWidth:"1.0"}}]},{tagName:"Property",attributes:{class:"java.awt.Color",name:"com.yworks.bpmn.icon.line.color",value:"#000000"}},{tagName:"Property",attributes:{name:"y.view.tabular.TableNodePainter.ALTERNATE_COLUMN_SELECTION_STYLE"},childs:[{tagName:"SimpleStyle",attributes:{fillColor:"#474A4380",lineColor:"#000000",lineType:"line",lineWidth:"3.0"}}]},{tagName:"Property",attributes:{name:"y.view.tabular.TableNodePainter.ALTERNATE_ROW_SELECTION_STYLE"},childs:[{tagName:"SimpleStyle",attributes:{fillColor:"#474A4380",lineColor:"#000000",lineType:"line",lineWidth:"3.0"}}]},{tagName:"Property",attributes:{class:"java.awt.Color",name:"POOL_LANE_COLOR_ALTERNATING",value:"#ffffff"}},{tagName:"Property",attributes:{class:"java.awt.Color",name:"POOL_LANE_COLOR_MAIN",value:"#ffffff"}},{tagName:"Property",attributes:{class:"java.lang.String",name:"POOL_LANE_STYLE",value:"LANE_STYLE_COLUMNS"}},{tagName:"Property",attributes:{class:"java.awt.Color",name:"com.yworks.bpmn.icon.fill2",value:"#d4d4d4cc"}},{tagName:"Property",attributes:{class:"java.awt.Color",name:"com.yworks.bpmn.icon.fill",value:"#ffffffe6"}},{tagName:"Property",attributes:{class:"com.yworks.yfiles.bpmn.view.BPMNTypeEnum",name:"com.yworks.bpmn.type",value:"POOL_TYPE_COLUMN"}},{tagName:"Property",attributes:{name:"y.view.tabular.TableNodePainter.ALTERNATE_COLUMN_STYLE"},childs:[{tagName:"SimpleStyle",attributes:{fillColor:"#474A4340",lineColor:"#000000",lineType:"line",lineWidth:"1.0"}}]}]},{tagName:"State",attributes:{autoResize:"true",closed:"false",closedHeight:"80.0"}},{tagName:"Insets",attributes:{bottom:"5",bottomF:"5.0",left:"25",leftF:"25.0",right:"25",rightF:"25.0",top:"5",topF:"5.0"}},{tagName:"BorderInsets",attributes:{bottom:"5",bottomF:"5.0",left:"25",leftF:"25.0",right:"25",rightF:"25.0",top:"5",topF:"5.0"}},{tagName:"Table",attributes:{autoResizeTable:"true",defaultColumnWidth:"120.0",defaultMinimumColumnWidth:"80.0",defaultMinimumRowHeight:"50.0",defaultRowHeight:"80.0"},childs:[{tagName:"DefaultColumnInsets",attributes:{bottom:"0.0",left:"0.0",right:"0.0",top:"24.0"}},{tagName:"DefaultRowInsets",attributes:{bottom:"0.0",left:"0.0",right:"0.0",top:"0.0"}},{tagName:"Insets",attributes:{bottom:"0.0",left:"0.0",right:"0.0",top:"30.0"}},{tagName:"Columns",childs:a.map((function(t,a){return Wa({doc:e,tagName:"Column",attributes:{id:"column_"+a,minimumWidth:"80.0",width:n.colWith+""},childs:[{tagName:"Insets",attributes:{bottom:"0.0",left:"0.0",right:"0.0",top:"24.0"}}]})}))},{tagName:"Rows",childs:[{tagName:"Row",attributes:{id:"row_0",height:n.tableHeight+"",minimumHeight:"50.0"},childs:[{tagName:"Insets",attributes:{bottom:"0.0",left:"0.0",right:"0.0",top:"0.0"}}]}]}]}])})}(a,t.title||"",e.agents,{colWith:i.width+i.marginWidth,tableHeight:(i.height+i.marginHeight)*(n+1)}),function(e,t,a){t.forEach((function(t){const n=e.createElement("node");n.setAttribute("id","n0::n"+t.code),e.querySelector('graph[id="n0:"]').appendChild(n),t.CODI&&Ja(e,n,"d4",t.CODI),t.NOMTASCA&&Ja(e,n,"d5",t.NOMTASCA),t.TIPUSTASCA&&Ja(e,n,"d6",t.TIPUSTASCA),t.DESCRIPCIO&&Ja(e,n,"d8",t.DESCRIPCIO);const i=e.createElement("data");switch(i.setAttribute("key","d1"),n.appendChild(i),t.type){case"Inici de procés":Ya(e,a,i,t,{type:"EVENT_TYPE_PLAIN",characteristic:"EVENT_CHARACTERISTIC_START",borderColor:"#27AE27"});break;case"Esdeveniment":Ya(e,a,i,t,{type:"EVENT_TYPE_PLAIN",characteristic:"EVENT_CHARACTERISTIC_INTERMEDIATE_CATCHING",borderColor:"#DCBA00"});break;case"Termini":Ya(e,a,i,t,{type:"EVENT_TYPE_TIMER",characteristic:"EVENT_CHARACTERISTIC_INTERMEDIATE_CATCHING",borderColor:"#DCBA00"});break;case"Missatge":Ya(e,a,i,t,{type:"EVENT_TYPE_MESSAGE",characteristic:"EVENT_CHARACTERISTIC_INTERMEDIATE_CATCHING",borderColor:"#DCBA00"});break;case"Interrupció del procés":Ya(e,a,i,t,{type:"EVENT_TYPE_TERMINATE",characteristic:"EVENT_CHARACTERISTIC_END",borderColor:"#B11F1F"});break;case"Fi de procés":Ya(e,a,i,t,{type:"EVENT_TYPE_PLAIN",characteristic:"EVENT_CHARACTERISTIC_END",borderColor:"#B11F1F"});break;case"Tasca":Xa(e,a,i,t,"ACTIVITY_TYPE_TASK");break;case"Subprocés":Xa(e,a,i,t,"ACTIVITY_TYPE_TRANSACTION");break;case"Gateway":Ha(e,a,i,t,"GATEWAY_TYPE_PLAIN");break;case"Gateway exclusiu":Ha(e,a,i,t,"GATEWAY_TYPE_DATA_BASED_EXCLUSIVE");break;case"Gateway inclusiu":Ha(e,a,i,t,"GATEWAY_TYPE_INCLUSIVE");break;case"Gateway paral·lel":Ha(e,a,i,t,"GATEWAY_TYPE_PARALLEL");break;case"Evidència d'entrada":Za(e,a,i,t,"DATA_OBJECT_TYPE_INPUT");break;case"Evidència de sortida":Za(e,a,i,t,"DATA_OBJECT_TYPE_OUTPUT")}}))}(a,e.nodes,i),function(e,t){t.forEach((function(t,a){const n=e.createElement("edge");n.setAttribute("id","e"+a),n.setAttribute("source","n0::n"+t.from.code),n.setAttribute("target","n0::n"+t.to.code),e.querySelector('graph[id="G"]').appendChild(n);const i=e.createElement("data");i.setAttribute("key","d2"),n.appendChild(i),Wa({doc:e,parent:i,tagName:"PolyLineEdge",childs:[{parent:i,tagName:"Path",attributes:{sx:"0.0",sy:"0.0",tx:"0.0",ty:"0.0"}},{parent:i,tagName:"LineStyle",attributes:{color:"#000000",type:"line",width:"1.0"}},{parent:i,tagName:"Arrows",attributes:{source:"none",target:"standard"}},{exclude:"string"!=typeof t.text,parent:i,tagName:"EdgeLabel",attributes:{alignment:"center",configuration:"AutoFlippingLabel",distance:"2.0",fontFamily:"Dialog",fontSize:"12",fontStyle:"plain",hasBackgroundColor:"false",hasLineColor:"false",iconTextGap:"4",modelName:"custom",textColor:"#000000",horizontalTextPosition:"center",verticalTextPosition:"bottom",visible:"true",width:"16.0",height:"20.0",x:"47",y:"51",preferredPlacement:"anywhere",ratio:.5},childs:[e.createTextNode(t.text),{tagName:"LabelModel",childs:[{tagName:"SmartEdgeLabelModel",attributes:{autoRotationEnabled:"false",defaultAngle:"0.0",defaultDistance:"10.0"}}]},{tagName:"ModelParameter",childs:[{tagName:"SmartEdgeLabelModelParameter",attributes:{angle:"0.0",distance:"30.0",distanceToCenter:"true",position:t.from.col>t.to.col?"right":"left",ratio:"0.5",segment:"0"}}]},{tagName:"PreferredPlacementDescriptor",attributes:{angle:"0.0",angleOffsetOnRightSide:"0",angleReference:"absolute",angleRotationOnRightSide:"co",distance:"-1.0",frozen:"true",placement:"anywhere",side:"anywhere",sideReference:"relative_to_edge_flow"}}]},{parent:i,tagName:"BendStyle",attributes:{smoothed:"false"}}]})}))}(a,e.realationships),a}(a,{title:t,width:150,height:40,marginWidth:25,marginHeight:25});return(new XMLSerializer).serializeToString(n).replace(/\s*xmlns=""/g,"")}(a,t[0].PROCES.CODIINOM))}const en={name:"PROCES",type:"listSplitted",label:"Processos",fields:pa,filter:[{name:"CODI",label:"Codi procés conté",operation:"contains"},{name:"TITLE",label:"Nom procés conté",operation:"contains"},{name:"ID_FAMILIA",operation:"in"},{name:"AMBIT",operation:"eq"},{name:"ID_TIPUSINICIACIO",operation:"in"},{name:"ID_TIPUSFINALITZACIO",operation:"in"},{name:"ID_RESPONSABLE",operation:"in"},{name:"PROCES_DISPOSICIO",operation:"in"},{name:"SERIEDOCUMENTAL",operation:"eq",title:"Series Documentals",type:"child",entity:{entityName:"SERIEDOCUMENTAL",primaryKey:"ID",targetKey:"CODIINOM"}},{name:"PROCES_PROCES",operation:"eq",label:"Dependencies",title:"Depen de",type:"lookupMultiCache",junction:{name:"PROCES_PROCES",primaryKey:"ID",ownerKey:"ID_PROCES",targetKey:"ID_RELACIONATAMB",dictionaryKey:"ID_RELACIONATAMB"},data:{name:"PROCES",primaryKey:"ID",targetKey:"CODIINOM",dictionaryKey:"CODIINOM"}},{name:"PROCES_ATTACHMENT",label:"Té adjunts",operation:"has"},{name:"VIGENT",operation:"eq"}],form:ka,menuUpdater:function(e,t){const a=(0,r.useRouter)(),n=(0,r.useRoute)(),i=t?[{text:"Fitxa procés",icon:"TextDocument",action:()=>Ka(t.ID)},{text:"Guia procediment",icon:"TextDocumentSettings",action:()=>Ga(t.ID)},{text:"Generar diagrama yED",icon:"TextDocumentSettings",action:()=>Qa(t.ID),disabled:0===t["TASCA@odata.count"]},{text:"Importar diagrama yED",icon:"TextDocumentSettings",action:()=>a.push({path:"/importarFlowChart",query:{id:t.ID,return:n.fullPath}}),disabled:0!==t["TASCA@odata.count"]}]:[];return e.concat(i)},permissionDenied:e=>({create:!1,edit:!1,delete:e&&0!==e["TASCA@odata.count"],export:!1}),detailsFilterXX:()=>({contains:[{property:"CODI"},"nee"]})},tn={name:"PROCES_INDICADOR",type:"listSplitted",label:"Indicadors de processos",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Indicador",type:"string",required:!0,maxlength:80},{name:"ID_TIPUSINDICADOR",label:"Tipus Indicador",type:"dictionary",entityName:"TIPUSINDICADOR",required:!0},{name:"CONCEPTE",label:"Concepte",type:"string",maxlength:255,multiline:!0},{name:"ID_PROCES",label:"Codi i nom procés",type:"lookupCache",entity:{name:"PROCES",primaryKey:"ID",targetKey:"CODIINOM"},required:!0},{name:"DESCRIPCIO",label:"Descripció",type:"string",maxlength:8e3,multiline:!0},{name:"FORMULADECALCUL",label:"Fórmula de càlcul",type:"string",maxlength:8e3,multiline:!0},{name:"PERIODICITATMESURA",label:"Periodicitat mesura",type:"string",maxlength:80},{name:"ALTA",label:"Data vigència",type:"date",defaultValue:()=>new Date(Date.now())},{name:"BAIXA",label:"Data baixa",type:"date",defaultValue:()=>new Date(2099,11,31)},{name:"CREATED",type:"date"},{name:"CREATEDBY",type:"string",maxlength:64},{name:"MODIFIED",type:"date"},{name:"MODIFIEDBY",type:"string",maxlength:64}],filter:[{name:"ID_PROCES",operation:"in"},{name:"TITLE",operation:"contains"},{name:"ID_TIPUSINDICADOR",operation:"in"}],form:{component:"auto",class:"INDICADOR-editItem-layout",maxWidth:"840px",fields:e=>["ID_PROCES","ID_TIPUSINDICADOR","TITLE","PERIODICITATMESURA","CONCEPTE","DESCRIPCIO","FORMULADECALCUL","ALTA","BAIXA"]}},an=[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"CODI",label:"Codi",type:"string",required:!0,maxlength:8},{name:"TITLE",label:"Títol quadre de comandament",type:"string",required:!0,maxlength:80},{name:"ID_TIPUSQUADRE",label:"Tipus quadre",type:"lookupCache",entity:{name:"TIPUSQUADRE",primaryKey:"ID",targetKey:"TITLE"},required:!0},{name:"FINALITAT",label:"Finalitat",type:"string",maxlength:255},{name:"DESTINATARIS",label:"Destinataris",type:"string",maxlength:255},{name:"ALTA",label:"Data alta",type:"date",defaultValue:()=>new Date(Date.now())},{name:"BAIXA",label:"Data de baixa",type:"date",defaultValue:()=>new Date(2099,11,31)},{name:"CODIINOM",label:"Codi i Títol quadre de comandament",type:"string",readonly:!0},{name:"QUADRECOMANDAMENT_USUARI",label:"Usuaris",type:"lookupMultiCache",junction:{name:"QUADRECOMANDAMENT_USUARI",primaryKey:"ID",ownerKey:"ID_QUADRECOMANDAMENT",targetKey:"ID_USUARI"},data:{name:"USUARI",primaryKey:"ID",targetKey:"TITLE"}},{name:"QUADRECOMANDAMENT_ATTACHMENT",label:"Adj.",type:"fileMulti",entity:{name:"QUADRECOMANDAMENT_ATTACHMENT",primaryKey:"ID",foreingKey:"ID_QUADRECOMANDAMENT",nameKey:"FILENAME",contentKey:"FILECONTENT",typeKey:"CONTENTTYPE"},detailsColumn:{width:"60px",align:"center"}},{name:"CREATED",type:"date"},{name:"CREATEDBY",type:"string",maxlength:64},{name:"MODIFIED",type:"date"},{name:"MODIFIEDBY",type:"string",maxlength:64},{name:"VIGENT",label:"Vigent",type:"boolean",readonly:!0}],nn={class:"QUADRECOMANDAMENT-editItem-layout"},ln={style:{"margin-top":"4px","grid-area":"errorMessage"}},on={__name:"form-quadre",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,i=(0,o.entityDefinition)(a.entity).entityName;at().load(i);const l=Ci(Ti(i),["CODI","TITLE","ID_TIPUSQUADRE","FINALITAT","QUADRECOMANDAMENT_USUARI","DESTINATARIS","ALTA","BAIXA"]),{errorMessage:r}=a.validations.createValidation("generals",{rules:[async e=>await gt("QUADRECOMANDAMENT",e,["CODI","TITLE"],"or")]});return(a,o)=>{const d=(0,n.resolveComponent)("fura-message-bar");return(0,n.openBlock)(),(0,n.createElementBlock)("div",nn,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(l),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(i),onChange:o[0]||(o[0]=e=>t("change",e.action))},null,8,["fields","entity","validations","cache-name"]),(0,n.createElementVNode)("div",ln,[(0,n.unref)(r)?((0,n.openBlock)(),(0,n.createBlock)(d,{key:0,type:"error",singleline:""},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(r)),1)])),_:1})):(0,n.createCommentVNode)("v-if",!0)])])}}},rn=(0,I.Z)(on,[["__scopeId","data-v-291aa364"]]),dn={name:"QUADRECOMANDAMENT",type:"listSplitted",label:"Quadres de comandament",fields:an,filter:[{name:"CODI",label:"Codi Quadre de comandament conté",operation:"contains"},{name:"TITLE",operation:"contains"},{name:"ID_TIPUSQUADRE",operation:"in"},{name:"QUADRECOMANDAMENT_USUARI",operation:"in"},{name:"QUADRECOMANDAMENT_TIPUSDADES",operation:"in"},{name:"DADAELEMENTAL_QUADRECOMANDAMENT",operation:"in"},{name:"QUADRECOMANDAMENT_ATTACHMENT",label:"Té adjunts",operation:"has"},{name:"VIGENT",operation:"eq"}],form:{component:(0,n.markRaw)(rn),maxWidth:"900px",children:[{listName:"DADAELEMENTAL_QUADRECOMANDAMENT",foreingKey:"ID_QUADRECOMANDAMENT",detailFields:["ID_OBJECTEDADA","ID_TIPUSDADA","ID_DADAELEMENTAL"]}],tabs:[{name:"DADAELEMENTAL_QUADRECOMANDAMENT",title:"Dades elementals",type:"child",listName:"DADAELEMENTAL_QUADRECOMANDAMENT",fields:["ID_OBJECTEDADA","ID_TIPUSDADA","ID_DADAELEMENTAL"],form:{component:(0,n.markRaw)(na),maxWidth:"780px"}},{name:"QUADRECOMANDAMENT_ATTACHMENT",title:"Arxius adjunts",component:"auto",fields:e=>[{name:"QUADRECOMANDAMENT_ATTACHMENT"}]}]}},sn=[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"ID_SERIEDOCUMENTAL",label:"Codi i nom sèrie documental",type:"lookupCache",entity:{name:"SERIEDOCUMENTAL",primaryKey:"ID",targetKey:"CODIINOM"},required:!0},{name:"NUMERO",label:"Nº de regla",type:"number",align:"right",required:!0,disabled:!0},{name:"INICI",label:"Esdeveniment d'inici",type:"string",maxlength:80,required:!0},{name:"TERMINI",label:"Esdeveniment de termini",type:"string",maxlength:80},{name:"ID_MOTIULIMITACIO",label:"Motiu de limitació",type:"dictionary",entityName:"MOTIULIMITACIO"},{name:"RESOLUCIO",label:"Resolució",type:"choice",options:["Esborrar","Crear","Modificar","Publicar","Versionar","Visualitzar","Visualitzar descripció","Sense accés"],required:!0,maxlength:8e3,multiline:!0},{name:"CRITERIAPLICACIO",label:"Criteri d'aplicació de la regla",type:"string",maxlength:8e3,multiline:!0},{name:"CRITERIPUBLICITAT",label:"Criteris de publicitat per transparència",type:"string",maxlength:8e3,multiline:!0},{name:"ID_TIPUSAGENT",label:"Tipus d'agent",type:"dictionary",entityName:"TIPUSAGENT",required:!0},{name:"ID_AGENT",label:"Codi i nom agent",type:"lookupCache",entity:{name:"AGENT",primaryKey:"ID",targetKey:"CODIINOM",cache:["ID_TIPUSAGENT"]},useFilter:e=>t=>e.ID_TIPUSAGENT&&t.ID_TIPUSAGENT===e.ID_TIPUSAGENT,required:!0},{name:"ALTA",label:"Data alta",type:"date",defaultValue:()=>new Date(Date.now())},{name:"BAIXA",label:"Data de baixa",type:"date",defaultValue:()=>new Date(2099,11,31)},{name:"CREATED",type:"date"},{name:"CREATEDBY",type:"string",maxlength:64},{name:"MODIFIED",type:"date"},{name:"MODIFIEDBY",type:"string",maxlength:64},{name:"VIGENT",label:"Vigent",type:"boolean",readonly:!0}],un={class:"REGLAACCES-editItem-layout"},cn={__name:"form-regla-acces",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,i=(0,o.entityDefinition)(a.entity).entityName;at().load(i);const l=Ti(i),r=(0,n.computed)((()=>Ci(l,[{name:"ID_SERIEDOCUMENTAL",disabled:!!a.entity.ID,async onChange(e){if(e.ID_SERIEDOCUMENTAL){const t=await Ne("REGLAACCES",{$select:"NUMERO",$filter:`ID_SERIEDOCUMENTAL eq ${e.ID_SERIEDOCUMENTAL}`,$orderby:"NUMERO desc",$top:1});return e=>{e.NUMERO=t.value.length>0?t.value[0].NUMERO+1:1}}}},"NUMERO","INICI","TERMINI","ID_MOTIULIMITACIO","RESOLUCIO","ID_TIPUSAGENT","ID_AGENT","CRITERIAPLICACIO","CRITERIPUBLICITAT","ALTA","BAIXA"])));return(a,l)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",un,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(r),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(i),onChange:l[0]||(l[0]=e=>t("change",e.action))},null,8,["fields","entity","validations","cache-name"])]))}},mn=(0,I.Z)(cn,[["__scopeId","data-v-58642a5a"]]),pn={name:"REGLAACCES",type:"listSplitted",label:"Regles d'accés",fields:sn,filter:[{name:"ID_SERIEDOCUMENTAL",operation:"in"},{name:"INICI",label:"Esdeveniment d'inici conté",operation:"contains"},{name:"TERMINI",label:"Esdeveniment de termini conté",operation:"contains"},{name:"RESOLUCIO",operation:"eq"},{name:"ID_AGENT",operation:"in"},{name:"VIGENT",operation:"eq"}],form:{component:(0,n.markRaw)(mn),maxWidth:"930px"}},yn=[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"ID_SERIEDOCUMENTAL",label:"Codi i nom sèrie documental",type:"lookupCache",entity:{name:"SERIEDOCUMENTAL",primaryKey:"ID",targetKey:"CODIINOM"},required:!0},{name:"NUMEROREGLA",label:"Nº regla",type:"number",align:"right",required:!0,disabled:!0},{name:"ESDEVENIMENTINICI",label:"Esdeveniment d'inici",type:"string",required:!0,maxlength:120},{name:"TERMINI",label:"Termini",type:"string",maxlength:120},{name:"RESOLUCIO",label:"Resolució",type:"choice",options:[{value:"Conservació",text:"Conservació"},{value:"Conservació ",text:"Conservació parcial"},{value:"Eliminació",text:"Eliminació"},{value:"Pendent de d",text:"Pendent de definir"}],maxlength:12},{name:"CRITERIMOSTREIG",label:"Criteri mostreig",type:"string",maxlength:8e3},{name:"SUPORTDESTI",label:"Suport de destí",type:"choice",options:["Físic","Electrònic"],maxlength:12},{name:"ID_FORMATDESTI",label:"Format de destí",type:"dictionary",entityName:"FORMAT"},{name:"ID_DIPOSITDESTI",label:"Dipòsit de destí",type:"dictionary",entityName:"DIPOSITDESTI"},{name:"FONTREGLA",label:"Font de la regla",type:"string",maxlength:120},{name:"ID_SISTEMAINFORMACIO",label:"Sist. d'informació de destí",type:"lookupCache",entity:{name:"SISTEMAINFORMACIO",primaryKey:"ID",targetKey:"CODIINOM"}},{name:"ALTA",label:"Data alta",type:"date",defaultValue:()=>new Date(Date.now())},{name:"BAIXA",label:"Data de baixa",type:"date",defaultValue:()=>new Date(2099,11,31)},{name:"CREATED",type:"date"},{name:"CREATEDBY",type:"string",maxlength:64},{name:"MODIFIED",type:"date"},{name:"MODIFIEDBY",type:"string",maxlength:64},{name:"VIGENT",label:"Vigent",type:"boolean",readonly:!0}],In={class:"REGLACONSERVACIO-editItem-layout"},fn={__name:"form-regla-conservacio",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,i=(0,o.entityDefinition)(a.entity).entityName;at().load(i);const l=Ti(i),r=(0,n.computed)((()=>Ci(l,[{name:"ID_SERIEDOCUMENTAL",disabled:!!a.entity.ID,async onChange(e){if(e.ID_SERIEDOCUMENTAL){const t=await Ne("REGLACONSERVACIO",{$select:"NUMEROREGLA",$filter:`ID_SERIEDOCUMENTAL eq ${e.ID_SERIEDOCUMENTAL}`,$orderby:"NUMEROREGLA desc",$top:1});return e=>{e.NUMEROREGLA=t.value.length>0?t.value[0].NUMEROREGLA+1:1}}}},"NUMEROREGLA","ESDEVENIMENTINICI","TERMINI","RESOLUCIO","CRITERIMOSTREIG","SUPORTDESTI","ID_FORMATDESTI","ID_DIPOSITDESTI","FONTREGLA","ID_SISTEMAINFORMACIO","ALTA","BAIXA"])));return(a,l)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",In,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(r),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(i),onChange:l[0]||(l[0]=e=>t("change",e.action))},null,8,["fields","entity","validations","cache-name"])]))}},En=(0,I.Z)(fn,[["__scopeId","data-v-29ef8ad1"]]),An={name:"REGLACONSERVACIO",type:"listSplitted",label:"Regles de conservació",fields:yn,filter:[{name:"ID_SERIEDOCUMENTAL",operation:"in"},{name:"ID_SISTEMAINFORMACIO",operation:"in"},{name:"ESDEVENIMENTINICI",label:"Esdeveniment d'inici conté",operation:"contains"},{name:"TERMINI",label:"Esdeveniment de termini conté",operation:"contains"},{name:"FONTREGLA",label:"Font de la regla conté",operation:"contains"},{name:"RESOLUCIO",operation:"eq"},{name:"SUPORTDESTI",operation:"eq"},{name:"ID_FORMATDESTI",operation:"in"},{name:"ID_DIPOSITDESTI",operation:"eq"},{name:"VIGENT",operation:"eq"}],form:{component:(0,n.markRaw)(En),maxWidth:"930px"}},Tn=[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Títol de la sèrie documental",type:"string",required:!0,loadAlwaysInView:!0,maxlength:255},{name:"ID_PROCES",label:"Codi i nom procés",type:"lookup",entity:{name:"PROCES",primaryKey:"ID",targetKey:"CODIINOM"},loadAlwaysInView:!0,required:!0},{name:"CODI",label:"Codi",type:"string",required:!0,maxlength:24},{name:"TITOLCORPORATIU",label:"Títol segons quadre de classificació corporatiu",type:"string",maxlength:120},{name:"CARACTER",label:"Caràcter",type:"choice",options:["Primària","Secundària"],required:!0,maxlength:12},{name:"ID_TIPUSPRODUCTOR",label:"Tipus Productor",type:"dictionary",entityName:"TIPUSAGENT",required:!0},{name:"ID_PRODUCTOR",label:"Codi i nom productor",type:"lookupCache",entity:{name:"AGENT",primaryKey:"ID",targetKey:"CODIINOM",cache:["ID_TIPUSAGENT"]},required:!0,useFilter:e=>t=>e.ID_TIPUSPRODUCTOR&&t.ID_TIPUSAGENT===e.ID_TIPUSPRODUCTOR},{name:"CLASSIFICACIO",label:"Classificació",type:"string",maxlength:120},{name:"VITAL",label:"Vital",type:"boolean"},{name:"DESCRIPCIO",label:"Descripció",type:"string",maxlength:8e3,multiline:!0},{name:"CRITERINORMALITZACIO",label:"Criteri per donar nom als expedients",type:"string",maxlength:120},{name:"ID_TRACTAMENTDADESPERSONALS",label:"Tractaments de dades personals relacionat",type:"lookupCache",entity:{name:"TRACTAMENTDADESPERSONALS",primaryKey:"ID",targetKey:"TITLE"}},{name:"DIGITAL",label:"100% digital",type:"boolean"},{name:"ALTA",label:"Data alta",type:"date",defaultValue:()=>new Date(Date.now())},{name:"BAIXA",label:"Data de baixa",type:"date",defaultValue:()=>new Date(2099,11,31)},{name:"CODIINOM",label:"Codi i Títol propi sèrie",type:"string",readonly:!0},{name:"CREATED",type:"date"},{name:"CREATEDBY",type:"string",maxlength:64},{name:"MODIFIED",type:"date"},{name:"MODIFIEDBY",type:"string",maxlength:64},{name:"VIGENT",label:"Vigent",type:"boolean",readonly:!0}],Cn={class:"SERIEDOCUMENTAL-editItem-layout"},Dn={style:{"margin-top":"4px","grid-area":"errorMessage"}},Nn={__name:"form-serie-documental",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,i=(0,o.entityDefinition)(a.entity).entityName;at().load(i);const l=Ti(i),r=(0,n.computed)((()=>Ci(l,["ID_PROCES","CODI","TITLE","DIGITAL","VITAL","CLASSIFICACIO","TITOLCORPORATIU","CARACTER","ID_TIPUSPRODUCTOR","ID_PRODUCTOR","CRITERINORMALITZACIO","ID_TRACTAMENTDADESPERSONALS","ALTA","BAIXA"]))),{errorMessage:d}=a.validations.createValidation("generals",{rules:ba});return(a,l)=>{const o=(0,n.resolveComponent)("fura-message-bar");return(0,n.openBlock)(),(0,n.createElementBlock)("div",Cn,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(r),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(i),onChange:l[0]||(l[0]=e=>t("change",e.action))},null,8,["fields","entity","validations","cache-name"]),(0,n.createElementVNode)("div",Dn,[(0,n.unref)(d)?((0,n.openBlock)(),(0,n.createBlock)(o,{key:0,type:"error",singleline:""},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(d)),1)])),_:1})):(0,n.createCommentVNode)("v-if",!0)])])}}},gn=(0,I.Z)(Nn,[["__scopeId","data-v-772bd458"]]),vn={class:"SERIE-DEPENDENCIES-edit-layout"},On={__name:"form-serie-serie",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e){const t=e,a=(0,o.entityDefinition)(t.entity).entityName;at().load(a);const i=Ci(Ti(a),[{name:"ID_SERIEDOCUMENTAL",disabled:!0},{name:"ID_SERIEDOCUMENTAL",type:"hidden"},{name:"ID_RELACIONADAAMB",filter:`ID_PROCES eq ${(0,o.entityParent)((0,o.entityBase)(t.entity)??t.entity).ID_PROCES}`},"TIPUSRELACIO"]);return(t,a)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",vn,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(i),entity:e.entity,validations:e.validations,"cache-name":"entityName",onChange:a[0]||(a[0]=e=>t.$emit("change",e.action))},null,8,["fields","entity","validations"])]))}},Sn=(0,I.Z)(On,[["__scopeId","data-v-ce481456"]]),bn={class:"SERIEDOCUMENTAL-EVIDENCIA-editItem-layout"},hn={style:{"margin-top":"4px","grid-area":"errorMessage"}},Rn={__name:"form-evidencia",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,i=(0,o.entityDefinition)(a.entity).entityName;(0,o.entityParent)((0,o.entityBase)(a.entity)??a.entity).ID_PROCES,t("change",(e=>{e.ID_PROCES=(0,o.entityParent)((0,o.entityBase)(a.entity)??a.entity).ID_PROCES})),at().load(i);const l=Ti(i),r=(0,n.computed)((()=>Ci(l,[{name:"ID_PROCES",disabled:!0},"CODI","CARACTER","ESSENCIAL",{name:"ID_SERIEDOCUMENTAL",disabled:!0},"AUTENTIFICACIO","ID_FORMAT","TITLE","TIPUS","REGISTREENTRADA","REGISTRESORTIDA","ID_TIPUSPRODUCTOR","ID_PRODUCTOR","ID_TIPUSDESTINATARI","ID_DESTINATARI","ID_SISTEMA",{name:"ID_DEPENDENCIA",filter:`ID_PROCES eq ${a.entity.ID_PROCES||0}`},"ID_TIPUSMODEL",{name:"EVIDENCIA_MODELDOCUMENT",filter:`ID_TIPUS eq ${a.entity.ID_TIPUSMODEL||0}`},"ALTA","BAIXA"]))),{errorMessage:d}=a.validations.createValidation("generals",{rules:ba});return(a,l)=>{const o=(0,n.resolveComponent)("fura-message-bar");return(0,n.openBlock)(),(0,n.createElementBlock)("div",bn,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(r),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(i),onChange:l[0]||(l[0]=e=>t("change",e.action))},null,8,["fields","entity","validations","cache-name"]),(0,n.createElementVNode)("div",hn,[(0,n.unref)(d)?((0,n.openBlock)(),(0,n.createBlock)(o,{key:0,type:"error",singleline:""},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(d)),1)])),_:1})):(0,n.createCommentVNode)("v-if",!0)])])}}},_n=(0,I.Z)(Rn,[["__scopeId","data-v-ee6d0b46"]]),Mn={class:"SERIE-REGLAACCES-editItem-layout"},xn={__name:"form-regla-acces",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,i=(0,o.entityDefinition)(a.entity).entityName;at().load(i);const l=Ti(i),r=(0,n.computed)((()=>Ci(l,[{name:"ID_SERIEDOCUMENTAL",disabled:!0},"NUMERO","INICI","TERMINI","ID_MOTIULIMITACIO","RESOLUCIO","ID_TIPUSAGENT","ID_AGENT","CRITERIAPLICACIO","CRITERIPUBLICITAT","ALTA","BAIXA"])));return Zt((async()=>{if(!a.entity.ID){const e=await Ne("REGLAACCES",{$select:"NUMERO",$filter:`ID_SERIEDOCUMENTAL eq ${a.entity.ID_SERIEDOCUMENTAL}`,$orderby:"NUMERO desc",$top:1});t("change",(t=>{t.NUMERO=e.value.length>0?e.value[0].NUMERO+1:1}))}})),(a,l)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",Mn,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(r),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(i),onChange:l[0]||(l[0]=e=>t("change",e.action))},null,8,["fields","entity","validations","cache-name"])]))}},Ln=(0,I.Z)(xn,[["__scopeId","data-v-0b850261"]]),Pn={class:"SERIE-REGLACONSERVACIO-editItem-layout"},wn={__name:"form-regla-conservacio",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,i=(0,o.entityDefinition)(a.entity).entityName;at().load(i);const l=Ti(i),r=(0,n.computed)((()=>Ci(l,[{name:"ID_SERIEDOCUMENTAL",disabled:!0},"NUMEROREGLA","ESDEVENIMENTINICI","TERMINI","RESOLUCIO","ID_FORMATDESTI","SUPORTDESTI","ID_DIPOSITDESTI","ID_SISTEMAINFORMACIO","FONTREGLA","CRITERIMOSTREIG","ALTA","BAIXA"])));return Zt((async()=>{if(!a.entity.ID){const e=await Ne("REGLACONSERVACIO",{$select:"NUMEROREGLA",$filter:`ID_SERIEDOCUMENTAL eq ${a.entity.ID_SERIEDOCUMENTAL}`,$orderby:"NUMEROREGLA desc",$top:1});t("change",(t=>{t.NUMEROREGLA=e.value.length>0?e.value[0].NUMEROREGLA+1:1}))}})),(a,l)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",Pn,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(r),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(i),onChange:l[0]||(l[0]=e=>t("change",e.action))},null,8,["fields","entity","validations","cache-name"])]))}},Vn=(0,I.Z)(wn,[["__scopeId","data-v-46b07fcf"]]);function Bn(e,t){return{margin:[2,30,40,0],columns:[{text:"CEB. Catàleg de Processos",alignment:"left",width:"25%",margin:[40,0,0,0]},{text:"FITXA SÈRIE DOCUMENTAL",bold:!0,fontSize:14,alignment:"center",width:"*"},{table:{widths:["auto","auto"],body:[[{text:"Pàg. ",alignment:"left",fontSize:8},{text:e+" de "+t,alignment:"right",fontSize:8}],[{text:"Data ",alignment:"left",fontSize:8},{text:qa(),alignment:"right",fontSize:8}]]},layout:"noBorders",width:"63",alignment:"right"}]}}const Un={name:"SERIEDOCUMENTAL",type:"listSplitted",label:"Sèries documentals",fields:Tn,filter:[{name:"ID_PROCES",label:"Codi i/o nom procés conté",operation:"contains"},{name:"CODI",label:"Codi Série documental conté",operation:"contains"},{name:"TITLE",label:"Nom Série documental conté",operation:"contains"},{name:"TITOLCORPORATIU",operation:"contains"},{name:"ID_PRODUCTOR",operation:"in"},{name:"CLASSIFICACIO",operation:"contains"},{name:"VITAL",operation:"eq"},{name:"DIGITAL",operation:"eq"},{name:"ID_TRACTAMENTDADESPERSONALS",operation:"in"},{name:"VIGENT",operation:"eq"}],form:{component:(0,n.markRaw)(gn),maxWidth:"1200px",children:[{listName:"SERIEDOCUMENTAL_SERIEDOCUMENTAL",foreingKey:"ID_SERIEDOCUMENTAL",detailFields:["ID_RELACIONADAAMB"]},{listName:"EVIDENCIA",foreingKey:"ID_SERIEDOCUMENTAL",detailFields:["ID_PROCES"]},{listName:"REGLAACCES",foreingKey:"ID_SERIEDOCUMENTAL"},{listName:"REGLACONSERVACIO",foreingKey:"ID_SERIEDOCUMENTAL",detailFields:["ID_DIPOSITDESTI","ID_SISTEMAINFORMACIO"]}],tabs:[{name:"DESCRIPCIO",title:"Descripció",component:"auto",fields:e=>[{name:"DESCRIPCIO",label:" ",multiline:!0}]},{name:"SERIEDOCUMENTAL_SERIEDOCUMENTAL",title:"Relacions",type:"child",listName:"SERIEDOCUMENTAL_SERIEDOCUMENTAL",fields:["ID_RELACIONADAAMB","TIPUSRELACIO"],form:{component:(0,n.markRaw)(Sn),maxWidth:"810px"}},{name:"TAB_EVIDENCIA",title:"Evidències",type:"child",listName:"EVIDENCIA",fields:["CODI","TITLE","TIPUS","CARACTER"],form:{component:(0,n.markRaw)(_n),maxWidth:"1190px"}},{name:"ACCES",title:"Regles d'accés",type:"child",listName:"REGLAACCES",fields:["NUMERO","INICI","TERMINI","RESOLUCIO","ID_AGENT"],form:{component:(0,n.markRaw)(Ln),maxWidth:"1020px"}},{name:"CONSERVACIO",title:"Regles de conservació",type:"child",listName:"REGLACONSERVACIO",fields:["NUMEROREGLA","ESDEVENIMENTINICI","ID_DIPOSITDESTI","ID_SISTEMAINFORMACIO"],form:{component:(0,n.markRaw)(Vn),maxWidth:"1020px"}}]},menuUpdater:function(e,t){const a=t?[{text:"Fitxa Sèrie Documental",icon:"TextDocument",action:()=>async function(e){$a?.pdfMake&&(Fa.vfs=$a.pdfMake.vfs);const t=[{name:"Sistema",promise:Ne(`SERIEDOCUMENTAL(${e})`,{$select:"CODI,TITLE,TITOLCORPORATIU,CARACTER,CLASSIFICACIO,VITAL,DESCRIPCIO,CRITERINORMALITZACIO,DIGITAL",$expand:"TIPUSAGENT($select=TITLE),AGENT($select=CODIINOM),PROCES($select=CODIINOM),TRACTAMENTDADESPERSONALS($select=TITLE),SERIEDOCUMENTAL_SERIEDOCUMENTAL($select=TIPUSRELACIO;$expand=SERIEDOCUMENTAL1($select=CODIINOM);$orderby=SERIEDOCUMENTAL1/CODIINOM),EVIDENCIA($select=CODIINOM,TIPUS,CARACTER,AUTENTIFICACIO,ESSENCIAL;$expand=AGENT($select=CODIINOM),FORMAT($select=TITLE);$orderby=CODIINOM),REGLAACCES($select=NUMERO,INICI,TERMINI,RESOLUCIO;$expand=MOTIULIMITACIO($select=TITLE),AGENT($select=CODIINOM);$orderby=NUMERO),REGLACONSERVACIO($select=NUMEROREGLA,ESDEVENIMENTINICI,TERMINI,RESOLUCIO,CRITERIMOSTREIG,FONTREGLA;$expand=DIPOSITDESTI($select=TITLE),SISTEMAINFORMACIO($select=CODIINOM);$orderby=NUMEROREGLA)"})},{name:"dades",promise:Ne("DADAELEMENTAL",{$select:"TITLE",$expand:"OBJECTEDADA($select=TITLE),TIPUSDADA($select=TITLE)",$filter:`DADAELEMENTAL_EVIDENCIA/all(d:d/EVIDENCIA/SERIEDOCUMENTAL/ID eq ${e})`,$orderby:"OBJECTEDADA/TITLE,TIPUSDADA/TITLE,TITLE"})}],a=await Promise.all(t.map((e=>e.promise))),n=a[0],i=n.SERIEDOCUMENTAL_SERIEDOCUMENTAL,l=n.EVIDENCIA,o=n.REGLAACCES,r=n.REGLACONSERVACIO,d=a[1].value,s={pageOrientation:"landscape",pageMargins:[40,75,40,40],header:Bn,styles:{title:{bold:!0,fontSize:14,background:"#0078d7",color:"white",fillColor:"#0078d7"},subtitle:{bold:!0,fontSize:12,background:"#0078d7",color:"white",fillColor:"#0078d7"},sepBlue:{bold:!0,fontSize:2,background:"#0078d7",color:"white",fillColor:"#0078d7"},header:{italics:!0,bold:!0},link:{italics:!0,color:"#54BAE6"}},defaultStyle:{fontSize:10},content:[{layout:"noBorders",table:{widths:["100%"],border:"none",body:[[{text:"Dades de la sèrie documental",style:"title",alignment:"center"}],[{text:".",fontSize:8,color:"white"}]]}},{table:{widths:["20%","80%"],body:[[{text:"Codi de la sèrie documental",italics:!0,bold:!0},{text:n.CODI||""}],[{text:"Títol de la sèrie documental",italics:!0,bold:!0},{text:n.TITLE||""}],[{text:"Caràcter",italics:!0,bold:!0},{text:n.CARACTER||""}],[{text:"Classificació",italics:!0,bold:!0},{text:n.CLASSIFICACIO||""}],[{text:"Criteri de nominalització",italics:!0,bold:!0},{text:n.CRITERINORMALITZACIO||""}],[{text:"Procés",italics:!0,bold:!0},{text:n.PROCES?n.PROCES.CODIINOM:""}],[{text:"Descripció",italics:!0,bold:!0},{text:n.DESCRIPCIO||""}],[{text:"Productor",italics:!0,bold:!0},{text:n.AGENT?n.AGENT.CODIINOM:""}],[{text:"Fitxer dades personals",italics:!0,bold:!0},{text:n.TRACTAMENTDADESPERSONALS?n.TRACTAMENTDADESPERSONALS.TITLE:""}]]}},{layout:"noBorders",table:{widths:["100%"],body:[[{text:".",fontSize:24,color:"white"}],[{text:"SÈRIES DOCUMENTALS RELACIONADES",style:"title"}],[{text:".",fontSize:4,color:"white"}]]}},{style:"taula",table:{headerRows:1,widths:["70%","30%"],body:[[{text:"Relacionada amb",style:"header"},{text:"Tipus de relació",style:"header"}],...i.map((e=>[e.SERIEDOCUMENTAL1?e.SERIEDOCUMENTAL1.CODIINOM:"",e.TIPUSRELACIO||""]))]}},{layout:"noBorders",table:{widths:["100%"],body:[[{text:".",fontSize:24,color:"white"}],[{text:"DOCUMENTS DE LA SÈRIE DOCUMENTAL",style:"title"}],[{text:".",fontSize:4,color:"white"}]]}},{style:"taula",table:{headerRows:1,widths:["40%","24%","6%","6%","6%","12%","6%"],body:[[{text:"Codi i Títol",style:"header"},{text:"Productor",style:"header"},{text:"Tipus",style:"header"},{text:"Caràcter",style:"header"},{text:"Format",style:"header"},{text:"Autentificació",style:"header"},{text:"Essencial",style:"header"}],...l.map((e=>[e.CODIINOM||"",e.AGENT?e.AGENT.CODIINOM:"",e.TIPUS||"",e.CARACTER||"",e.FORMAT?e.FORMAT.TITLE:"",e.AUTENTFICACIO||"",e.ESSENCIAL?"Sí":"No"]))]}},{layout:"noBorders",table:{widths:["100%"],body:[[{text:".",fontSize:24,color:"white"}],[{text:"REGLES D'ACCÉS",style:"title"}],[{text:".",fontSize:4,color:"white"}]]}},{style:"taula",table:{headerRows:1,widths:["2%","19%","19%*","30%","10%","20%"],body:[[{text:"Nº",style:"header"},{text:"Inici",style:"header"},{text:"Termini",style:"header"},{text:"Agent",style:"header"},{text:"Resolució",style:"header"},{text:"Motiu de limitació",style:"header"}],...o.map((e=>[e.NUMERO||"0",e.INICI||"",e.TERMINI||"",e.AGENT?e.AGENT.CODIINOM:"",e.RESOLUCIO||"",e.MOTIULIMITACIO?e.MOTIULIMITACIO.TITLE:""]))]}},{layout:"noBorders",table:{widths:["100%"],body:[[{text:".",fontSize:24,color:"white"}],[{text:"REGLES DE CONSERVACIO",style:"title"}],[{text:".",fontSize:4,color:"white"}]]}},{style:"taula",table:{headerRows:1,widths:["2%","12%","12%","16%","8%","20%","30%"],body:[[{text:"Nº",style:"header"},{text:"Inici",style:"header"},{text:"Termini",style:"header"},{text:"Font de la regla",style:"header"},{text:"Resolució",style:"header"},{text:"Criteri de mostreig",style:"header"},{text:"Dipòsit o S.I. de destí",style:"header"}],...r.map((e=>[e.NUMEROREGLA||"0",e.ESDEVENIMENTINICI||"",e.TERMINI||"",e.FONTREGLA||"",e.RESOLUCIO||"",e.CRITERIMOSTREIG||"",e.DIPOSITDESTI?e.DIPOSITDESTI.TITLE:e.SISTEMAINFORMACIO?e.SISTEMAINFORMACIO.CODIINOM:""]))]}},{layout:"noBorders",table:{widths:["100%"],body:[[{text:".",fontSize:24,color:"white"}],[{text:"DADES DE LA SÈRIE DOCUMENTAL",style:"title"}],[{text:".",fontSize:4,color:"white"}]]}},{style:"taula",table:{headerRows:1,widths:["50%","15%","35%"],body:[[{text:"Objecte",style:"header"},{text:"Tipus",style:"header"},{text:"Dada",style:"header"}],...d.map((e=>[e.OBJECTEDADA?e.OBJECTEDADA.TITLE:"",e.TIPUSDADA?e.TIPUSDADA.TITLE:"",e.TITLE||""]))]}}]};await new Promise((e=>{Fa.createPdf(s).download("seriedocumental.pdf")}))}(t.ID)}]:[];return e.concat(a)}},kn=[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Nom Sistema",type:"string",required:!0,maxlength:120},{name:"CODI",label:"Codi",type:"string",required:!0,maxlength:8},{name:"NOMCURT",label:"Nom curt sistema",type:"string",required:!0,maxlength:120},{name:"DIALEGCTTI",label:"Diàleg CTTI",type:"string",maxlength:80},{name:"ABAST",label:"Abast",type:"choice",options:["Administració General de l'Estat","Ajuntament de Barcelona","CEB empresa externa","CEB propi","Departament d'Ensenyament","Generalitat de Catalunya","Usuari final"],maxlength:40},{name:"URL",label:"URL",type:"string",maxlength:255},{name:"ID_TIPUSPROMOTOR",label:"Tipus promotor",type:"dictionary",entityName:"TIPUSAGENT",required:!0},{name:"ID_PROMOTOR",label:"Codi i nom promotor",type:"lookupCache",entity:{name:"AGENT",primaryKey:"ID",targetKey:"CODIINOM",cache:["ID_TIPUSAGENT"]},required:!0,useFilter:e=>t=>e.ID_TIPUSPROMOTOR&&t.ID_TIPUSAGENT===e.ID_TIPUSPROMOTOR},{name:"RESPFUNCIONAL",label:"Responsable funcional",type:"string",maxlength:80},{name:"GESTORTIC",label:"Gestor TIC",type:"string",maxlength:80},{name:"DESCRIPCIO",label:"Descripció",type:"string",maxlength:8e3,multiline:!0},{name:"FUNCIONALITAT",label:"FUNCIONALITAT",type:"string",maxlength:8e3,multiline:!0},{name:"ID_MODELDESERVEI",label:"Model de servei",type:"dictionary",entityName:"MODELDESERVEI"},{name:"ID_PROVEIDOR",label:"Proveïdor",type:"dictionary",entityName:"PROVEIDOR"},{name:"ID_CONTROLINTEGRITAT",label:"Control d'integritat",type:"dictionary",entityName:"CONTROLINTEGRITAT"},{name:"ID_CONTROLACCES",label:"Control d'accès",type:"dictionary",entityName:"CONTROLACCES"},{name:"RESTRICCIONSSEMANTIQUES",label:"Restriccions semàntiques",type:"string",maxlength:255},{name:"RESTRICCIONSFORMAT",label:"Restriccions de format",type:"string",maxlength:255},{name:"CODICLIENTADMINISTRATIU",label:"Codi Client Administratiu",type:"string",maxlength:255},{name:"CODISERVEICPD",label:"Codi Servei CPD",type:"string",maxlength:80},{name:"LOTCPD",label:"Lot CPD",type:"string",maxlength:80},{name:"RTO",label:"RTO",type:"string",maxlength:80},{name:"RPO",label:"RPO",type:"string",maxlength:80},{name:"ID_CLASSIFICACIOENS",label:"Classificació ENS",type:"dictionary",entityName:"CLASSIFICACIOENS"},{name:"DATAINICIPRODUCCIO",label:"Data Inici Producció",type:"date"},{name:"ANS",label:"ANS",type:"choice",options:["Bàsic","Mitjà","Alt"],maxlength:80},{name:"NAQ",label:"NAQ",type:"choice",options:["Bàsic","Mitjà","Alt"],maxlength:80},{name:"CODIINOM",label:"Codi i Nom curt sistema",type:"string",readonly:!0},{name:"ALTA",label:"Data alta",type:"date",defaultValue:()=>new Date(Date.now())},{name:"BAIXA",label:"Data de baixa",type:"date",defaultValue:()=>new Date(2099,11,31)},{name:"SISTEMAINFORMACIO_ENTORN",label:"Entorns",type:"dictionaryMulti",entityName:"ENTORN",junction:{name:"SISTEMAINFORMACIO_ENTORN",primaryKey:"ID",ownerKey:"ID_SISTEMAINFORMACIO",dictionaryKey:"ID_ENTORN"}},{name:"SISTEMAINFORMACIO_ENTORNTECNOLOGIC",label:"Entorns tecnològics",type:"dictionaryMulti",entityName:"ENTORNTECNOLOGIC",junction:{name:"SISTEMAINFORMACIO_ENTORNTECNOLOGIC",primaryKey:"ID",ownerKey:"ID_SISTEMAINFORMACIO",dictionaryKey:"ID_ENTORNTECNOLOGIC"}},{name:"SISTEMAINFORMACIO_UNITATDESCRIPCIO",label:"Unitats de descripció",type:"lookupMultiCache",junction:{name:"SISTEMAINFORMACIO_UNITATDESCRIPCIO",primaryKey:"ID",ownerKey:"ID_SISTEMAINFORMACIO",targetKey:"ID_UNITATDESCRIPCIO"},data:{name:"UNITATDESCRIPCIO",primaryKey:"ID",targetKey:"TITLE"}},{name:"CREATED",type:"date"},{name:"CREATEDBY",type:"string",maxlength:64},{name:"MODIFIED",type:"date"},{name:"MODIFIEDBY",type:"string",maxlength:64},{name:"VIGENT",label:"Vigent",type:"boolean",readonly:!0},{name:"REGLACONSERVACIO/odata.count",type:"childCount",navigationKey:"REGLACONSERVACIO",loadAlwaysInView:!0},{name:"EVIDENCIA/odata.count",type:"childCount",navigationKey:"EVIDENCIA",loadAlwaysInView:!0},{name:"INTERFICIECONNEXIO/odata.count",type:"childCount",navigationKey:"INTERFICIECONNEXIO",loadAlwaysInView:!0},{name:"INTERFICIECONNEXIO1/odata.count",type:"childCount",navigationKey:"INTERFICIECONNEXIO1",loadAlwaysInView:!0}],Fn={class:"SISTEMAINFORMACIO-editItem-layout"},$n={style:{"margin-top":"4px","grid-area":"errorMessage"}},qn={__name:"form-sistema",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,i=(0,o.entityDefinition)(a.entity).entityName;at().load(i);const l=Ci(Ti(i),["TITLE","CODI","URL","NOMCURT","ID_TIPUSPROMOTOR","ID_PROMOTOR","RESPFUNCIONAL","GESTORTIC","LOTCPD","ID_PROVEIDOR","SISTEMAINFORMACIO_ENTORN","SISTEMAINFORMACIO_ENTORNTECNOLOGIC","CODISERVEICPD","ID_MODELDESERVEI","ABAST","CODICLIENTADMINISTRATIU","RESTRICCIONSSEMANTIQUES","ID_CONTROLACCES","ID_CONTROLINTEGRITAT","SISTEMAINFORMACIO_UNITATDESCRIPCIO","RESTRICCIONSFORMAT","RTO","RPO","ID_CLASSIFICACIOENS","DIALEGCTTI","ANS","NAQ","DATAINICIPRODUCCIO","ALTA","BAIXA"]),{errorMessage:r}=a.validations.createValidation("generals",{rules:[async e=>await gt("SISTEMAINFORMACIO",e,["CODI","TITLE"],"or")]});return(a,o)=>{const d=(0,n.resolveComponent)("fura-message-bar");return(0,n.openBlock)(),(0,n.createElementBlock)("div",Fn,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(l),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(i),onChange:o[0]||(o[0]=e=>t("change",e.action))},null,8,["fields","entity","validations","cache-name"]),(0,n.createElementVNode)("div",$n,[(0,n.unref)(r)?((0,n.openBlock)(),(0,n.createBlock)(d,{key:0,type:"error",singleline:""},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(r)),1)])),_:1})):(0,n.createCommentVNode)("v-if",!0)])])}}},Kn=(0,I.Z)(qn,[["__scopeId","data-v-666fb3a4"]]),Gn={class:"SISTEMAINFORMACIO-INDICADORSISTEMA-editItem-layout"},jn={style:{"margin-top":"4px","grid-area":"errorMessage"}},zn={__name:"form-indicador",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,i=(0,o.entityDefinition)(a.entity).entityName;at().load(i);const l=Ci(Ti(i),[{name:"ID_SISTEMA",disabled:!0},"ID_TIPUSINDICADOR","TITLE","PERIODICITATMESURA","CONCEPTE","DESCRIPCIO","FORMULADECALCUL"]),{errorMessage:r}=a.validations.createValidation("generals",{rules:[async e=>await gt("SISTEMAINFORMACIO_INDICADOR",e,["TITLE"],"or")]});return(a,o)=>{const d=(0,n.resolveComponent)("fura-message-bar");return(0,n.openBlock)(),(0,n.createElementBlock)("div",Gn,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(l),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(i),onChange:o[0]||(o[0]=e=>t("change",e.action))},null,8,["fields","entity","validations","cache-name"]),(0,n.createElementVNode)("div",jn,[(0,n.unref)(r)?((0,n.openBlock)(),(0,n.createBlock)(d,{key:0,type:"error",singleline:""},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(r)),1)])),_:1})):(0,n.createCommentVNode)("v-if",!0)])])}}},Wn=(0,I.Z)(zn,[["__scopeId","data-v-32c4c3b6"]]),Yn={class:"SISTEMA-INTERFICIECONNEXIO-CARREGA-editItem-layout"},Xn={__name:"form-interficie-carrega",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,i="INTERFICIECONNEXIO";at().load(i);const l=Ti(i),o=(0,n.computed)((()=>Ci(l,[{name:"ID_SISTEMAINFORMACIO",disabled:!0},"ID_TIPUSINTERFICIE","TITLE","ID_TIPUSIMPORTACIO","ID_PROCEDIMENTIMPORTACIO","ID_PERIODEACTUALITZACIO","ID_HISTORIFICACIO",{name:"ID_SISTEMAORIGENDADES",required:!a.entity.NOMARXIUCARREGA},{name:"NOMARXIUCARREGA",required:!a.entity.ID_SISTEMAORIGENDADES},"OBSERVACIONS","ALTA","BAIXA"])));return(a,l)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",Yn,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(o),entity:e.entity,validations:e.validations,"cache-name":i,onChange:l[0]||(l[0]=e=>t("change",e.action))},null,8,["fields","entity","validations"])]))}},Hn=(0,I.Z)(Xn,[["__scopeId","data-v-3487cec9"]]),Zn={class:"SISTEMA-DESTI-editItem-layout"},Jn={__name:"form-interficie-origen",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a="INTERFICIECONNEXIO";at().load(a);const i=Ti(a),l=(0,n.computed)((()=>Ci(i,["ID_SISTEMAINFORMACIO","ID_TIPUSINTERFICIE","TITLE","ID_TIPUSIMPORTACIO","ID_PROCEDIMENTIMPORTACIO","ID_PERIODEACTUALITZACIO","ID_HISTORIFICACIO",{name:"ID_SISTEMAORIGENDADES",disabled:!0},"NOMARXIUCARREGA","OBSERVACIONS","ALTA","BAIXA"])));return(i,o)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",Zn,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(l),entity:e.entity,validations:e.validations,"cache-name":a,onChange:o[0]||(o[0]=e=>t("change",e.action))},null,8,["fields","entity","validations"])]))}},Qn=(0,I.Z)(Jn,[["__scopeId","data-v-d76d9ba0"]]);function ei(e,t){return{margin:[2,30,40,0],columns:[{text:"CEB. Catàleg de Processos",alignment:"left",width:"25%",margin:[40,0,0,0]},{text:"FITXA DEL SISTEMA",bold:!0,fontSize:14,alignment:"center",width:"*"},{table:{widths:["auto","auto"],body:[[{text:"Pàg. ",alignment:"left",fontSize:8},{text:e+" de "+t,alignment:"right",fontSize:8}],[{text:"Data ",alignment:"left",fontSize:8},{text:qa(),alignment:"right",fontSize:8}]]},layout:"noBorders",width:"63",alignment:"right"}]}}function ti(e){const t=[];if(e.MODELDOCUMENT){const a=e.MODELDOCUMENT;if(a.length>0){for(let e=0;e<a.length;e++)a[e].URL&&"(pendent d'informar)"!==a[e].URL?t.push({text:a[e].Title,link:a[e].URL,style:"link"}):t.push(a[e].Title);return t}return""}return""}const ai={name:"SISTEMAINFORMACIO",type:"listSplitted",label:"Sistemes d'informació",fields:kn,filter:[{name:"CODI",label:"Codi Sistema d'informació conté",operation:"contains"},{name:"TITLE",label:"Nom Sistema d'informació conté",operation:"contains"},{name:"ABAST",operation:"eq"},{name:"ID_PROMOTOR",operation:"in"},{name:"SISTEMAINFORMACIO_ENTORN",operation:"in"},{name:"SISTEMAINFORMACIO_ENTORNTECNOLOGIC",operation:"in"},{name:"SISTEMAINFORMACIO_UNITATDESCRIPCIO",operation:"in"},{name:"ID_CONTROLACCES",operation:"in"},{name:"ID_CONTROLINTEGRITAT",operation:"in"},{name:"INTERFICIECONNEXIO",operation:"in",type:"child",title:"Interfícies càrrega dades",entity:{entityName:"INTERFICIECONNEXIO",primaryKey:"ID",foreignKey:"ID_SISTEMAINFORMACIO",targetKey:"TITLE"}},{name:"VIGENT",operation:"eq"}],form:{component:(0,n.markRaw)(Kn),maxWidth:"1200px",children:[{listName:"EVIDENCIA",foreingKey:"ID_SISTEMA"},{listName:"DADAELEMENTAL_SISTEMA",foreingKey:"ID_SISTEMAINFORMACIO",detailFields:["ID_OBJECTEDADA","ID_TIPUSDADA","ID_DADAELEMENTAL"]},{listName:"SISTEMAINFORMACIO_INDICADOR",foreingKey:"ID_SISTEMA",detailFields:["ID_TIPUSINDICADOR"]},{listName:"INTERFICIECONNEXIO",foreingKey:"ID_SISTEMAINFORMACIO",detailFields:["ID_TIPUSINTERFICIE","ID_TIPUSIMPORTACIO","ID_PERIODEACTUALITZACIO","ID_SISTEMAINFORMACIO"]},{listName:"INTERFICIECONNEXIO",foreingKey:"ID_SISTEMAORIGENDADES",navigationKey:"INTERFICIECONNEXIO1",detailFields:["ID_TIPUSINTERFICIE","ID_TIPUSIMPORTACIO","ID_PERIODEACTUALITZACIO","ID_SISTEMAINFORMACIO"]}],tabs:[{name:"DESCRIPCIO",title:"Descripció",component:"auto",fields:e=>[{name:"DESCRIPCIO",label:" "}]},{name:"FUNCIONALITAT",title:"Funcionalitat",component:"auto",fields:e=>[{name:"FUNCIONALITAT",label:" "}]},{name:"EVIDENCIA",title:"Evidències",type:"child",listName:"EVIDENCIA",fields:["TITLE","CODI","TIPUS","CARACTER"],readonly:!0},{name:"DADAELEMENTAL_SISTEMA",title:"Dades elementals",type:"child",listName:"DADAELEMENTAL_SISTEMA",fields:["ID_OBJECTEDADA","ID_TIPUSDADA","ID_DADAELEMENTAL"],form:{component:(0,n.markRaw)(na),maxWidth:"780px"}},{name:"SISTEMAINFORMACIO_INDICADOR",title:"Indicadors",type:"child",listName:"SISTEMAINFORMACIO_INDICADOR",fields:["TITLE","ID_TIPUSINDICADOR"],form:{component:(0,n.markRaw)(Wn),maxWidth:"870px"}},{name:"INTERFICIECONNEXIO",title:"Interfícies càrrega dades",type:"child",listName:"INTERFICIECONNEXIO",fields:["TITLE","ID_TIPUSINTERFICIE","ID_TIPUSIMPORTACIO","ID_PERIODEACTUALITZACIO"],form:{component:(0,n.markRaw)(Hn),maxWidth:"1110px"}},{name:"SUBMINISTRADADES",title:"Subministra dades a",type:"child",listName:"INTERFICIECONNEXIO",navigationKey:"INTERFICIECONNEXIO1",fields:["TITLE","ID_SISTEMAINFORMACIO"],form:{component:(0,n.markRaw)(Qn),maxWidth:"1110px"}}]},menuUpdater:function(e,t){const a=t?[{text:"Fitxa del sistema",icon:"TextDocument",action:()=>async function(e){$a?.pdfMake&&(Fa.vfs=$a.pdfMake.vfs);const t=[{name:"Sistema",promise:Ne(`SISTEMAINFORMACIO(${e})`,{$select:"CODIINOM,CODI,NOMCURT,TITLE,ABAST,DIALEGCTTI,URL,RESPFUNCIONAL,GESTORTIC,DESCRIPCIO,FUNCIONALITAT",$expand:"TIPUSAGENT($select=TITLE),AGENT($select=CODIINOM),PROVEIDOR($select=TITLE),MODELDESERVEI($select=TITLE),CONTROLACCES($select=TITLE),CONTROLINTEGRITAT($select=TITLE),SISTEMAINFORMACIO_ENTORN($select=ID;$expand=ENTORN($select=TITLE);$orderby=ENTORN/TITLE),SISTEMAINFORMACIO_ENTORNTECNOLOGIC($select=ID;$expand=ENTORNTECNOLOGIC($select=TITLE);$orderby=ENTORNTECNOLOGIC/TITLE),SISTEMAINFORMACIO_UNITATDESCRIPCIO($select=ID;$expand=UNITATDESCRIPCIO($select=TITLE);$orderby=UNITATDESCRIPCIO/TITLE),EVIDENCIA($select=CODI,TITLE,CODIINOM,CARACTER,AUTENTIFICACIO;$expand=AGENT($select=CODIINOM),AGENT1($select=CODIINOM),PROCES($select=CODIINOM),EVIDENCIA_MODELDOCUMENT($select=ID;$expand=MODELDOCUMENT($select=TITLE,URL);$orderby=MODELDOCUMENT/TITLE);$orderby=CODI,TITLE),INTERFICIECONNEXIO($select=TITLE;$expand=TIPUSINTERFICIE($select=TITLE),TIPUSIMPORTACIO($select=TITLE),PROCEDIMENTIMPORTACIO($select=TITLE);$orderby=TITLE),SISTEMAINFORMACIO_INDICADOR($select=TITLE,CONCEPTE,DESCRIPCIO,PERIODICITATMESURA;$orderby=TITLE)"})},{name:"procesos",promise:Ne("PROCES",{$select:"CODI,TITLE, TIPUS,AMBIT",$expand:"FAMILIA($select=TITLE)",$filter:`EVIDENCIA/any(EVIDENCIA:EVIDENCIA/ID_SISTEMA eq ${e})`,$orderby:"CODIINOM"})},{name:"series",promise:Ne("SERIEDOCUMENTAL",{$select:"ID,TITLE,CLASSIFICACIO,CRITERINORMALITZACIO,CARACTER,VITAL",$expand:"AGENT($select=CODIINOM)",$filter:`EVIDENCIA/any(EVIDENCIA:EVIDENCIA/ID_SISTEMA eq ${e})`,$orderby:"TITLE"})},{name:"tracts",promise:Ne("TRACTAMENTDADESPERSONALS",{$select:"TITLE,NIVELLDESEGURETAT",$expand:"AGENT1($select=CODIINOM),DISPOSICIONORMATIVA($select=TITLE)",$filter:`SERIEDOCUMENTAL/any(SERIEDOCUMENTAL:SERIEDOCUMENTAL/ID_PROCES eq ${e})`,$orderby:"TITLE"})},{name:"dades",promise:Ne("DADAELEMENTAL",{$select:"TITLE",$expand:"OBJECTEDADA($select=TITLE),TIPUSDADA($select=TITLE)",$filter:`DADAELEMENTAL_SISTEMA/any(DADAELEMENTAL_SISTEMA:DADAELEMENTAL_SISTEMA/ID_SISTEMAINFORMACIO eq ${e})`,$orderby:"OBJECTEDADA/TITLE,TIPUSDADA/TITLE,TITLE"})}],a=await Promise.all(t.map((e=>e.promise))),n=a[0],i=a[1].value,l=a[2].value,o=a[3].value,r=a[4].value,d={pageOrientation:"landscape",pageMargins:[40,75,40,40],header:ei,styles:{title:{bold:!0,fontSize:14,background:"#0078d7",color:"white",fillColor:"#0078d7"},subtitle:{bold:!0,fontSize:12,background:"#0078d7",color:"white",fillColor:"#0078d7"},sepBlue:{bold:!0,fontSize:2,background:"#0078d7",color:"white",fillColor:"#0078d7"},header:{bold:!0,italics:!0},link:{italics:!0,color:"#54BAE6"}},defaultStyle:{fontSize:10},content:[{layout:"noBorders",table:{widths:["100%"],border:"none",body:[[{text:n.CODIINOM,style:"title",alignment:"center"}],[{text:".",fontSize:8,color:"white"}]]}},{table:{widths:["20%","80%"],body:[[{text:"Abast",italics:!0,bold:!0},{text:n.ABAST||""}],[{text:"Promotor",italics:!0,bold:!0},{text:n.AGENT.CODIINOM||""}],[{text:"Responsable funcional",italics:!0,bold:!0},{text:n.RESPFUNCIONAL||""}],[{text:"Gestor TIC",italics:!0,bold:!0},{text:n.GESTORTIC||""}],[{text:"Entorns",italics:!0,bold:!0},{text:n.SISTEMAINFORMACIO_ENTORN?n.SISTEMAINFORMACIO_ENTORN.map((e=>e.ENTORN.TITLE)).join(", "):""}],[{text:"Tecnologies",italics:!0,bold:!0},{text:n.SISTEMAINFORMACIO_ENTORNTECNOLOGIC?n.SISTEMAINFORMACIO_ENTORNTECNOLOGIC.map((e=>e.ENTORNTECNOLOGIC.TITLE)).join(", "):""}],[{text:"Model de servei",italics:!0,bold:!0},{text:n.MODELDESERVEI?n.MODELDESERVEI.TITLE:""}],[{text:"Proveïdor",italics:!0,bold:!0},{text:n.PROVEIDOR?n.PROVEIDOR.TITLE:""}],[{text:"Unitat de descripció",italics:!0,bold:!0},{text:n.SISTEMAINFORMACIO_UNITATDESCRIPCIO.map((e=>e.UNITATDESCRIPCIO.TITLE)).join(", ")||""}],[{text:"Control d'accés",italics:!0,bold:!0},{text:n.CONTROLACCES?n.CONTROLACCES.TITLE:""}],[{text:"Control d'integritat",italics:!0,bold:!0},{text:n.CONTROLINTEGRITAT?n.CONTROLINTEGRITAT.TITLE:""}],[{text:"Descripció",italics:!0,bold:!0},{text:n.DESCRIPCIO||""}],[{text:"Funcionalitat",italics:!0,bold:!0},{text:n.FUNCIONALITAT||""}]]}},{layout:"noBorders",table:{widths:["100%"],body:[[{text:".",fontSize:24,color:"white"}],[{text:"PROCESSOS ON INTERVÉ EL SISTEMA D'INFORMACIÓ",style:"title"}],[{text:".",fontSize:6,color:"white"}]]}},{style:"taula",headerRows:1,table:{widths:["8%","42%","8%","10%","32%"],body:[[{text:"Codi",style:"header"},{text:"Nom del procés",style:"header"},{text:"Tipus",style:"header"},{text:"Àmbit",style:"header"},{text:"Família",style:"header"}],...i.map((e=>[e.CODI||"",e.TITLE||"",e.TIPUS||"",e.AMBIT||"",e.FAMILIA?e.FAMILIA.TITLE:""]))]}},{layout:"noBorders",table:{widths:["100%"],body:[[{text:".",fontSize:24,color:"white"}],[{text:"INDICADOR DEL SISTEMA D'INFORMACIÓ",style:"title"}],[{text:".",fontSize:6,color:"white"}]]}},{style:"taula",headerRows:1,table:{widths:["25%","50%","25%"],body:[[{text:"Nom",style:"header"},{text:"Descripció",style:"header"},{text:"Periodicitat",style:"header"}],...n.SISTEMAINFORMACIO_INDICADOR.map((e=>[e.TITLE||"",e.DESCRIPCIO||"",e.PERIODICITATMESURA||""]))]}},{layout:"noBorders",table:{widths:["100%"],body:[[{text:".",fontSize:24,color:"white"}],[{text:"SISTEMES D'INFORMACIÓ RELACIONATS",style:"title"}],[{text:".",fontSize:6,color:"white"}]]}},{style:"taula",table:{headerRows:1,keepWithHeaderRows:1,widths:["50%","25%","25%"],body:[[{text:"Interfície",style:"header"},{text:"Tipus d'importació",style:"header"},{text:"Tipus d'interfície",style:"header"}],...n.INTERFICIECONNEXIO.map((e=>[e.TITLE||"",e.TIPUSIMPORTACIO?e.TIPUSIMPORTACIO.TITLE:"",e.TIPUSINTERFICIE?e.TIPUSINTERFICIE.TITLE:""]))]}},{layout:"noBorders",table:{widths:["100%"],body:[[{text:".",fontSize:24,color:"white"}],[{text:"DOCUMENTS DEL SISTEMA D'INFORMACIÓ",style:"title"}],[{text:".",fontSize:6,color:"white"}]]}},{style:"taula",headerRows:1,dontBreakRows:!0,table:{widths:["6%","34%","7%","6%","6%","12%","6%","23%"],body:[[{text:"Codi",style:"header"},{text:"Títol",style:"header"},{text:"Tipus",style:"header"},{text:"Caràcter",style:"header"},{text:"Format",style:"header"},{text:"Autentificació",style:"header"},{text:"Essencial",style:"header"},{text:"Model document",style:"header"}],...a[0].EVIDENCIA.map((e=>[e.CODI||"",e.TITLE||"",e.TIPUS||"",e.CARACTER||"",e.FORMAT__TEXT||"",e.AUTENTIFICACIO||"",{text:e.ESSENCIAL?"Sí":"No",alignment:"center"},ti(e)]))]}},{layout:"noBorders",table:{widths:["100%"],body:[[{text:".",fontSize:24,color:"white"}],[{text:"SÈRIES DOCUMENTALS RELACIONADES AMB EL SISTEMA D'INFORMACIÓ",style:"title"}],[{text:".",fontSize:6,color:"white"}]]}},{style:"taula",headerRows:1,table:{widths:["35%","25%","25%","10%","5%"],body:[[{text:"Productor",style:"header"},{text:"Classificació",style:"header"},{text:"Normalització",style:"header"},{text:"Caràcter",style:"header"},{text:"Vital",style:"header",alignment:"center"}],...l.map((e=>[e.AGENT?e.AGENT.CODIINOM:"",e.CLASSIFICACIO||"",e.CRITERINORMALITZACIO||"",e.CARACTER||"",{text:l.VITAL?"Sí":"",alignment:"center"}]))]}},{layout:"noBorders",table:{widths:["100%"],body:[[{text:".",fontSize:24,color:"white"}],[{text:"TRACTAMENTS RGPD RELACIONATS AMB EL SISTEMA",style:"title"}],[{text:".",fontSize:6,color:"white"}]]}},{style:"taula",headerRows:1,table:{widths:["32%","19%","4%","45%"],body:[[{text:"Nom",style:"header"},{text:"Responsable",style:"header"},{text:"Nivell",style:"header"},{text:"Ordre declaració DOGC",style:"header"}],...o.map((e=>[e.TITLE||"",e.AGENT?e.AGENT.CODIINOM:"",e.NIVELLDESEGURETAT||"",e.DISPOSICIONORMATIVA?e.DISPOSICIONORMATIVA.TITLE:""]))]}},{layout:"noBorders",table:{widths:["100%"],body:[[{text:".",fontSize:24,color:"white"}],[{text:"DADES DEL SISTEMA D'INFORMACIÓ",style:"title"}],[{text:".",fontSize:6,color:"white"}]]}},{style:"taula",headerRows:1,table:{widths:["15%","10%","10%","55%","10%"],body:[[{text:"Dada",style:"header"},{text:"Tipus",style:"header"},{text:"Objecte",style:"header"},{text:"Valors controlats",style:"header"},{text:"Nivell RGPD",style:"header"}],...r.map((e=>[e.TITLE||"",e.TIPUSDADA__TEXT||"",e.OBJECTEDADA__TEXT||"",e.DESCRIPCIO||"",e.NIVELLDESEGURETAT||""]))]}}]};await new Promise((e=>{Fa.createPdf(d).download("sistema.pdf")}))}(t.ID)}]:[];return e.concat(a)}},ni=[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Indicador",type:"string",required:!0,maxlength:80},{name:"ID_TIPUSINDICADOR",label:"Tipus Indicador",type:"dictionary",entityName:"TIPUSINDICADOR",required:!0},{name:"ID_SISTEMA",label:"Codi i nom sistema d'informació",type:"lookup",entity:{name:"SISTEMAINFORMACIO",primaryKey:"ID",targetKey:"CODIINOM"},required:!0},{name:"CONCEPTE",label:"Concepte",type:"string",maxlength:8e3,multiline:!0},{name:"DESCRIPCIO",label:"Descripció",type:"string",maxlength:8e3,multiline:!0},{name:"FORMULADECALCUL",label:"Fórmula de càlcul",type:"string",maxlength:8e3,multiline:!0},{name:"PERIODICITATMESURA",label:"Periodicitat mesura",type:"string",maxlength:80},{name:"ALTA",label:"Data vigència",type:"date",defaultValue:()=>new Date(Date.now())},{name:"BAIXA",label:"Data baixa",type:"date",defaultValue:()=>new Date(2099,11,31)},{name:"CREATED",type:"date"},{name:"CREATEDBY",type:"string",maxlength:64},{name:"MODIFIED",type:"date"},{name:"MODIFIEDBY",type:"string",maxlength:64}],ii={class:"SISTEMAINFORMACIO_INDICADOR-edit-layout"},li={__name:"form-indicador-sistema",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e){const t=e,a=Ci(Ti((0,o.entityDefinition)(t.entity).entityName),["ID_SISTEMA","ID_TIPUSINDICADOR","TITLE","PERIODICITATMESURA","CONCEPTE","DESCRIPCIO","FORMULADECALCUL"]);return(t,i)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",ii,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(a),entity:e.entity,validations:e.validations,"cache-name":"entityName",onChange:i[0]||(i[0]=e=>t.$emit("change",e.action))},null,8,["fields","entity","validations"])]))}},oi=(0,I.Z)(li,[["__scopeId","data-v-70edc4b0"]]),ri={name:"SISTEMAINFORMACIO_INDICADOR",type:"listSplitted",label:"Indicadors sistemes d'informació",fields:ni,filter:[{name:"ID_SISTEMA",operation:"in"},{name:"TITLE",operation:"contains"},{name:"ID_TIPUSINDICADOR",operation:"in"}],form:{component:(0,n.markRaw)(oi),rules:[async e=>await gt("SISTEMAINFORMACIO_INDICADOR",e,["ID_SISTEMAINFORMACIO","TITLE"],"and")]}},di={class:"TASCA-editItem-layout"},si={style:{"margin-top":"4px","grid-area":"errorMessage"}},ui={__name:"form-tasca",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,i=(0,o.entityDefinition)(a.entity).entityName;at().load(i);const l=Ti(i),r=(0,n.computed)((()=>Ci(l,[{name:"ID_PROCES",disabled:!!a.entity.ID},"CODI",{name:"TITLE",onChange:d},"ID_FORMABPMN","NOMCURT","ID_TIPUSAGENT",{name:"ID_AGENT",type:"lookup",filter:`ID_TIPUSAGENT eq ${a.entity.ID_TIPUSAGENT||0}`},"ID_TIPUSTASCA",{name:"TASCA_PRECEDENT",required:1!==a.entity.ID_FORMABPMN,disabled:1===a.entity.ID_FORMABPMN,type:"lookupMulti",junction:{name:"TASCA_PRECEDENT",primaryKey:"ID",ownerKey:"ID_TASCA",targetKey:"ID_TASCA_PRECEDENT"},data:{name:"TASCA",primaryKey:"ID",targetKey:"CODIINOM",filter:`ID_PROCES eq ${a.entity.ID_PROCES||0}`},clearValueOnDisabled:!0},{name:"LINKTITLE",disabled:1===a.entity.ID_FORMABPMN,clearValueOnDisabled:!0},{name:"TASCA_EVIDENCIAENTRADA",data:{name:"EVIDENCIA",primaryKey:"ID",targetKey:"CODIINOM",filter:`ID_PROCES eq ${a.entity.ID_PROCES||0}`}},{name:"TASCA_EVIDENCIASORTIDA",data:{name:"EVIDENCIA",primaryKey:"ID",targetKey:"CODIINOM",filter:`ID_PROCES eq ${a.entity.ID_PROCES||0}`}},"DESCRIPCIO",{name:"ID_PROCES",type:"hidden"}])));function d(e){t("change",(e=>{e.NOMCURT=e.TITLE}))}const{errorMessage:s}=a.validations.createValidation("generals",{rules:Aa});return(a,l)=>{const o=(0,n.resolveComponent)("fura-message-bar");return(0,n.openBlock)(),(0,n.createElementBlock)("div",di,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(r),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(i),onChange:l[0]||(l[0]=e=>t("change",e.action))},null,8,["fields","entity","validations","cache-name"]),(0,n.createElementVNode)("div",si,[(0,n.unref)(s)?((0,n.openBlock)(),(0,n.createBlock)(o,{key:0,type:"error",singleline:""},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(s)),1)])),_:1})):(0,n.createCommentVNode)("v-if",!0)])])}}},ci=(0,I.Z)(ui,[["__scopeId","data-v-716e3aa4"]]),mi={name:"TASCA",type:"listSplitted",label:"Tasques",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Tasca",type:"string",required:!0,maxlength:120},{name:"ID_PROCES",label:"Codi i nom procés",type:"lookupCache",entity:{name:"PROCES",primaryKey:"ID",targetKey:"CODIINOM"},required:!0,loadAlwaysInView:!0},{name:"CODI",label:"Codi",type:"string",required:!0,maxlength:12},{name:"NOMCURT",label:"Nom en el diagrama",type:"string",required:!0,maxlength:32},{name:"ID_TIPUSTASCA",label:"Tipus",type:"dictionary",entityName:"TIPUSTASCA",required:!0,useFilter:e=>t=>e.ID_FORMABPMN&&t.TIPUSTASCA_FORMABPMN.some((t=>t.ID_FORMABPMN===e.ID_FORMABPMN))},{name:"ID_TIPUSAGENT",label:"Tipus d'agent",type:"dictionary",entityName:"TIPUSAGENT",required:!0},{name:"ID_AGENT",label:"Codi i Nom Agent",type:"lookupCache",entity:{name:"AGENT",primaryKey:"ID",targetKey:"CODIINOM",cache:["ID_TIPUSAGENT"]},required:!0,useFilter:e=>t=>e.ID_TIPUSAGENT&&t.ID_TIPUSAGENT===e.ID_TIPUSAGENT},{name:"LINKTITLE",label:"Texti enllaç",type:"string",maxlength:40},{name:"ID_FORMABPMN",label:"Forma en el diagrama",type:"dictionary",entityName:"FORMA_BPMN",required:!0},{name:"DESCRIPCIO",label:"Descripció",type:"string",maxlength:8e3,multiline:!0},{name:"CODIINOM",label:"Codi i Nom tasca",type:"string",readonly:!0},{name:"TASCA_PRECEDENT",label:"Codi i nom tasques precedents",type:"lookupMultiCache",junction:{name:"TASCA_PRECEDENT",primaryKey:"ID",ownerKey:"ID_TASCA",targetKey:"ID_TASCA_PRECEDENT"},data:{name:"TASCA",primaryKey:"ID",targetKey:"CODIINOM",cache:["ID_PROCES"]},useFilter:e=>t=>e.ID_PROCES&&t.ID_PROCES===e.ID_PROCES},{name:"TASCA_EVIDENCIAENTRADA",label:"Codi i nom evidències d'entrada",type:"lookupMulti",junction:{name:"TASCA_EVIDENCIAENTRADA",primaryKey:"ID",ownerKey:"ID_TASCA",targetKey:"ID_EVIDENCIA"},data:{name:"EVIDENCIA",primaryKey:"ID",targetKey:"CODIINOM"}},{name:"TASCA_EVIDENCIASORTIDA",label:"Codi i nom evidències de sortida",type:"lookupMulti",junction:{name:"TASCA_EVIDENCIASORTIDA",primaryKey:"ID",ownerKey:"ID_TASCA",targetKey:"ID_EVIDENCIA"},data:{name:"EVIDENCIA",primaryKey:"ID",targetKey:"CODIINOM"}},{name:"CREATED",type:"date"},{name:"CREATEDBY",type:"string",maxlength:64},{name:"MODIFIED",type:"date"},{name:"MODIFIEDBY",type:"string",maxlength:64}],filter:[{name:"ID_PROCES",label:"Codi i/o nom procés contenen",operation:"contains"},{name:"CODI",label:"Codi tasca conté",operation:"contains"},{name:"TITLE",label:"Nom tasca conté",operation:"contains"},{name:"ID_TIPUSAGENT",operation:"in"},{name:"ID_AGENT",operation:"in"},{name:"TASCA_EVIDENCIAENTRADA",operation:"in"},{name:"TASCA_EVIDENCIASORTIDA",operation:"in"}],form:{component:(0,n.markRaw)(ci),maxWidth:"1080px"},menuUpdater:function(e,t){const a=t?[{text:"Fitxa procés",icon:"TextDocument",action:()=>Ka(t.ID_PROCES)},{text:"Guia procediment",icon:"TextDocumentSettings",action:()=>Ga(t.ID_PROCES)},{}]:[];return e.concat(a)}},pi=[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Fitxer",type:"string",required:!0,maxlength:255},{name:"ID_DISPOSICIONORMATIVA",label:"Ordre declaració DOGC",type:"lookupCache",entity:{name:"DISPOSICIONORMATIVA",primaryKey:"ID",targetKey:"TITLE"}},{name:"FINALITAT",label:"Finalitat",type:"string",required:!0,maxlength:255},{name:"PERSONESAFECTADES",label:"Interessats",type:"string",maxlength:255},{name:"CESSIONSDEDADES",label:"Cessió de dades",type:"string",maxlength:255},{name:"RECOLLIDADEDADES",label:"Recollida de dades",type:"choice",options:["Manual","Semiautomàtica","Automàtica"],required:!0,maxlength:80},{name:"ID_TIPUSPROCEDENCIA",label:"Tipus procedència",type:"lookupCache",entity:{name:"TIPUSAGENT",primaryKey:"ID",targetKey:"TITLE"},required:!0},{name:"ID_PROCEDENCIA",label:"Codi i nom procedència",type:"lookupCache",entity:{name:"AGENT",navigationKey:"AGENT2",primaryKey:"ID",targetKey:"CODIINOM",cache:["ID_TIPUSAGENT"]},useFilter:e=>t=>e.ID_TIPUSPROCEDENCIA&&t.ID_TIPUSAGENT===e.ID_TIPUSPROCEDENCIA},{name:"ID_TIPUSRESPONSABLE",label:"Tipus responsable",type:"lookupCache",entity:{name:"TIPUSAGENT",navigationKey:"TIPUSAGENT1",primaryKey:"ID",targetKey:"TITLE"}},{name:"ID_RESPONSABLE",label:"Codi i nom responsable",type:"lookupCache",entity:{name:"AGENT",navigationKey:"AGENT",primaryKey:"ID",targetKey:"CODIINOM",cache:["ID_TIPUSAGENT"]},useFilter:e=>t=>e.ID_TIPUSRESPONSABLE&&t.ID_TIPUSAGENT===e.ID_TIPUSRESPONSABLE},{name:"ID_TIPUSRESPONSABLEARCO",label:"Tipus resp. ARCO",type:"lookupCache",entity:{name:"TIPUSAGENT",navigationKey:"TIPUSAGENT2",primaryKey:"ID",targetKey:"TITLE"}},{name:"ID_RESPONSABLEARCO",label:"Responsable d’atendre els drets ARCO",type:"lookupCache",entity:{name:"AGENT",navigationKey:"AGENT1",primaryKey:"ID",targetKey:"CODIINOM",cache:["ID_TIPUSAGENT"]},useFilter:e=>t=>e.ID_TIPUSRESPONSABLEARCO&&t.ID_TIPUSAGENT===e.ID_TIPUSRESPONSABLEARCO},{name:"SISTEMATRACTAMENT",label:"Sistema de tractament",type:"choice",options:["Automatitzat","No automatitzat","Parcialment automatitzat"],required:!0,maxlength:80},{name:"CESSIONSDEDADES",label:"Comunicacions de dades",type:"string",maxlength:255},{name:"TRANSFERENCIESINT",label:"Transferències internacionals",type:"string",maxlength:80},{name:"NIVELLDESEGURETAT",label:"N.Seguretat",type:"choice",options:["Bàsic","Mitjà","Alt"],maxlength:80},{name:"MESURESDESEGURETAT",label:"Mesures de seguretat",type:"string",required:!0,maxlength:255},{name:"ALTA",label:"Data alta",type:"date",defaultValue:()=>new Date(Date.now())},{name:"BAIXA",label:"Data de baixa",type:"date",defaultValue:()=>new Date(2099,11,31)},{name:"CREATED",type:"date"},{name:"CREATEDBY",type:"string",maxlength:64},{name:"MODIFIED",type:"date"},{name:"MODIFIEDBY",type:"string",maxlength:64},{name:"VIGENT",label:"Vigent",type:"boolean",readonly:!0}],yi={class:"SERIEDOCUMENTAL-edit-layout"},Ii={style:{"margin-top":"4px","grid-area":"errorMessage"}},fi={__name:"form-serie-documental",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e){const t=e,a=Ti((0,o.entityDefinition)(t.entity).entityName),i=(0,n.reactive)(Ci(a,["ID_PROCES","CODI","TITLE","DIGITAL","VITAL","CLASSIFICACIO","TITOLCORPORATIU","CARACTER","ID_TIPUSPRODUCTOR","ID_PRODUCTOR","CRITERINORMALITZACIO","ALTA","BAIXA"])),{errorMessage:l}=t.validations.createValidation("generals",{rules:[e=>"number"==typeof t.entity.state.data.ID&&e.SERIEDOCUMENTAL_DEPENDE&&e.SERIEDOCUMENTAL_DEPENDE.includes(t.entity.state.data.ID)&&"Una SERIEDOCUMENTAL no pot tenir com a SERIEDOCUMENTAL precedent a sí mateixa."]});return(t,a)=>{const o=(0,n.resolveComponent)("fura-message-bar");return(0,n.openBlock)(),(0,n.createElementBlock)("div",yi,[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:i,entity:e.entity,validations:e.validations,"cache-name":"entityName",onChange:a[0]||(a[0]=e=>t.$emit("change",e.action))},null,8,["fields","entity","validations"]),(0,n.createElementVNode)("div",Ii,[(0,n.unref)(l)?((0,n.openBlock)(),(0,n.createBlock)(o,{key:0,type:"error",singleline:""},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(l)),1)])),_:1})):(0,n.createCommentVNode)("v-if",!0)])])}}},Ei=(0,I.Z)(fi,[["__scopeId","data-v-e063cd36"]]),Ai=[{name:"CLASSIFICACIOENS",type:"dictionary",label:"Classificació Ens",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Classificació Ens",type:"string",defaultField:!0,required:!0,maxlength:40}]},{name:"CONTROLACCES",type:"dictionary",label:"Controls d'accès",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Control d'accès",type:"string",defaultField:!0,required:!0,maxlength:40}]},{name:"CONTROLINTEGRITAT",type:"dictionary",label:"Controls d'integritat",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Control d'integritat",type:"string",defaultField:!0,required:!0,maxlength:40}]},{name:"DIPOSITDESTI",type:"dictionary",label:"Dipósits de destí",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Dipósit de destí",type:"string",defaultField:!0,required:!0,maxlength:40}]},{name:"ENTORN",type:"dictionary",label:"Entorns",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Entorn",type:"string",defaultField:!0,required:!0,maxlength:40}]},{name:"ENTORNTECNOLOGIC",type:"dictionary",label:"Entorns tecnológics",paginated:!0,fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Entorns tecnológics",type:"string",defaultField:!0,required:!0,maxlength:40}]},{name:"FAMILIA",type:"dictionary",label:"Famílies",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Família",type:"string",defaultField:!0,required:!0,maxlength:40}]},{name:"FAMILIAOPAE",type:"dictionary",label:"Famílies OPAE",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Família OPAE",type:"string",defaultField:!0,required:!0,maxlength:40}]},{name:"FORMAT",type:"dictionary",label:"Formats",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Format document o arxiu",type:"string",defaultField:!0,required:!0,maxlength:40}]},{name:"FORMA_BPMN",type:"dictionary",label:"Formes BPMN",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Forma BPMN",type:"string",defaultField:!0,required:!0,maxlength:36}]},{name:"HISTORIFICACIO",type:"dictionary",label:"Historificació",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Historificació",type:"string",defaultField:!0,required:!0,maxlength:80}]},{name:"MODELDESERVEI",type:"dictionary",label:"Models de servei",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Model de servei",type:"string",defaultField:!0,required:!0,maxlength:40}]},{name:"MOTIULIMITACIO",type:"dictionary",label:"Motius de limitació",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Motiu de limitació",type:"string",defaultField:!0,required:!0,maxlength:40}]},ma,{name:"PERIODEACTUALITZACIO",type:"dictionary",label:"Període d'actualització",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Període d'actualització",type:"string",defaultField:!0,required:!0,maxlength:80}]},{name:"PROCEDIMENTIMPORTACIO",type:"dictionary",label:"Procediments d'importació",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Procediment d'importació",type:"string",defaultField:!0,required:!0,maxlength:80}]},{name:"PROVEIDOR",type:"dictionary",label:"Proveïdors",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Proveïdor",type:"string",defaultField:!0,required:!0,maxlength:40},{name:"LOT",label:"LOT assignat",type:"string",maxlength:8}]},{name:"TIPUSAGENT",type:"dictionary",label:"Tipus d'agents",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Tipus d'agent",type:"string",defaultField:!0,required:!0,maxlength:40}]},{name:"TIPUSDADA",type:"dictionary",label:"Tipus de dades",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Tipus de dada",type:"string",defaultField:!0,required:!0,maxlength:40}]},{name:"TIPUSFINALITZACIO",type:"dictionary",label:"Tipus de finalització del procés",paginated:!0,fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Tipus de finalització",type:"string",defaultField:!0,required:!0,maxlength:255}]},{name:"TIPUSIMPORTACIO",type:"dictionary",label:"Tipus d'Importació",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Tipus d'importació",type:"string",defaultField:!0,required:!0,maxlength:40}]},{name:"TIPUSINDICADOR",type:"dictionary",label:"Tipus d'Indicador",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Tipus d'indicador",type:"string",defaultField:!0,required:!0,maxlength:40}]},{name:"TIPUSINICIACIO",type:"dictionary",label:"Tipus d'iniciació del procés",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Tipus d'iniciació",type:"string",defaultField:!0,required:!0,maxlength:40}]},{name:"TIPUSINTERFICIE",type:"dictionary",label:"Tipus d'Interfícies de connexió entre sistemes",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Tipus d'interfície de connexió",type:"string",defaultField:!0,required:!0,maxlength:40}]},{name:"TIPUSMODELDOCUMENT",type:"dictionary",label:"Tipus de models de documents",paginated:!0,fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Tipus de model de document",type:"string",defaultField:!0,required:!0,maxlength:40}]},{name:"TIPUSQUADRE",type:"dictionary",label:"Tipus Quadre de comandament",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Tipus quadre comandament",type:"string",defaultField:!0,required:!0,maxlength:40}]},{name:"TIPUSRECURSPROCES",type:"dictionary",label:"Tipus de recurs del procés",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Tipus de recurs del procés",type:"string",defaultField:!0,required:!0,maxlength:40}]},{name:"TIPUSRELACIOPROCES",type:"dictionary",label:"Tipus de relació entre processos",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Tipus de relació entre processos",type:"string",defaultField:!0,required:!0,maxlength:40}]},{name:"TIPUSTASCA",type:"dictionary",label:"Tipus de tasques",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Tipus de tasca",type:"string",defaultField:!0,required:!0,maxlength:40},{name:"FORMA_BPMN",label:"Forma en el diagrama",type:"dictionaryMulti",entityName:"FORMA_BPMN",junction:{name:"TIPUSTASCA_FORMABPMN",primaryKey:"ID",ownerKey:"ID_TIPUSTASCA",dictionaryKey:"ID_FORMABPMN"}}]},{name:"UNITATDESCRIPCIO",type:"dictionary",label:"Unitats de descripció",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Unitat de descripció",type:"string",defaultField:!0,required:!0,maxlength:40}]},ht,xt,qt,ia,ua,ca,en,tn,dn,pn,An,Un,ai,ri,mi,{name:"TRACTAMENTDADESPERSONALS",type:"listSplitted",label:"Tractament de dades personals",fields:pi,filter:[{name:"TITLE",operation:"contains"},{name:"SISTEMATRACTAMENT",operation:"eq"},{name:"NIVELLDESEGURETAT",operation:"eq"},{name:"SERIES",operation:"in"},{name:"VIGENT",operation:"eq"}],form:{component:"auto",class:"TRACTAMENTDADESPERSONALS-editItem-layout",maxWidth:"1110px",fields:e=>["TITLE","ID_DISPOSICIONORMATIVA","ID_TIPUSPROCEDENCIA","ID_PROCEDENCIA","NIVELLDESEGURETAT","RECOLLIDADEDADES","SISTEMATRACTAMENT","ID_TIPUSRESPONSABLE","ID_RESPONSABLE","PERSONESAFECTADES","ID_TIPUSRESPONSABLEARCO","ID_RESPONSABLEARCO","FINALITAT","CESSIONSDEDADES","TRANSFERENCIESINT","MESURESDESEGURETAT","ALTA","BAIXA"],children:[{listName:"DADAELEMENTAL_TRACTAMENT",foreingKey:"ID_TRACTAMENTDADESPERSONALS",detailFields:["ID_OBJECTEDADA","ID_TIPUSDADA","ID_DADAELEMENTAL"]},{listName:"SERIEDOCUMENTAL",foreingKey:"ID_TRACTAMENTDADESPERSONALS",detailFields:["ID_PROCES"]}],tabs:[{name:"SERIEDOCUMENTAL",title:"Sèries documentals",type:"child",listName:"SERIEDOCUMENTAL",fields:["ID_PROCES","CODI","TITLE"],form:{component:(0,n.markRaw)(Ei),maxWidth:"1110px"}},{name:"DADAELEMENTAL_TRACTAMENT",title:"Dades elementals",type:"child",listName:"DADAELEMENTAL_TRACTAMENT",fields:["ID_OBJECTEDADA","ID_TIPUSDADA","ID_DADAELEMENTAL"],form:{component:(0,n.markRaw)(na),maxWidth:"780px"}}],rules:[async e=>await gt("TRACTAMENTDADESPERSONALS",e,["TITLE"],"or")]},permissionDenied:e=>({create:!1,edit:!1,delete:e&&0!==e["SERIEDOCUMENTAL@odata.count"],export:!1})},{name:"USUARI",type:"listSplitted",label:"Usuaris actius",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Cognoms i nom",type:"string",required:!0,maxlength:80},{name:"ID_TIPUSAGENT",label:"Pertany a",type:"dictionary",entityName:"TIPUSAGENT",required:!0},{name:"ID_AGENT",label:"Unitat",type:"lookupCache",entity:{name:"AGENT",primaryKey:"ID",targetKey:"CODIINOM"},required:!0},{name:"ALTA",label:"Data alta",type:"date",defaultValue:()=>new Date(Date.now())},{name:"BAIXA",label:"Data de baixa",type:"date",defaultValue:()=>new Date(2099,11,31)},{name:"CREATED",type:"date"},{name:"CREATEDBY",type:"string",maxlength:64},{name:"MODIFIED",type:"date"},{name:"MODIFIEDBY",type:"string",maxlength:64}],filter:[{name:"TITLE",label:"Cognoms i/o nom de l'usuari conté",operation:"contains"},{name:"ID_TIPUSAGENT",operation:"in"},{name:"ID_AGENT",operation:"in"}],form:{component:"auto",class:"USUARI-editItem-layout",maxWidth:"900px",fields:e=>["TITLE","ID_TIPUSAGENT","ID_AGENT","ALTA","BAIXA"],rules:[async e=>await gt("USUARI",e,["TITLE"],"or")]}},{name:"USUARI_CATALEG",type:"listSplitted",label:"Usuaris del sistema",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"LOGIN_USUARI",label:"Usuari",type:"string",required:!0,maxlength:16},{name:"COGNOMSINOM_USUARI",label:"Cognoms i nom",type:"string",required:!0,maxlength:80},{name:"EMAIL_USUARI",label:"Email usuari",type:"string",pattern:/^(([^<>()[\].,;:\s@"]+(\.[^<>()[\].,;:\s@"]+)*)|(".+"))@(([^<>()[\].,;:\s@"]+\.)+[^<>()[\].,;:\s@"]{2,})$/,required:!0,maxlength:80},{name:"ROL",label:"Rol",type:"choice",options:["Administrador","Usuari"],dataType:"string",required:!0,defaultValue:"Usuari"},{name:"CREATED",type:"date"},{name:"CREATEDBY",type:"string",maxlength:64},{name:"MODIFIED",type:"date"},{name:"MODIFIEDBY",type:"string",maxlength:64}],form:{component:"auto",class:"USUARI-CATALEG-editItem-layout",maxWidth:"900px",fields:e=>["LOGIN_USUARI","COGNOMSINOM_USUARI","ROL","EMAIL_USUARI"],rules:[async e=>await gt("USUARI_CATALEG",e,["LOGIN_USUARI","COGNOMSINOM_USUARI","EMAIL_USUARI"],"or")]}},{name:"PROCES_PROCES",label:"Relació entre processos",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"ID_PROCES",label:"Procés",type:"lookup",entity:{name:"PROCES",primaryKey:"ID",targetKey:"CODIINOM"},required:!0},{name:"ID_RELACIONATAMB",label:"Relacionat amb",type:"lookup",entity:{name:"PROCES",navigationKey:"PROCES1",primaryKey:"ID",targetKey:"CODIINOM"},required:!0},{name:"ID_TIPUSRELACIO",label:"Tipus de relació",type:"dictionary",entityName:"TIPUSRELACIOPROCES",required:!0},{name:"OBS",label:"Observacions",type:"string",maxlength:80}]},{name:"SERIEDOCUMENTAL_SERIEDOCUMENTAL",label:"Relació entre Sèries documentals",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"ID_SERIEDOCUMENTAL",label:"Sèrie Documental",type:"lookup",required:!0,entity:{name:"SERIEDOCUMENTAL",primaryKey:"ID",targetKey:"CODIINOM"}},{name:"ID_RELACIONADAAMB",label:"Relacionada amb",type:"lookup",required:!0,entity:{name:"SERIEDOCUMENTAL",primaryKey:"ID",targetKey:"CODIINOM",cache:["ID_PROCES"]}},{name:"TIPUSRELACIO",label:"Tipus de relació",type:"choice",options:["Antecedent","Conseqüent","Relacionada","Recapitulativa"],required:!0,maxlength:24}]},{name:"SISTEMAINFORMACIO_SISTEMAINFORMACIO",label:"Relacions entre Sistemes d'informació",fields:[{name:"ID",type:"number",primary:!0,required:!0,readonly:!0},{name:"ID_SISTEMA",label:"Sistema",type:"lookupCache",entity:{name:"SISTEMAINFORMACIO",primaryKey:"ID",targetKey:"CODIINOM"},required:!0},{name:"ID_RELACIONATAMB",label:"Relacionat amb",type:"lookupCache",entity:{name:"SISTEMAINFORMACIO",navigationKey:"SISTEMAINFORMACIO1",primaryKey:"ID",targetKey:"CODIINOM"},required:!0},{name:"ID_TIPUSINTERFICIE",label:"Interície de connexió",type:"lookupCache",entity:{name:"TIPUSINTERFICIE",primaryKey:"ID",targetKey:"TITLE"},required:!0}]},{name:"DADAELEMENTAL_EVIDENCIA",type:"listSplitted",label:"Dades de les evidències",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"ID_PROCES",label:"Procés",type:"lookupCache",entity:{name:"PROCES",primaryKey:"ID",targetKey:"CODIINOM"},required:!0},{name:"ID_EVIDENCIA",label:"Evidència",type:"lookupCache",entity:{name:"EVIDENCIA",primaryKey:"ID",targetKey:"CODIINOM",cache:["ID_PROCES"]},userFilter:e=>t=>t.ID_PROCES===e.ID_PROCES,required:!0},{name:"ID_TIPUSDADA",label:"Tipus de dada",type:"dictionary",entityName:"TIPUSDADA",required:!0},{name:"ID_OBJECTEDADA",label:"Objecte de la dada",type:"lookupCache",entity:{name:"OBJECTEDADA",primaryKey:"ID",targetKey:"TITLE"},required:!0},{name:"CARACTER_VARIABLE",label:"Caràcter variable",type:"choice",options:["Autòctona","Importada","Importada emplenada","Importada en blanc"],required:!0,maxlength:24},{name:"ID_DADAELEMENTAL",label:"Dada elemental",type:"lookupCache",entity:{name:"DADAELEMENTAL",primaryKey:"ID",targetKey:"TITLE",cache:["ID_OBJECTEDADA","ID_TIPUSDADA"]},required:!0}]},{name:"DADAELEMENTAL_INTERFICIECONNEXIO",type:"listSplitted",label:"Dades de la interfície de connexió",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"ID_INTERFICIECONNEXIO",label:"Interfície de connexió",type:"lookupCache",entity:{name:"INTERFICIECONNEXIO",primaryKey:"ID",targetKey:"TITLE"},required:!0},{name:"ID_TIPUSDADA",label:"Tipus de dada",type:"dictionary",entityName:"TIPUSDADA",required:!0},{name:"ID_OBJECTEDADA",label:"Objecte de la dada",type:"lookupCache",entity:{name:"OBJECTEDADA",primaryKey:"ID",targetKey:"TITLE"},required:!0},{name:"ID_DADAELEMENTAL",label:"Dada elemental",type:"lookupCache",entity:{name:"DADAELEMENTAL",primaryKey:"ID",targetKey:"TITLE",cache:["ID_OBJECTEDADA","ID_TIPUSDADA"]},required:!0}]},{name:"DADAELEMENTAL_QUADRECOMANDAMENT",type:"listSplitted",label:"Dades del quadre de comandament",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"ID_QUADRECOMANDAMENT",label:"Quadres de comandament",type:"lookupCache",entity:{name:"QUADRECOMANDAMENT",primaryKey:"ID",targetKey:"TITLE"},required:!0},{name:"ID_TIPUSDADA",label:"Tipus de dada",type:"dictionary",entityName:"TIPUSDADA",required:!0},{name:"ID_OBJECTEDADA",label:"Objecte de la dada",type:"lookupCache",entity:{name:"OBJECTEDADA",primaryKey:"ID",targetKey:"TITLE"},required:!0},{name:"ID_DADAELEMENTAL",label:"Dada elemental",type:"lookupCache",entity:{name:"DADAELEMENTAL",primaryKey:"ID",targetKey:"TITLE",cache:["ID_TIPUSDADA","ID_OBJECTEDADA"]},required:!0}]},{name:"DADAELEMENTAL_SISTEMA",type:"listSplitted",label:"Dades dels sistemes d'informació",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"ID_SISTEMAINFORMACIO",label:"Sistema informació",type:"lookupCache",entity:{name:"SISTEMAINFORMACIO",primaryKey:"ID",targetKey:"CODIINOM"},required:!0},{name:"ID_TIPUSDADA",label:"Tipus de dada",type:"dictionary",entityName:"TIPUSDADA",required:!0},{name:"ID_OBJECTEDADA",label:"Objecte de la dada",type:"lookupCache",entity:{name:"OBJECTEDADA",primaryKey:"ID",targetKey:"TITLE"},required:!0},{name:"ID_DADAELEMENTAL",label:"Dada elemental",type:"lookupCache",entity:{name:"DADAELEMENTAL",primaryKey:"ID",targetKey:"TITLE",cache:["ID_OBJECTEDADA","ID_TIPUSDADA"]},required:!0}]},{name:"DADAELEMENTAL_TRACTAMENT",type:"listSplitted",label:"Dades dels tractaments de dades personals",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"ID_TRACTAMENTDADESPERSONALS",label:"Tractament dades personals",type:"lookupCache",entity:{name:"TRACTAMENTDADESPERSONALS",primaryKey:"ID",targetKey:"TITLE"},required:!0},{name:"ID_TIPUSDADA",label:"Tipus de dada",type:"dictionary",entityName:"TIPUSDADA",required:!0},{name:"ID_OBJECTEDADA",label:"Objecte de la dada",type:"lookupCache",entity:{name:"OBJECTEDADA",primaryKey:"ID",targetKey:"TITLE"},required:!0},{name:"ID_DADAELEMENTAL",label:"Dada elemental",type:"lookupCache",entity:{name:"DADAELEMENTAL",primaryKey:"ID",targetKey:"TITLE",cache:["ID_TIPUSDADA","ID_OBJECTEDADA"]},required:!0}]},{name:"TASCA_EVIDENCIAENTRADA",type:"listSplitted",label:"Tasques amb evidència d'entrada",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"ID_TASCA",label:"Tasca",type:"lookup",entity:{name:"TASCA",primaryKey:"ID",targetKey:"CODIINOM",cache:["ID_PROCES"]},required:!0},{name:"ID_EVIDENCIA",label:"Evidència",type:"lookup",entity:{name:"EVIDENCIA",primaryKey:"ID",targetKey:"TITLE"},required:!0}]},{name:"TASCA_EVIDENCIASORTIDA",type:"listSplitted",label:"Tasques amb evidència d'entrada",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"ID_TASCA",label:"Tasca",type:"lookup",entity:{name:"TASCA",primaryKey:"ID",targetKey:"CODIINOM",cache:["ID_PROCES"]},required:!0},{name:"ID_EVIDENCIA",label:"Evidència",type:"lookup",entity:{name:"EVIDENCIA",primaryKey:"ID",targetKey:"TITLE"},required:!0}]}];function Ti(e){return void 0===e?Array.from(Ai):Ai.find((t=>t.name===e))}function Ci(e,t){return t.map((t=>{if("string"==typeof t){const a=e.fields.find((e=>e.name===t));return Object.assign({},a)}{const a=e.fields.find((e=>e.name===t.name));return Object.assign({},a,t)}}))}const Di={class:"layoutBase-grid"},Ni={class:"layoutBase-logo"},gi=["src"],vi={class:"layoutBase-title"},Oi={class:"layoutBase-menu"},Si={class:"layoutBase-content"},bi={__name:"layout-base",props:{subtitle:{type:String,required:!0},hideMenu:{type:Boolean,default:!1}},setup(e){const t=m(),a=t.data.role,i=(0,r.useRouter)();function l(e,t){const a=Ti(t);if("list"===e)return{text:a.label,action:()=>i.push(`/${t}`)};if("dictionary"===e){const e=a.fields.find((e=>e.defaultField));return{text:a.label,action:()=>i.push({path:`/${t}`,query:{orderby:`${e.name} asc`}})}}}const o=[{icon:"Home",action:()=>i.push("/")},{text:"Processos",children:[l("list","PROCES"),l("list","TASCA"),l("list","PROCES_INDICADOR"),l("list","AGENT"),{type:"divider"},l("dictionary","TIPUSAGENT"),l("dictionary","FAMILIA"),l("dictionary","FAMILIAOPAE"),l("dictionary","TIPUSINICIACIO"),l("dictionary","TIPUSFINALITZACIO"),l("dictionary","TIPUSRECURSPROCES"),l("dictionary","TIPUSRELACIOPROCES"),l("dictionary","TIPUSTASCA"),l("dictionary","TIPUSINDICADOR")]},{text:"Sistemes",children:[l("list","SISTEMAINFORMACIO"),l("list","SISTEMAINFORMACIO_INDICADOR"),{type:"divider"},l("dictionary","PROVEIDOR"),l("dictionary","ENTORN"),l("dictionary","ENTORNTECNOLOGIC"),l("dictionary","UNITATDESCRIPCIO"),l("dictionary","MODELDESERVEI"),{type:"divider"},l("dictionary","CONTROLACCES"),l("dictionary","CONTROLINTEGRITAT"),l("dictionary","CLASSIFICACIOENS")]},{text:"Taules de control",children:[l("list","QUADRECOMANDAMENT"),l("list","INTERFICIECONNEXIO"),l("list","USUARI"),{type:"divider"},l("dictionary","HISTORIFICACIO"),l("dictionary","PERIODEACTUALITZACIO"),l("dictionary","PROCEDIMENTIMPORTACIO"),l("dictionary","TIPUSQUADRE"),l("dictionary","TIPUSIMPORTACIO"),l("dictionary","TIPUSINTERFICIE")]},{text:"Documents",children:[l("list","SERIEDOCUMENTAL"),l("list","MODELDOCUMENT"),l("list","EVIDENCIA"),l("list","DADAELEMENTAL"),l("list","REGLAACCES"),l("list","REGLACONSERVACIO"),l("list","TRACTAMENTDADESPERSONALS"),l("list","DISPOSICIONORMATIVA"),{type:"divider"},l("dictionary","TIPUSMODELDOCUMENT"),l("dictionary","FORMAT"),l("dictionary","MOTIULIMITACIO"),l("dictionary","DIPOSITDESTI"),l("dictionary","OBJECTEDADA"),l("dictionary","TIPUSDADA")]},{text:t.data.name,icon:"SwitchUser",children:[{text:"Canviar la clau d'acces",action:()=>i.push("/password-change")},{text:"Tancar sessió",action:()=>{t.setJwt(),i.push("/")}},{type:"divider"},{text:"Usuaris",disabled:"Administrador"!==a,action:()=>i.push("/USUARI_CATALEG")}]}];return(t,a)=>{const i=(0,n.resolveComponent)("fura-label"),l=(0,n.resolveComponent)("fura-command-bar");return(0,n.openBlock)(),(0,n.createElementBlock)("div",Di,[(0,n.createElementVNode)("div",Ni,[(0,n.createElementVNode)("img",{src:`/${(0,n.unref)(ce)}/images/logo.png`,width:"142"},null,8,gi)]),(0,n.createElementVNode)("div",vi,[(0,n.createVNode)(i,{class:"layoutBase-appTitle"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(me)),1)])),_:1}),(0,n.createVNode)(i,{class:"layoutBase-subtitle"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.subtitle),1)])),_:1})]),(0,n.createElementVNode)("div",Oi,[e.hideMenu?(0,n.createCommentVNode)("v-if",!0):((0,n.openBlock)(),(0,n.createBlock)(l,{key:0,"far-items":o}))]),(0,n.createElementVNode)("div",Si,[(0,n.renderSlot)(t.$slots,"default")])])}}},hi=(0,I.Z)(bi,[["__scopeId","data-v-092e5e47"]]);function Ri(e,t=null){return"asc"===(e?.direction??t)?"SortUp":"desc"===(e?.direction??t)?"SortDown":null}function _i(e){return"string"==typeof e&&e?e.split(",").map((e=>{const[t,a]=e.trim().replace(/\s+/," ").split(" ");return{sentence:t,direction:a||"asc"}})):[]}function Mi(e){return e.filter((e=>["asc","desc"].includes(e.direction))).map((e=>`${e.sentence} ${e.direction}`)).join(",")||void 0}const xi={__name:"details-view-select",props:{fields:{type:Array,default:()=>[]},data:{type:Array,required:!0},orderby:{type:Array,default:()=>[]},forcedOrder:{type:Boolean,default:!1},selectedItemId:{type:[Number,String],default:null},autoLayout:{type:String,default:null},compact:{type:Boolean,default:!1},selection:{type:String,default:""},stickyHeader:{type:Boolean,default:!1},stickyHeaderOffset:{type:[String,Number],default:null},pageSize:{type:Number,default:null},currentPage:{type:Number,default:0},dataCount:{type:Number,default:null},paginationPosition:{type:String,default:"bottomCenter"}},emits:["update:selectedItemId","update:orderby","clickCell","update:currentPage","contextmenuRow","contextmenuCell"],setup(e,{emit:t}){const a=e,i=(0,n.computed)((()=>a.fields.find((e=>e.primary))?.name)),l=(0,n.computed)((()=>{const e=a.data.findIndex((e=>e[i.value]===a.selectedItemId));return e>-1?[e]:[]}));function o(e){if(1===e.length){const n=a.data[e[0]];t("update:selectedItemId",n[i.value])}else t("update:selectedItemId",null)}function r(e){const n=a.data[e.row];t("update:selectedItemId",n[i.value])}const d=(0,n.computed)((()=>a.fields.map(((e,t)=>{if(e.primary)return null;{const n=Oe(e),i=a.orderby.find((e=>e.sentence===n));return{index:t,type:e.type,title:e.label,icon:Ri(i),width:e.detailsColumn?.width,align:e.detailsColumn?.align}}})).filter((e=>e)))),s=(0,n.computed)((()=>{const{pageSize:e,dataCount:t}=a;return"number"==typeof e&&"number"==typeof t})),u=(0,n.computed)((()=>Math.ceil(a.dataCount/a.pageSize)));function c(e){s.value&&e>=0&&e<u.value&&t("update:currentPage",e)}function m(e){const t=Number(e);!isNaN(t)&&t>0&&t<=u.value&&c(t-1)}const p=(0,n.computed)((()=>{switch(a.paginationPosition){case"topLeft":case"topCenter":case"topRight":return"detailsViewSelect-navTop";case"bottomLeft":case"bottomCenter":case"bottomRight":return"detailsViewSelect-navBottom";default:return}})),y=(0,n.computed)((()=>{switch(a.paginationPosition){case"topLeft":case"bottomLeft":return"detailsViewSelect-left";case"topCenter":case"bottomCenter":return"detailsViewSelect-center";case"topRight":case"bottomRight":return"detailsViewSelect-right";default:return}}));function I(e){const{index:n}=d.value[e],i=Oe(a.fields[n]);if(i){const n=a.orderby.map((e=>({...e}))),l=n.findIndex((e=>e.sentence===i));if(l>-1){const e=n[l];"asc"===e.direction?e.direction="desc":"desc"===e.direction?a.forcedOrder?e.direction="asc":n.splice(l,1):"none"===e.direction&&(e.direction="asc")}else{const t=n.map((e=>a.fields.findIndex((t=>Oe(t)===e.sentence))));if(t.every((e=>-1===e)))n.push({sentence:i,direction:"asc"});else{const a=[...t.entries()].filter((e=>e[1]>-1)).reduce(((t,a)=>!t||Math.abs(e-a[1])<Math.abs(e-t[1])?a:t),null),l=a[1]<e?a[0]+1:a[0];n.splice(l,0,{sentence:i,direction:"asc"})}}t("update:orderby",n)}}function f({row:e,event:n}){const l=a.data[e][i.value];t("contextmenuCell",{row:e,primary:l,event:n})}function E({row:e,column:n,event:l}){const o=a.data[e][i.value];t("contextmenuCell",{row:e,column:n,primary:o,event:l})}return(t,a)=>{const i=(0,n.resolveComponent)("fura-details-list"),A=(0,n.resolveComponent)("fura-spin-nav");return(0,n.openBlock)(),(0,n.createElementBlock)("div",{class:(0,n.normalizeClass)((0,n.unref)(p))},[(0,n.createVNode)(i,{columns:(0,n.unref)(d),data:e.data,"selected-indices":(0,n.unref)(l),"auto-layout":e.autoLayout,compact:e.compact,selection:e.selection,"sticky-header":e.stickyHeader,"sticky-header-offset":e.stickyHeaderOffset,"onUpdate:selectedIndices":o,onClickHeader:I,onClickCell:r,onContextmenuRow:f,onContextmenuCell:E},{default:(0,n.withCtx)((a=>[(0,n.renderSlot)(t.$slots,"default",{rowIndex:a.rowIndex,row:e.data[a.rowIndex],fieldIndex:a.column.index,field:e.fields[a.column.index],content:a.content},(()=>[((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)((0,n.unref)(Dt)[a.column.type].detailsCell),{field:e.fields[a.column.index],row:e.data[a.rowIndex]},null,8,["field","row"]))]))])),header:(0,n.withCtx)((e=>[(0,n.renderSlot)(t.$slots,"header",{column:e.column,index:e.index})])),group:(0,n.withCtx)((e=>[(0,n.renderSlot)(t.$slots,"group",{group:e.group,index:e.index,isCollapsed:e.isCollapsed})])),bodyHeader:(0,n.withCtx)((e=>[(0,n.renderSlot)(t.$slots,"bodyHeader",{groupIndex:e?.groupIndex,group:e?.group,columnIndex:e?.columnIndex,column:e?.column,data:e?.data})])),bodyFooter:(0,n.withCtx)((e=>[(0,n.renderSlot)(t.$slots,"bodyFooter",{groupIndex:e?.groupIndex,group:e?.group,columnIndex:e?.columnIndex,column:e?.column,data:e?.data})])),_:3},8,["columns","data","selected-indices","auto-layout","compact","selection","sticky-header","sticky-header-offset"]),(0,n.unref)(s)&&(0,n.unref)(p)&&(0,n.unref)(y)&&e.data.length>0?((0,n.openBlock)(),(0,n.createBlock)(A,{key:0,class:(0,n.normalizeClass)(["detailsViewSelect-navigation",(0,n.unref)(y)]),current:e.currentPage+1,total:(0,n.unref)(u),"end-button":"","start-button":"",editable:"","disable-prev":e.currentPage<=0,"disable-next":e.currentPage+1>=(0,n.unref)(u),"disable-start":e.currentPage<=0,"disable-end":e.currentPage+1>=(0,n.unref)(u),onPrev:a[0]||(a[0]=t=>c(e.currentPage-1)),onNext:a[1]||(a[1]=t=>c(e.currentPage+1)),onStart:a[2]||(a[2]=e=>c(0)),onEnd:a[3]||(a[3]=e=>c((0,n.unref)(u)-1)),onGoTo:m},null,8,["class","current","total","disable-prev","disable-next","disable-start","disable-end"])):(0,n.createCommentVNode)("v-if",!0)],2)}}},Li=(0,I.Z)(xi,[["__scopeId","data-v-5c441279"]]),Pi={__name:"menu-contextual",props:{items:{type:Array,default:null},positionX:{type:Number,required:!0},positionY:{type:Number,required:!0}},emits:["close"],setup(e,{expose:t,emit:a}){const i=(0,n.ref)(),l=(0,n.ref)(!1);function o(e){i.value.$el.contains(e.target)||i.value.$el===e.target||(e.preventDefault(),a("close"))}return(0,n.onMounted)((()=>window.addEventListener("click",o,!0))),(0,n.onUnmounted)((()=>window.removeEventListener("click",o,!0))),t({checkOverload:function(){l.value=i.value.checkOverload()}}),(t,a)=>{const o=(0,n.resolveComponent)("fura-block-menu");return e.items?((0,n.openBlock)(),(0,n.createBlock)(o,{key:0,ref_key:"element",ref:i,class:(0,n.normalizeClass)(["menuContextual",{overloaded:l.value}]),style:(0,n.normalizeStyle)({top:`${e.positionY}px`,left:`${e.positionX}px`}),items:e.items,onOverload:a[0]||(a[0]=e=>l.value=!0)},null,8,["class","style","items"])):(0,n.createCommentVNode)("v-if",!0)}}},wi=(0,I.Z)(Pi,[["__scopeId","data-v-138761e4"]]),Vi={__name:"layout-list-details",props:{menuItem:{type:Array,default:void 0},menuView:{type:Array,default:void 0},menuContextual:{type:Array,default:void 0},menuContextualOpen:{type:Boolean,default:!1},fields:{type:Array,default:()=>[]},data:{type:Array,required:!0},orderby:{type:Array,default:()=>[]},forcedOrder:{type:Boolean,default:!1},selectedItemId:{type:[Number,String],default:null},selection:{type:String,default:""},pageSize:{type:Number,default:null},currentPage:{type:Number,default:0},dataCount:{type:Number,default:null},paginationPosition:{type:String,default:"bottomCenter"}},emits:["menuContextualOpen","menuContextualClose","update:selectedItemId","update:orderby","clickCell","update:currentPage"],setup(e,{emit:t}){const a=e,i=(0,n.ref)(),l=(0,n.ref)({});function o({primary:e,event:a}){a.preventDefault(),l.value={x:a.clientX,y:a.clientY},t("menuContextualOpen",e),(0,n.nextTick)((()=>i.value?.checkOverload()))}function r(e){a.menuContextualOpen&&t("menuContextualClose")}return(0,n.onMounted)((()=>{document.getElementById("app").addEventListener("scroll",r)})),(0,n.onUnmounted)((()=>{document.getElementById("app").removeEventListener("scroll",r)})),(a,r)=>{const d=(0,n.resolveComponent)("fura-command-bar");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)(d,{class:"layoutDetails-commandBar",items:e.menuItem,"far-items":e.menuView},null,8,["items","far-items"]),(0,n.createVNode)((0,n.unref)(Li),{fields:e.fields,data:e.data,orderby:e.orderby,"forced-order":e.forcedOrder,"selected-item-id":e.selectedItemId,compact:"",selection:e.selection,"sticky-header":"","sticky-header-offset":44,"page-size":e.pageSize,"current-page":e.currentPage,"data-count":e.dataCount,"pagination-position":e.paginationPosition,"onUpdate:selectedItemId":r[0]||(r[0]=e=>t("update:selectedItemId",e)),"onUpdate:orderby":r[1]||(r[1]=e=>t("update:orderby",e)),onClickCell:r[2]||(r[2]=e=>t("clickCell",e)),"onUpdate:currentPage":r[3]||(r[3]=e=>t("update:currentPage",e)),onContextmenuRow:o,onContextmenuCell:o},null,8,["fields","data","orderby","forced-order","selected-item-id","selection","page-size","current-page","data-count","pagination-position"]),((0,n.openBlock)(),(0,n.createBlock)(n.Teleport,{to:"body"},[e.menuContextual&&e.menuContextualOpen?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(wi),{key:0,ref_key:"menuContextualElement",ref:i,items:e.menuContextual,"position-x":l.value.x,"position-y":l.value.y,onClose:r[4]||(r[4]=e=>t("menuContextualClose"))},null,8,["items","position-x","position-y"])):(0,n.createCommentVNode)("v-if",!0)]))],64)}}},Bi=(0,I.Z)(Vi,[["__scopeId","data-v-bbf1883a"]]);function Ui(e,{parse:t,stringify:a,handleLeave:i}={}){const l=(0,r.useRoute)(),o=(0,r.useRouter)(),d=(0,n.ref)(l.params[e]);return(0,r.onBeforeRouteUpdate)((t=>{d.value=t.params[e]})),i&&(0,r.onBeforeRouteLeave)((t=>{d.value=t.params[e]})),{[e]:(0,n.computed)({get:()=>"function"==typeof t?t(d.value):d.value,set:t=>{d.value!==t&&o.push({params:{[e]:"function"==typeof a?a(t)||void 0:t??void 0}})}})}}function ki(e,{parse:t,stringify:a,handleLeave:i}={}){const l=(0,r.useRoute)(),o=(0,r.useRouter)(),d=(0,n.ref)(l.query[e]);function s(t,n={}){n.value!==t&&o.push({path:l.path,query:{...l.query,...n,[e]:"function"==typeof a?a(t)||void 0:t??void 0}})}return(0,r.onBeforeRouteUpdate)((t=>{d.value=t.query[e]})),i&&(0,r.onBeforeRouteLeave)((t=>{d.value=t.query[e]})),{[e]:(0,n.computed)({get:()=>"function"==typeof t?t(d.value):d.value,set:e=>s(e)}),[`${e}Raw`]:(0,n.readonly)(d),[`update${Fi(e)}`]:s}}function Fi(e){return e[0].toUpperCase()+e.substring(1)}function $i(){const e=(0,r.useRoute)(),t=(0,r.useRouter)();return{goBack(a,i,{reload:l=!1}={}){if(e.query.return)if(l){const a=e.query.return.includes("?")?"&":"?";t.push(`${e.query.return}${a}reload=true`)}else t.push(e.query.return);else t.push({path:(0,n.unref)(a),query:{...(0,n.unref)(i)||e.query||{},reload:!0}})}}}function qi(e,t){return t?e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase():e.toLowerCase()}function Ki(e,t){return t.split("/").reduce(((e,t)=>e[t]),e)}function Gi(e,t){return{sortedData:(0,n.computed)((()=>{const a=Array.from((0,n.unref)(e)||[]),i=Array.from((0,n.unref)(t)||[]).reverse();for(const e of i)"asc"===e.direction?a.sort(((t,a)=>{const n=qi(Ki(t,e.sentence),!0),i=qi(Ki(a,e.sentence),!0);return n>i?1:n<i?-1:0})):"desc"===e.direction&&a.sort(((t,a)=>{const n=qi(Ki(t,e.sentence),!0),i=qi(Ki(a,e.sentence),!0);return n>i?-1:n<i?1:0}));return a}))}}const ji={__name:"dictionary-details",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRoute)(),i=(0,r.useRouter)(),l=he(),o=(0,n.computed)((()=>t.list.name)),{orderby:d,updateOrderby:s}=ki("orderby",{parse:_i,stringify:Mi,handleLeave:!0}),{selectedItemId:u}=ki("selectedItemId",{parse:e=>e?Number(e):null,stringify:e=>null!=e?String(e):void 0,handleLeave:!0}),{page:c,updatePage:m}=ki("page",{parse:e=>e?Number(e)-1:null,stringify:e=>null!=e?String(e+1):void 0,handleLeave:!0});(0,n.watch)(o,(e=>l.loadDictionary(e)),{immediate:!0});const p=(0,n.computed)((()=>t.list?.pageSize?t.list.pageSize:10)),y=(0,n.computed)((()=>l.data[o.value]?.length||0)),I=(0,n.computed)((()=>l.data[o.value]||[])),{sortedData:f}=Gi(I,d),E=(0,n.computed)((()=>{const e=c.value*p.value;return t.list?.paginated?f.value.slice(e,e+p.value):f.value})),A=(0,n.computed)((()=>{const e=t.list?.fields.find((e=>e.primary))?.name;let a=null;return e&&I.value.length>0&&(a=I.value.find((t=>t[e]===u.value))??null),t.list.permissionDenied?.(a)??{}})),T=(0,n.computed)((()=>{const e=[];return A.value.create||e.push({text:"Nou",icon:"Add",action:()=>i.push({path:`/${o.value}/create`,query:{return:a.fullPath}})}),null!=u.value&&(A.value.edit||e.push({text:"Modificar",icon:"Edit",action:()=>i.push({path:`/${o.value}/edit/${u.value}`,query:{return:a.fullPath}})}),A.value.delete||e.push({text:"Esborrar",icon:"Delete",action:()=>i.push({path:`/${o.value}/delete/${u.value}`,query:{return:a.fullPath}})})),e})),C=(0,n.computed)((()=>{const e=[];return null!=u.value&&null!=u.value&&(A.value.edit||e.push({text:"Modificar",icon:"Edit",action:()=>i.push({path:`/${o.value}/edit/${u.value}`,query:{return:a.fullPath}})}),A.value.delete||e.push({text:"Esborrar",icon:"Delete",action:()=>i.push({path:`/${o.value}/delete/${u.value}`,query:{return:a.fullPath}})})),[]})),D=(0,n.ref)(!1);function N(e){u.value=e,D.value=!0}function g(){D.value=!1}return(t,a)=>{const i=(0,n.resolveComponent)("router-view");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)((0,n.unref)(hi),{subtitle:e.list.label},{default:(0,n.withCtx)((()=>[(0,n.createVNode)((0,n.unref)(Bi),{"menu-item":(0,n.unref)(T),"menu-contextual":(0,n.unref)(C),"menu-contextual-open":D.value,fields:e.list.fields,data:(0,n.unref)(E),orderby:(0,n.unref)(d),"forced-order":"",selection:"simple","selected-item-id":(0,n.unref)(u),"page-size":(0,n.unref)(p),"current-page":(0,n.unref)(c),"data-count":(0,n.unref)(y),"onUpdate:orderby":a[0]||(a[0]=e=>(0,n.unref)(s)(e,{selectedItemId:void 0})),"onUpdate:selectedItemId":a[1]||(a[1]=e=>u.value=e),"onUpdate:currentPage":a[2]||(a[2]=e=>(0,n.unref)(m)(e,{selectedItemId:void 0})),onMenuContextualOpen:N,onMenuContextualClose:g},null,8,["menu-item","menu-contextual","menu-contextual-open","fields","data","orderby","selected-item-id","page-size","current-page","data-count"])])),_:1},8,["subtitle"]),(0,n.createVNode)(i)],64)}}},zi={key:0},Wi={class:"layoutListItem-actions"},Yi={__name:"layout-list-item",props:{tabs:{type:Array,default:void 0},currentTab:{type:String,default:void 0},hasSave:{type:Boolean,default:!1},hasSaveAndNew:{type:Boolean,default:!1},hasSaveAndEdit:{type:Boolean,default:!1},hasSaveAndClose:{type:Boolean,default:!1},hasGoBack:{type:Boolean,default:!1},hasClose:{type:Boolean,default:!1},hasReset:{type:Boolean,default:!1},hasRemove:{type:Boolean,default:!1},maxWidth:{type:String,default:null},selfAling:{type:String,default:"center",validator:e=>!e||["left","center","right"].includes(e)}},emits:["update:currentTab","save","saveAndNew","saveAndEdit","saveAndClose","goBack","close","reset","remove"],setup(e){const t=e;return(a,i)=>{const l=(0,n.resolveComponent)("fura-pivot"),o=(0,n.resolveComponent)("fura-button");return(0,n.openBlock)(),(0,n.createElementBlock)("div",{class:(0,n.normalizeClass)(`layoutListItem-container layoutListItem-${t.selfAling}`),style:(0,n.normalizeStyle)({maxWidth:e.maxWidth})},[(0,n.createElementVNode)("div",null,[(0,n.renderSlot)(a.$slots,"default")]),e.tabs?.length>0?((0,n.openBlock)(),(0,n.createElementBlock)("div",zi,[(0,n.createVNode)(l,{tabs:e.tabs,"model-value":e.currentTab,"onUpdate:modelValue":i[0]||(i[0]=e=>a.$emit("update:currentTab",e))},null,8,["tabs","model-value"]),(0,n.renderSlot)(a.$slots,"child")])):(0,n.createCommentVNode)("v-if",!0),(0,n.createElementVNode)("div",Wi,[e.hasSave?((0,n.openBlock)(),(0,n.createBlock)(o,{key:0,class:"layoutListItem-button",primary:"",text:"Guardar",icon:"Save",onClick:i[1]||(i[1]=e=>a.$emit("save"))})):(0,n.createCommentVNode)("v-if",!0),e.hasSaveAndNew?((0,n.openBlock)(),(0,n.createBlock)(o,{key:1,class:"layoutListItem-button",primary:"",text:"Guardar i nou",icon:"SaveAs",onClick:i[2]||(i[2]=e=>a.$emit("saveAndNew"))})):(0,n.createCommentVNode)("v-if",!0),e.hasSaveAndEdit?((0,n.openBlock)(),(0,n.createBlock)(o,{key:2,class:"layoutListItem-button",primary:"",text:"Guardar i continuar editant",icon:"SaveAs",onClick:i[3]||(i[3]=e=>a.$emit("saveAndEdit"))})):(0,n.createCommentVNode)("v-if",!0),e.hasSaveAndClose?((0,n.openBlock)(),(0,n.createBlock)(o,{key:3,class:"layoutListItem-button",primary:"",text:"Guardar i tancar",icon:"SaveAndClose",onClick:i[4]||(i[4]=e=>a.$emit("saveAndClose"))})):(0,n.createCommentVNode)("v-if",!0),e.hasGoBack?((0,n.openBlock)(),(0,n.createBlock)(o,{key:4,class:"layoutListItem-button",text:"Tornar",icon:"Back",onClick:i[5]||(i[5]=e=>a.$emit("goBack"))})):(0,n.createCommentVNode)("v-if",!0),e.hasClose?((0,n.openBlock)(),(0,n.createBlock)(o,{key:5,class:"layoutListItem-button",text:"Tancar",icon:"ChromeClose",onClick:i[6]||(i[6]=e=>a.$emit("close"))})):(0,n.createCommentVNode)("v-if",!0),e.hasReset?((0,n.openBlock)(),(0,n.createBlock)(o,{key:6,class:"layoutListItem-button",text:"Reiniciar",icon:"Refresh",onClick:i[7]||(i[7]=e=>a.$emit("reset"))})):(0,n.createCommentVNode)("v-if",!0),e.hasRemove?((0,n.openBlock)(),(0,n.createBlock)(o,{key:7,primary:"",class:"layoutListItem-button layoutListItem-alertButton",text:"Eliminar",icon:"Delete",onClick:i[8]||(i[8]=e=>a.$emit("remove"))})):(0,n.createCommentVNode)("v-if",!0)])],6)}}},Xi=(0,I.Z)(Yi,[["__scopeId","data-v-f73b1a8e"]]),Hi={__name:"form-auto",props:{list:{type:Object,required:!0},form:{type:Object,required:!0},entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,i=at();(0,n.watch)((()=>a.list.name),(e=>i.load(e)),{immediate:!0});const l=(0,n.computed)((()=>Ci(a.list,a.form.fields(a.entity)))),{errorMessage:o,clean:r}=a.form.rules?a.validations.createValidation("formRules",{rules:a.form.rules}):{};function d({field:e,action:a}){r?.(),t("change",a)}return Zt(((...e)=>a.form.onItemLoaded?.(...e))),(t,a)=>{const i=(0,n.resolveComponent)("fura-message-bar");return(0,n.openBlock)(),(0,n.createElementBlock)("div",{class:(0,n.normalizeClass)(e.form.class)},[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(l),entity:e.entity,"with-class":e.form.withClass,validations:e.validations,"cache-name":e.list.entityName||e.list.name,onChange:d},null,8,["fields","entity","with-class","validations","cache-name"]),(0,n.unref)(o)?((0,n.openBlock)(),(0,n.createBlock)(i,{key:0,style:{"grid-area":"errorMessage"},type:"error",dismiss:"",singleline:"",onDismiss:a[0]||(a[0]=e=>(0,n.unref)(r)?.())},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(o)),1)])),_:1})):(0,n.createCommentVNode)("v-if",!0)],2)}}},Zi=Hi;async function Ji(e,t){const a=ue();try{const a=await e();return t&&t(),a}catch(e){t&&t(),a.alert({title:"Error",message:e.body||"Error inesperat."})}}const Qi={__name:"dictionary-item-edit",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRoute)(),i=(0,r.useRouter)(),l=ue(),d=he(),s=(0,o.useValidations)(),{goBack:u}=$i(),c=(0,n.computed)((()=>t.list.name)),{itemId:m}=Ui("itemId",{parse:e=>null!=e?Number(e):null,stringify:e=>null!=e?String(e):void 0,handleLeave:!0}),p=(0,n.computed)((()=>t.list.fields.find((e=>e.primary)))),y=(0,n.computed)((()=>t.list.fields.find((e=>e.defaultField)))),I=ke({form:{entityName:c.value},...t.list}),f=(0,n.ref)(!1),E=(0,n.ref)("");function A(){const e=null!=m.value?d.data[c.value].find((e=>e[p.value.name]===m.value)):Object.fromEntries(t.list.fields.map((e=>[e.name,e.default])));(0,o.entitySyncData)(I,e),(0,o.entityConsolidate)(I)}function T({action:e}){e(I)}async function C(){await s.validate(I)&&(await Fe(I),await d.loadDictionary(c,{force:!0}),u(`/${c.value}`))}async function D(){await s.validate(I)&&(await Fe(I),await d.loadDictionary(c,{force:!0}),null===m.value?A():i.push({path:`/${c.value}/create`,query:a.query}))}function N(){l.confirm({title:"Alerta!",message:"Esteu segurs de que voleu esborrar aquest element?. Aquesta acció no es pot desfer.",accept:async()=>{await Ji((async()=>{await $e(I),await d.loadDictionary(c,{force:!0}),i.push({path:`/${c.value}`,query:{...a.query,selectedKey:void 0}})}))}})}return(0,n.watch)(m,A),(0,n.onMounted)((async()=>{f.value=!1,await d.loadDictionary(c),A(),E.value=null===m.value?"Entrada nou element":`Modificació: ${I[y.value.name]}`,f.value=!0})),(t,a)=>{const i=(0,n.resolveComponent)("fura-dialog"),l=(0,n.resolveComponent)("fura-overlay");return(0,n.openBlock)(),(0,n.createBlock)(l,{class:"dictionaryItemEdit-overlay",fixed:"",dark:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(i,{class:"dictionaryItemEdit-dialog",header:E.value},{default:(0,n.withCtx)((()=>[(0,n.createVNode)((0,n.unref)(Xi),{"has-save":"","has-save-and-new":"","has-reset":"","has-remove":null!==(0,n.unref)(m),"has-go-back":"",onSave:C,onSaveAndNew:D,onReset:A,onRemove:N,onGoBack:a[0]||(a[0]=e=>(0,n.unref)(u)(`/${(0,n.unref)(c)}`))},{default:(0,n.withCtx)((()=>[e.list.form?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Zi),{key:0,list:e.list,form:e.list.form,entity:(0,n.unref)(I),validations:(0,n.unref)(s),onChange:T},null,8,["list","form","entity","validations"])):((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Nt),{key:1,fields:e.list.fields,entity:(0,n.unref)(I),validations:(0,n.unref)(s),"cache-name":e.list.name,onChange:T},null,8,["fields","entity","validations","cache-name"]))])),_:1},8,["has-remove"])])),_:1},8,["header"])])),_:1})}}},el=(0,I.Z)(Qi,[["__scopeId","data-v-1b60de7a"]]),tl={class:"dialogFooter"},al={__name:"dictionary-item-delete",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRoute)(),i=(0,r.useRouter)(),l=ue(),o=he(),{goBack:d}=$i(),s=(0,n.computed)((()=>t.list.name)),{itemId:u}=Ui("itemId",{parse:e=>null!=e?Number(e):null,stringify:e=>null!=e?String(e):void 0}),c=t.list.fields.find((e=>e.primary)),m=t.list.fields.find((e=>e.defaultField)),p=(0,n.ref)("");return(0,n.onMounted)((async()=>{l.loadStart("dictionary-form/load"),await o.loadDictionary(s);const e=o.data[s.value].find((e=>e[c.$select]===u));p.value=`Esteu segurs que voleu esborrar l'element "${e?.[m.$select]}"?`,l.loadEnd("dictionary-form/load")})),(e,t)=>{const l=(0,n.resolveComponent)("fura-button"),r=(0,n.resolveComponent)("fura-dialog"),c=(0,n.resolveComponent)("fura-overlay");return(0,n.openBlock)(),(0,n.createBlock)(c,{class:"modalOverlay",fixed:"",dark:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(r,{class:"dialogMessage",type:"close",header:"Confirmació d'eliminació",text:p.value,onClick:t[2]||(t[2]=e=>(0,n.unref)(d)(`/${(0,n.unref)(s)}`))},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",tl,[(0,n.createVNode)(l,{primary:"",text:"Eliminar",onClick:t[0]||(t[0]=e=>async function(){await Ji((async()=>{await ge(`${s.value}(${u.value})`),await o.loadDictionary(s,{force:!0}),i.push({path:`/${s.value}`,query:{...a.query,selectedKey:void 0}})}))}())}),(0,n.createVNode)(l,{text:"Cancel·lar",onClick:t[1]||(t[1]=e=>(0,n.unref)(d)(`/${(0,n.unref)(s)}`))})])])),_:1},8,["text"])])),_:1})}}};function nl(e){return[{path:`/${e.name}`,component:e.routes?.overrideControls?.DictionaryDetails??ji,props:{list:e},children:[{path:"create",component:e.routes?.overrideControls?.DictionaryItemEdit??el,props:{list:e}},{path:"edit/:itemId",component:e.routes?.overrideControls?.DictionaryItemEdit??el,props:{list:e}},{path:"delete/:itemId",component:e.routes?.overrideControls?.DictionaryItemDelete??al,props:{list:e}}]}]}const il=(0,i.defineStore)({id:"view",state:()=>({listName:null,definitions:[]}),actions:{async loadViews(e,t){if(e&&(this.listName!==e||t)){const t=ue();t.loadStart(`list-view/${e}/load`);const a=await Ne(ye,{$filter:`${fe} eq '${e}'`,$orderby:`${Te} desc,${Ee} asc`});this.listName=e,this.definitions=a.value.map((e=>({...e,[Ae]:JSON.parse(e[Ae]||"null")}))),t.loadEnd(`list-view/${e}/load`)}}}}),ll={class:"listDetailsDefault-buttons"},ol={__name:"list-details-default",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRouter)(),i=il(),l=(0,n.computed)((()=>t.list.name)),o=(0,n.ref)(!1);function d(){a.push(`/${l.value}/view/create`)}return(0,n.watch)(l,(e=>{e&&i.loadViews(e).then((()=>{const t=i.definitions.find((e=>e[Te]))||i.definitions[0],n=t?.[Ee];n&&a.push({path:`/${e}/view/query/${n}`,query:{orderby:t[Ae].orderby,filter:t[Ae].filter}}),o.value=!0}))}),{immediate:!0}),(t,a)=>{const i=(0,n.resolveComponent)("fura-button"),l=(0,n.resolveComponent)("fura-dialog"),r=(0,n.resolveComponent)("fura-overlay");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(hi),{subtitle:e.list.label},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(r,{class:"listDetailsDefault-overlay"},{default:(0,n.withCtx)((()=>[o.value?((0,n.openBlock)(),(0,n.createBlock)(l,{key:0,class:"listDetailsDefault-dialog",header:"Atencio",text:"No s'ha definit cap visualització. Creeu una visualització per començar."},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",ll,[(0,n.createVNode)(i,{primary:"",text:"Crea una nova visualització",onClick:d})])])),_:1})):(0,n.createCommentVNode)("v-if",!0)])),_:1})])),_:1},8,["subtitle"])}}},rl=(0,I.Z)(ol,[["__scopeId","data-v-0871c081"]]),dl={__name:"list-details",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRouter)(),i=(0,r.useRoute)(),l=il(),d=ue(),s=(0,n.computed)((()=>t.list.name)),{viewName:u}=Ui("viewName"),{filter:c}=ki("filter"),{orderby:p,orderbyRaw:y,updateOrderby:I}=ki("orderby",{parse:_i,stringify:Mi}),{selectedItemId:f}=ki("selectedItemId",{parse:e=>e?Number(e):null,stringify:e=>null!=e?String(e):void 0}),{page:E,updatePage:A}=ki("page",{parse:e=>e?Number(e)-1:null,stringify:e=>null!=e?String(e+1):void 0}),{reload:T}=ki("reload",{parse:e=>Boolean(e)});(0,n.watch)(s,(async e=>{await l.loadViews(e),u.value&&!l.definitions.some((e=>e[Ee]===u.value))&&a.push(`/${e}`)}),{immediate:!0});const C=(0,n.computed)((()=>t.list?.fields.find((e=>e.primary)))),D=(0,n.computed)((()=>t.list?.fields.filter((e=>e.loadAlwaysInView))??[])),N=(0,n.computed)((()=>l.definitions.find((e=>e[Ee]===u.value)))),g=(0,n.computed)((()=>{const e=Array.from(N.value?.[Ae].fields||[]);return e.includes(C.value?.name)||e.unshift(C.value?.name),e.map((e=>t.list.fields.find((t=>t.name===e)))).filter((e=>e))})),v=(0,n.computed)((()=>t.list?.pageSize?t.list.pageSize:10)),O=(0,n.computed)((()=>{if("function"==typeof t.list.detailsFilter){const e=t.list.detailsFilter(),a="string"==typeof e?e:G(e);return c.value?`(${a}) and (${c.value})`:a}return c.value})),S=(0,n.computed)((()=>({...ve([C.value,...g.value,...D.value.filter((e=>!g.value?.some((t=>e.name===t.name))))]),$filter:O.value||void 0,$orderby:y.value||void 0,$skip:E.value>0?E.value*v.value:void 0,$top:v.value,$count:!0}))),b=(0,n.computed)((()=>t.list.entityName||t.list.name)),{data:h,isLoading:R,load:_}=function(e,t,a,n){const i=m();return(0,o.useFetchGet)([pe,e].flat(),t,{Authorization:i.jwt},void 0)}(b,S);(0,n.watch)(T,(e=>{e&&_(),a.replace({path:i.path,query:{...i.query,reload:void 0}})}));const M=(0,n.computed)((()=>h.value?.value||[])),x=(0,n.computed)((()=>h.value?.["@odata.count"]));(0,n.watch)(R,(e=>e?d.loadStart(`list/${s.value}/load`):d.loadEnd(`list/${s.value}/load`)),{immediate:!0});const L=(0,n.computed)((()=>{if(C.value&&M.value.length>0){const e=C.value.name;return M.value.find((t=>t[e]===f.value))??null}return null})),P=(0,n.computed)((()=>t.list.permissionDenied?.(L.value)??{})),w=(0,n.computed)((()=>{const e=[];return P.value.create||e.push({text:"Nou",icon:"Add",action:()=>a.push({path:`/${s.value}/create`,query:{return:i.fullPath}})}),null!=f.value&&(P.value.edit||e.push({text:"Modificar",icon:"Edit",action:()=>a.push({path:`/${s.value}/edit/${f.value}`,query:{return:i.fullPath}})}),P.value.delete||e.push({text:"Esborrar",icon:"Delete",action:()=>a.push({path:`/${s.value}/delete/${f.value}`,query:{...i.query,viewName:u.value}})})),P.value.edit||"auto"!==t.list.form?.component||e.push({text:"Editar valors",icon:"WindowEdit",action:()=>a.push({path:`/${s.value}/view/grid/${u.value}`,query:i.query})}),null==f.value&&u.value&&!P.value.export&&e.push({text:"Exportar",icon:"Export",children:[{text:"a PDF",icon:"PDF",action:()=>a.push({path:`/${s.value}/view/query/${u.value}/export`,query:{...i.query,format:"pdf"}})},{text:"a Excel",icon:"ExcelDocument",action:()=>a.push({path:`/${s.value}/view/query/${u.value}/export`,query:{...i.query,format:"excel"}})}]}),e})),V=(0,n.computed)((()=>t.list.menuUpdater?t.list.menuUpdater(w.value,L.value,{contextual:!1}):w.value)),B=(0,n.computed)((()=>{const e=[{text:u.value??"",children:[...l.definitions?.map((e=>({text:e[Ee],action:()=>a.push({path:`/${s.value}/view/query/${e[Ee]}`,query:{orderby:e[Ae].orderby,filter:e[Ae].filter}})})))??[],{type:"divider"},{text:"Crea una visualització",icon:"Add",action:()=>a.push({path:`/${s.value}/view/create`,query:{filter:i.query.filter,return:i.fullPath}})}]}];return u.value&&e[0].children.push({text:"Modifica",icon:"CSS",action:()=>a.push({path:`/${s.value}/view/edit/${u.value}`,query:{filter:i.query.filter,return:i.fullPath}})}),t.list.filter&&e.push({icon:"Filter",action:()=>a.push({path:`/${s.value}/view/query/${u.value}/filter`,query:{...i.query}})}),e})),U=(0,n.computed)((()=>{const e=[];return P.value.edit||e.push({text:"Modificar",icon:"Edit",action:()=>a.push({path:`/${b.value}/edit/${f.value}`,query:{return:i.fullPath}})}),P.value.delete||e.push({text:"Esborrar",icon:"Delete",action:()=>a.push({path:`/${b.value}/delete/${f.value}`,query:{...i.query,viewName:u.value}})}),e})),k=(0,n.computed)((()=>t.list.menuUpdater?t.list.menuUpdater(U.value,L.value,{contextual:!0}):U.value)),F=(0,n.ref)(!1);function $(e){f.value=e,F.value=!0}function q(){F.value=!1}return(t,a)=>{const i=(0,n.resolveComponent)("router-view");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)((0,n.unref)(hi),{subtitle:e.list.label},{default:(0,n.withCtx)((()=>[(0,n.createVNode)((0,n.unref)(Bi),{"menu-item":(0,n.unref)(V),"menu-view":(0,n.unref)(B),"menu-contextual":(0,n.unref)(k),"menu-contextual-open":F.value,fields:(0,n.unref)(g),data:(0,n.unref)(M),orderby:(0,n.unref)(p),selection:"simple","selected-item-id":(0,n.unref)(f),"page-size":(0,n.unref)(v),"current-page":(0,n.unref)(E),"data-count":(0,n.unref)(x),"onUpdate:orderby":a[0]||(a[0]=e=>(0,n.unref)(I)(e,{selectedItemId:void 0})),"onUpdate:selectedItemId":a[1]||(a[1]=e=>f.value=e),"onUpdate:currentPage":a[2]||(a[2]=e=>(0,n.unref)(A)(e,{selectedItemId:void 0})),onMenuContextualOpen:$,onMenuContextualClose:q},null,8,["menu-item","menu-view","menu-contextual","menu-contextual-open","fields","data","orderby","selected-item-id","page-size","current-page","data-count"])])),_:1},8,["subtitle"]),(0,n.createVNode)(i)],64)}}},sl={class:"detailsGrid fura-stickyHeader"},ul={class:"detailsGrid-headerTitle"},cl=["textContent"],ml=(e=>((0,n.pushScopeId)("data-v-3c346872"),e=e(),(0,n.popScopeId)(),e))((()=>(0,n.createElementVNode)("th",{width:"88px"},null,-1))),pl={key:0},yl=["colspan"],Il={__name:"details-grid",props:{list:{type:Object,required:!0},columns:{type:Array,required:!0},elements:{type:Array,required:!0},stickyHeader:{type:Boolean,default:!1},stickyHeaderOffset:{type:[String,Number],default:null}},emits:["update","focus","blur","save","reset"],setup(e,{emit:t}){const a=e,i=(0,n.computed)((()=>"number"==typeof a.stickyHeaderOffset&&a.stickyHeaderOffset?{top:`${a.stickyHeaderOffset}px`}:"string"==typeof a.stickyHeaderOffset&&a.stickyHeaderOffset?{top:a.stickyHeaderOffset}:{})),l=a.elements.map((e=>(0,n.computed)((()=>{const t=Ci(a.list,a.list.form.fields(e.entity));return Ci({fields:t},a.columns.map((({field:e})=>e.name)))})))),o=a.elements.map(((e,t)=>l[t].value.map((t=>(0,n.computed)((()=>function(e,t){const{withClass:n}=a.list.form;return!0===n?`formField-${e.name}`:"function"==typeof n?n(e,t):void 0}(t,e.entity)))))));return(a,r)=>{const d=(0,n.resolveComponent)("fura-icon"),s=(0,n.resolveComponent)("fura-button"),u=(0,n.resolveComponent)("fura-message-bar");return(0,n.openBlock)(),(0,n.createElementBlock)("table",sl,[(0,n.createElementVNode)("thead",null,[(0,n.createElementVNode)("tr",null,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.columns,((e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("th",{key:t,class:"detailsGrid-headerCell",style:(0,n.normalizeStyle)({width:e.field.gridColumn?.width,...(0,n.unref)(i)})},[(0,n.createElementVNode)("div",ul,[(0,n.createElementVNode)("span",{textContent:(0,n.toDisplayString)(e.title)},null,8,cl),e.icon?((0,n.openBlock)(),(0,n.createBlock)(d,{key:0,class:"detailsGrid-headerIcon",name:e.icon},null,8,["name"])):(0,n.createCommentVNode)("v-if",!0)])],4)))),128)),ml])]),((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.elements,((a,i)=>((0,n.openBlock)(),(0,n.createElementBlock)("tbody",{key:i},[(0,n.createElementVNode)("tr",null,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.columns,((r,d)=>((0,n.openBlock)(),(0,n.createElementBlock)("td",{key:d},[(0,n.unref)(Dt)[(0,n.unref)(l)[i].value[d].type]?.gridField?((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)((0,n.unref)(Dt)[(0,n.unref)(l)[i].value[d].type].gridField),{key:0,class:(0,n.normalizeClass)((0,n.unref)(o)[i][d].value),entity:a.entity,field:(0,n.unref)(l)[i].value[d],validations:a.validations,"cache-name":e.list.entityName||e.list.name,onChange:e=>t("update",{index:i,field:(0,n.unref)(l)[i].value[d],action:e}),onFocus:e=>t("focus",{index:i,field:(0,n.unref)(l)[i].value[d],event:e}),onBlur:e=>t("blur",{index:i,field:(0,n.unref)(l)[i].value[d],event:e})},null,40,["class","entity","field","validations","cache-name","onChange","onFocus","onBlur"])):((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)((0,n.unref)(Dt)[r.field.type].detailsCell),{key:1,field:r.field,row:a.entity},null,8,["field","row"]))])))),128)),(0,n.createElementVNode)("td",null,[a.hasPendingChanges?((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:0},[(0,n.createVNode)(s,{type:"icon",icon:"Save",onClick:e=>t("save",i)},null,8,["onClick"]),(0,n.createVNode)(s,{type:"icon",icon:"Reset",onClick:e=>t("reset",i)},null,8,["onClick"])],64)):(0,n.createCommentVNode)("v-if",!0)])]),a.errorMessage?((0,n.openBlock)(),(0,n.createElementBlock)("tr",pl,[(0,n.createElementVNode)("td",{colspan:e.columns.length+1},[(0,n.createVNode)(u,{type:"error",dismiss:"",singleline:"",onDismiss:e=>a.clean?.()},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(a.errorMessage),1)])),_:2},1032,["onDismiss"])],8,yl)])):(0,n.createCommentVNode)("v-if",!0)])))),128))])}}},fl=(0,I.Z)(Il,[["__scopeId","data-v-3c346872"]]),El={__name:"layout-list-grid",props:{list:{type:Object,required:!0},menuItem:{type:Array,default:void 0},menuView:{type:Array,default:void 0},fields:{type:Array,default:void 0},elements:{type:Array,default:void 0},orderby:{type:Array,default:()=>[]},pageSize:{type:Number,default:null},currentPage:{type:Number,default:0},elementsCount:{type:Number,default:null},paginationPosition:{type:String,default:"bottomCenter"}},emits:["update","focus","blur","save","reset"],setup(e,{emit:t}){const a=e,i=(0,n.computed)((()=>a.fields.map(((e,t)=>({index:t,type:e.type,title:e.label,icon:Ri(a.orderby.find((t=>t.sentence===Oe(e)))),field:e}))))),l=(0,n.computed)((()=>{const{pageSize:e,elementsCount:t}=a;return"number"==typeof e&&"number"==typeof t})),o=(0,n.computed)((()=>Math.ceil(a.elementsCount/a.pageSize))),r=(0,n.computed)((()=>{switch(a.paginationPosition){case"topLeft":case"topCenter":case"topRight":return"layoutListGrid-navTop";case"bottomLeft":case"bottomCenter":case"bottomRight":return"layoutListGrid-navBottom";default:return}})),d=(0,n.computed)((()=>{switch(a.paginationPosition){case"topLeft":case"bottomLeft":return"layoutListGrid-left";case"topCenter":case"bottomCenter":return"layoutListGrid-center";case"topRight":case"bottomRight":return"layoutListGrid-right";default:return}}));return(a,s)=>{const u=(0,n.resolveComponent)("fura-command-bar"),c=(0,n.resolveComponent)("fura-spin-nav");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)(u,{class:"layoutListGrid-commandBar",items:e.menuItem,"far-items":e.menuView},null,8,["items","far-items"]),(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)((0,n.unref)(r))},[(0,n.createVNode)((0,n.unref)(fl),{class:"layoutListGrid-details",list:e.list,columns:(0,n.unref)(i),elements:e.elements,"sticky-header":"","sticky-header-offset":44,onUpdate:s[0]||(s[0]=e=>t("update",e)),onFocus:s[1]||(s[1]=e=>t("focus",e)),onBlur:s[2]||(s[2]=e=>t("blur",e)),onSave:s[3]||(s[3]=e=>t("save",e)),onReset:s[4]||(s[4]=e=>t("reset",e))},null,8,["list","columns","elements"]),(0,n.unref)(l)&&(0,n.unref)(r)&&(0,n.unref)(d)&&e.elements.length>0?((0,n.openBlock)(),(0,n.createBlock)(c,{key:0,class:(0,n.normalizeClass)(["layoutListGrid-navigation",(0,n.unref)(d)]),current:e.currentPage+1,total:(0,n.unref)(o),"end-button":"","start-button":"","disable-prev":"","disable-next":"","disable-start":"","disable-end":""},null,8,["class","current","total"])):(0,n.createCommentVNode)("v-if",!0)],2)],64)}}},Al=(0,I.Z)(El,[["__scopeId","data-v-7472afbe"]]),Tl={__name:"list-details-grid",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRouter)(),i=(0,r.useRoute)(),l=il(),d=at(),s=ue();d.setContextName(t.list.name),d.load(t.list.name);const u=(0,n.ref)(!0),c=i.params.viewName,p=i.query.page?Number(i.query.page)-1:null,y=t.list?.pageSize?t.list.pageSize:10,I=(0,n.shallowRef)([]),f=(0,n.shallowRef)(null),E=(0,o.useEntityCollection)(qe(t.list,t.list.form)),A=(0,n.ref)(0),T=(0,n.reactive)([]),C=(0,n.getCurrentScope)();l.loadViews(t.list.name).then((async()=>{s.loadStart(`list/${t.list.name}/load`),c&&!l.definitions.some((e=>e[Ee]===c))&&a.push(`/${t.list.name}`);const e=l.definitions.find((e=>e[Ee]===c));I.value=e[Ae].fields.map((e=>t.list.fields.find((t=>t.name===e)))).filter((e=>e));let r=i.query.filter;if("function"==typeof t.list.detailsFilter){const e=t.list.detailsFilter(),a="string"==typeof e?e:G(e);r=i.query.filter?`(${a}) and (${i.query.filter})`:a}const d={$filter:r||void 0,$orderby:i.query.orderby||void 0,$skip:p>0?p*y:void 0,$top:y,$count:!0};f.value=await function(e,t){const a=m();return(0,o.entityLoadCollection)(e,pe,{Authorization:a.jwt},t)}(E,d),A.value=f.value?.["@odata.count"];const D=t.list.fields.find((e=>e.primary)).name;for(const e of E.values()){const a=Ci(t.list,t.list.form.fields(e)).filter((e=>!I.value.some((t=>t.name===e.name))&&"function"==typeof Dt[e.type]?.getEntityValue)),i=(0,o.useValidations)(),{errorMessage:l,clean:r}=t.list.form.rules?i.createValidation("formRules",{rules:t.list.form.rules}):{};C.run((()=>{i.createField(D,(0,n.computed)((()=>e[D])));for(const t of a)i.createField(t.name,(0,n.computed)((()=>Dt[t.type].getEntityValue(t,e))))})),T.push({entity:e,data:(0,o.entityData)(e),hasPendingChanges:!1,validations:i,errorMessage:l,clean:r})}u.value=!1,s.loadEnd(`list/${t.list.name}/load`)}));const D=(0,n.computed)((()=>(0,o.entityHasPendingChanges)(E)?[{text:"Guardar",icon:"Save",action:v},{text:"Reiniciar",icon:"Refresh",action:()=>{(0,o.entitySyncData)(E,f.value.value);for(const e of T)e.clean(),e.data=(0,o.entityData)(e.entity),e.hasPendingChanges=(0,o.entityHasPendingChanges)(e.entity)}},{text:"Tornar",icon:"Back",action:()=>{s.confirm({title:"Alerta!",message:"Hi han canvis sense guardar. Aquests canvis es perdràn. Voleu continuar?.",accept(){a.push({path:`/${t.list.name}/view/query/${c}`,query:i.query})}})}}]:[{text:"Tornar",icon:"Back",action:()=>{a.push({path:`/${t.list.name}/view/query/${c}`,query:i.query})}}])),N=(0,n.computed)((()=>{const e=[{text:c??"",disabled:!0}];return t.list.filter&&e.push({icon:"Filter",disabled:!0}),e}));async function g({index:e,field:t,action:a}){const n=T[e];if(a(n.entity),"function"==typeof t.onChange){const e=await t.onChange(n.entity);"function"==typeof e&&e(n.entity)}n.hasPendingChanges=(0,o.entityHasPendingChanges)(n.entity),n.clean()}function v(){return Ji((async()=>await Promise.all(T.map((async(e,t)=>{e.hasPendingChanges&&await e.validations.validate(e.entity)&&(await Fe(e.entity),(0,o.entityConsolidate)(e.entity),e.hasPendingChanges=!1,f.value.value[t]=(0,o.entityData)(e.entity))})))))}async function O(e){const t=T[e];await t.validations.validate(t.entity)&&await Ji((async()=>{await Fe(t.entity),(0,o.entityConsolidate)(t.entity),t.hasPendingChanges=!1,f.value.value[e]=(0,o.entityData)(t.entity)}))}function S(e){const t=T[e];t.clean(),(0,o.entitySyncData)(t.entity,f.value.value[e]),t.hasPendingChanges=(0,o.entityHasPendingChanges)(t.entity)}return(t,a)=>{const l=(0,n.resolveComponent)("router-view");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)((0,n.unref)(hi),{subtitle:e.list.label},{default:(0,n.withCtx)((()=>[u.value?(0,n.createCommentVNode)("v-if",!0):((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Al),{key:0,list:e.list,"menu-item":(0,n.unref)(D),"menu-view":(0,n.unref)(N),fields:(0,n.unref)(I),elements:T,orderby:(0,n.unref)(_i)((0,n.unref)(i).query.orderby),"page-size":(0,n.unref)(y),"current-page":(0,n.unref)(p),"elements-count":A.value,onUpdate:g,onSave:O,onReset:S},null,8,["list","menu-item","menu-view","fields","elements","orderby","page-size","current-page","elements-count"]))])),_:1},8,["subtitle"]),(0,n.createVNode)(l)],64)}}},Cl={__name:"filter-form-combo",props:{field:{type:Object,required:!0},cacheName:{type:String,default:""},modelValue:{type:void 0,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,i=at(),l=(0,n.shallowRef)([]);return(0,n.watchEffect)((()=>{l.value=(i.data[a.cacheName]?.[a.field.name]||[]).map((e=>({value:e[a.field.valueKey||"value"],text:e[a.field.textKey||"text"]})))})),(a,i)=>{const o=(0,n.resolveComponent)("fura-combo-box");return(0,n.openBlock)(),(0,n.createBlock)(o,{label:e.field.label,options:(0,n.unref)(l),multiple:e.field.multiple,"model-value":e.modelValue,"onUpdate:modelValue":i[0]||(i[0]=e=>t("update:modelValue",e))},null,8,["label","options","multiple","model-value"])}}},Dl={__name:"filter-form-combo-custom",props:{field:{type:Object,required:!0},cacheName:{type:String,default:""},modelValue:{type:void 0,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,i=m(),l=at(),o=a.field.setDisabled&&"function"==typeof a.field.setDisabled?a.field.setDisabled(i):null;if(o){const e=a.field.setValue&&"function"==typeof a.field.setValue?a.field.setValue(i):null;e&&t("update:modelValue",parseInt(e))}const r=(0,n.shallowRef)([]);return(0,n.watchEffect)((()=>{r.value=(l.data[a.cacheName]?.[a.field.name]||[]).map((e=>({value:e[a.field.valueKey||"value"],text:e[a.field.textKey||"text"]})))})),(a,i)=>{const l=(0,n.resolveComponent)("fura-combo-box");return(0,n.openBlock)(),(0,n.createBlock)(l,{label:e.field.label,disabled:(0,n.unref)(o),options:(0,n.unref)(r),multiple:e.field.multiple,"model-value":e.modelValue,"onUpdate:modelValue":i[0]||(i[0]=e=>t("update:modelValue",e))},null,8,["label","disabled","options","multiple","model-value"])}}},Nl={__name:"filter-form-csv",props:{field:{type:Object,required:!0},cacheName:{type:String,default:""},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,i=(0,n.computed)({get:()=>Array.isArray(a.modelValue)&&a.modelValue.length>0?a.modelValue.join():"",set(e){const a=e.replace(/(\r\n|\n|\r)/gm,",").split(",").filter(Boolean);e.length>0?t("update:modelValue",a):t("update:modelValue",void 0)}});return(t,a)=>{const l=(0,n.resolveComponent)("fura-text-field");return(0,n.openBlock)(),(0,n.createBlock)(l,{label:e.field.label,multiline:"",modelValue:(0,n.unref)(i),"onUpdate:modelValue":a[0]||(a[0]=e=>(0,n.isRef)(i)?i.value=e:null)},null,8,["label","modelValue"])}}},gl={key:3},vl={key:7,class:"filterForm-multiple"},Ol={__name:"filter-form",props:{fields:{type:Array,required:!0},modelValue:{type:Array,required:!0},cacheName:{type:String,default:""}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e;function i(e){return a.modelValue.find((t=>t[0]===e.name))?.[1]}function l(e,n){if(null==n||""===n||Array.isArray(n)&&0===n.length)t("update:modelValue",a.modelValue.filter((t=>t[0]!==e.name)));else{const i=a.modelValue.findIndex((t=>t[0]===e.name));t("update:modelValue",-1===i?[...a.modelValue,[e.name,n]]:[...a.modelValue.slice(0,i),[e.name,n],...a.modelValue.slice(i+1)])}}return(a,o)=>{const r=(0,n.resolveComponent)("fura-text-field"),d=(0,n.resolveComponent)("fura-number-field"),s=(0,n.resolveComponent)("fura-date-picker"),u=(0,n.resolveComponent)("fura-checkbox"),c=(0,n.resolveComponent)("FilterForm",!0);return(0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.fields,(a=>((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:a.name},["text"===a.type?((0,n.openBlock)(),(0,n.createBlock)(r,{key:0,label:a.label,"model-value":i(a),"onUpdate:modelValue":e=>l(a,e)},null,8,["label","model-value","onUpdate:modelValue"])):"number"===a.type?((0,n.openBlock)(),(0,n.createBlock)(d,{key:1,label:a.label,"model-value":i(a),"onUpdate:modelValue":e=>l(a,e)},null,8,["label","model-value","onUpdate:modelValue"])):"date"===a.type?((0,n.openBlock)(),(0,n.createBlock)(s,{key:2,label:a.label,"model-value":i(a),"onUpdate:modelValue":e=>l(a,e)},null,8,["label","model-value","onUpdate:modelValue"])):"checkbox"===a.type?((0,n.openBlock)(),(0,n.createElementBlock)("div",gl,[(0,n.createVNode)(u,{class:"filterForm-checkbox",label:a.label,"model-value":i(a),"onUpdate:modelValue":e=>l(a,!!e&&null),indeterminate:"boolean"!=typeof i(a),"onUpdate:indeterminate":e=>l(a,!0)},null,8,["label","model-value","onUpdate:modelValue","indeterminate","onUpdate:indeterminate"])])):"combo"===a.type?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Cl),{key:4,field:a,"cache-name":e.cacheName,"model-value":i(a),"onUpdate:modelValue":e=>l(a,e)},null,8,["field","cache-name","model-value","onUpdate:modelValue"])):"comboCustom"===a.type?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Dl),{key:5,field:a,"cache-name":e.cacheName,"model-value":i(a),"onUpdate:modelValue":e=>l(a,e)},null,8,["field","cache-name","model-value","onUpdate:modelValue"])):"csv"===a.type?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Nl),{key:6,field:a,"model-value":i(a),"onUpdate:modelValue":e=>l(a,e)},null,8,["field","model-value","onUpdate:modelValue"])):Array.isArray(a)?((0,n.openBlock)(),(0,n.createElementBlock)("div",vl,[(0,n.createVNode)(c,{fields:a,"model-value":e.modelValue,"onUpdate:modelValue":o[0]||(o[0]=e=>t("update:modelValue",e))},null,8,["fields","model-value"])])):(0,n.createCommentVNode)("v-if",!0)],64)))),128)}}},Sl=(0,I.Z)(Ol,[["__scopeId","data-v-275189ca"]]),bl=["onSubmit"],hl={key:0,class:"filterGroups"},Rl=["onClick"],_l={class:"content fura-slideDownIn20"},Ml={class:"actions"},xl={__name:"list-details-filter-panel",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRoute)(),i=(0,r.useRouter)(),l=at(),{expanded:o,updateExpanded:d}=ki("expanded");l.setContextName(t.list.name),l.load(t.list.name);const s=Ci(t.list,t.list.filter),u=[],c=[],m=[];for(const e of s)if(e.type in Dt){const t=Dt[e.type],a=t.getFilterCondition?.(e,s);a&&u.push(a);const n=t.getFilterInterface?.(e,s);if(n)if(e.filterGroup){const t=m.find((t=>t.name===e.filterGroup));t?t.fields.push(n):m.push({name:e.filterGroup,fields:[n]})}else c.push(n)}const p=new Y(u,"and"),y=(0,n.ref)(a.query.filter?p.readFilter(a.query.filter):[]);function I(){i.push({path:`/${t.list.name}/view/query/${a.params.viewName}`,query:{...a.query,filter:p.writeFilter(y.value)||void 0,selectedItemId:void 0,page:void 0}})}function f(){i.push({path:`/${t.list.name}/view/query/${a.params.viewName}`,query:{...a.query,filter:void 0}})}function E(){i.push({path:`/${t.list.name}/view/query/${a.params.viewName}`,query:a.query})}function A(e){return Array.isArray(o.value)?o.value.includes(e.name):o.value===e.name}const T=(0,n.ref)();return(0,n.onMounted)((()=>{T.value.querySelector('input, select, textarea, [tabindex]:not([tabindex="-1"])')?.focus()})),(t,a)=>{const i=(0,n.resolveComponent)("fura-icon"),l=(0,n.resolveComponent)("fura-button"),r=(0,n.resolveComponent)("fura-panel"),s=(0,n.resolveComponent)("fura-overlay");return(0,n.openBlock)(),(0,n.createBlock)(s,{fixed:"",dark:""},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("form",{onSubmit:(0,n.withModifiers)(I,["prevent"])},[(0,n.createVNode)(r,{type:"medium","header-text":`Filtrar ${e.list.label}`,onClick:E},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Ml,[(0,n.createVNode)(l,{primary:"",text:"Cerca",icon:"Filter","form-role":"submit"}),(0,n.createVNode)(l,{class:"clearFilter",primary:"",text:"Esborra el filtre",icon:"ClearFilter",onClick:f}),(0,n.createVNode)(l,{text:"Cancela",icon:"Cancel",onClick:E})])])),default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",{ref_key:"fieldsContainer",ref:T},[m.length>0?((0,n.openBlock)(),(0,n.createElementBlock)("div",hl,[((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(m,(t=>(0,n.createElementVNode)("div",{key:t.name,class:(0,n.normalizeClass)(["item",{expanded:A(t)}])},[t.name?((0,n.openBlock)(),(0,n.createElementBlock)("button",{key:0,class:"title",type:"button",onClick:(0,n.withModifiers)((e=>function(e){A(e)?Array.isArray(o.value)?d(o.value.filter((t=>t!==e.name))):d(null):Array.isArray(o.value)?d([...o.value,e.name]):o.value?d([o.value,e.name]):d(e.name)}(t)),["stop"])},[(0,n.createVNode)(i,{class:"expanderIcon",name:"ChevronDown"}),(0,n.createTextVNode)(" "+(0,n.toDisplayString)(t.name),1)],8,Rl)):(0,n.createCommentVNode)("v-if",!0),(0,n.createElementVNode)("div",_l,[(0,n.createVNode)((0,n.unref)(Sl),{fields:t.fields,"cache-name":e.list.name,modelValue:y.value,"onUpdate:modelValue":a[0]||(a[0]=e=>y.value=e)},null,8,["fields","cache-name","modelValue"])])],2))),64))])):(0,n.createCommentVNode)("v-if",!0),(0,n.createVNode)((0,n.unref)(Sl),{fields:c,"cache-name":e.list.name,modelValue:y.value,"onUpdate:modelValue":a[1]||(a[1]=e=>y.value=e)},null,8,["cache-name","modelValue"])],512)])),_:1},8,["header-text"])],40,bl)])),_:1})}}},Ll=(0,I.Z)(xl,[["__scopeId","data-v-72612ae2"]]);function Pl(e){const t=String(e??"");return t.includes('"')||t.includes(";")||t.includes("\n")?`"${t.replaceAll('"','""')}"`:t}async function wl(e,t){const a=[];for(const n of t){const t=[];for(const a of e)if("function"==typeof Dt[a.type]?.getCsvValueFromEntity){const e=Pl(await Dt[a.type].getCsvValueFromEntity(a,n));t.push(e)}else t.push("");a.push(t)}return a}function Vl(){const e=(e,t=2)=>e.toString().padStart(t,"0"),t=new Date(Date.now());return`${e(t.getDate())}/${e(t.getMonth()+1)}/${e(t.getFullYear(),4)}`}const Bl={class:"dialogAlert-close"},Ul={__name:"list-details-export",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRoute)(),i=(0,r.useRouter)(),l=il(),o=(0,n.ref)(null),d=(0,n.ref)(),s=(0,n.computed)((()=>"pdf"===a.query.format?`${t.list.label}.pdf`:"excel"===a.query.format?`${t.list.label}.csv`:`${t.list.label}.txt`));function u(){i.back()}async function c(e,n){return"pdf"===a.query.format?await async function(e,t,{title:a}){$a?.pdfMake&&(Fa.vfs=$a.pdfMake.vfs);const n=await async function(e,t){const a=[];for(const n of t){const t=[];for(const a of e)if("function"==typeof Dt[a.type]?.getTextValueFromEntity){const e=await Dt[a.type].getTextValueFromEntity(a,n);t.push(e)}else t.push("");a.push(t)}return a}(e,t),i={pageSize:"A4",pageMargins:[30,60,30,30],pageOrientation:"landscape",header:(e,t)=>({margin:[30,30,20,0],columns:[{text:"Assignació places NEE",width:165,alignment:"left"},{text:a,width:"*",style:"tableHeaderCenter"},{table:{widths:["auto","auto"],body:[[{text:"Pàg.",alignment:"left"},{text:e+" de "+t,alignment:"right"}],[{text:"Data",alignment:"left"},{text:Vl(),alignment:"right"}]]},layout:"noBorders",width:"80",style:"tableHeaderRight"}]}),content:[{table:{headerRows:1,dontBreakRows:!0,border:"none",body:[e.map((e=>({text:e.label,bold:!0,alignment:e.align||"left"}))),...n.map((t=>t.map(((t,a)=>({text:t,align:e[a].align||"left"})))))]},layout:"noBorders",margin:[0,5,0,5]}],styles:{tableHeader:{bold:!0},tableHeaderCenter:{bold:!0,alignment:"center"},tableHeaderRight:{bold:!0,alignment:"right"},boldFirst:{bold:!0,margin:[0,6,0,0]},bold:{bold:!0},normal:{bold:!1}},defaultStyle:{fontSize:9}};return await new Promise((e=>{Fa.createPdf(i).getDataUrl(e)}))}(e,n,{title:t.list.label}):"excel"===a.query.format?await async function(e,t){const a=[e.map((e=>Pl(e.label))),...await wl(e,t)].map((e=>e.join(";"))).join("\n");return"data:text/csv;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent("\ufeff"+a+"\n")))}(e,n):void 0}return(0,n.onMounted)((async()=>{await l.loadViews(t.list.name);const e=l.definitions.find((e=>e[Ee]===a.params.viewName)),i=Array.from(e[Ae].fields).map((e=>t.list.fields.find((t=>t.name===e)))).filter((e=>e)),r={...ve(i),$filter:a.query.filter||void 0,$orderby:a.query.orderby||void 0},s=await Ne(t.list.name,r);o.value=await c(i,s.value),await(0,n.nextTick)(),d.value.$el.click(),u()})),(e,t)=>{const a=(0,n.resolveComponent)("fura-button"),i=(0,n.resolveComponent)("fura-dialog"),l=(0,n.resolveComponent)("fura-overlay");return(0,n.openBlock)(),(0,n.createBlock)(l,{class:"listExport-overlay",fixed:"",dark:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(i,{class:"listExport-dialog",header:"Exportació de dades",text:"Fitxer llest per descarregar."},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Bl,[o.value?((0,n.openBlock)(),(0,n.createBlock)(a,{key:0,ref_key:"download",ref:d,primary:"",text:"Descarrega",download:(0,n.unref)(s),href:o.value,target:"_blank"},null,8,["download","href"])):(0,n.createCommentVNode)("v-if",!0),(0,n.createVNode)(a,{text:"Tancar",onClick:u})])])),_:1})])),_:1})}}},kl=(0,I.Z)(Ul,[["__scopeId","data-v-392e43be"]]),Fl=e=>((0,n.pushScopeId)("data-v-5f58ff4a"),e=e(),(0,n.popScopeId)(),e),$l={class:"list-view-fields"},ql=Fl((()=>(0,n.createElementVNode)("div",null,null,-1))),Kl={class:"list-view-fields"},Gl=Fl((()=>(0,n.createElementVNode)("div",{class:"list-view-orderBy"},null,-1))),jl={__name:"list-view-simple-config",props:{fields:{type:Array,required:!0},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,i=(0,n.computed)((()=>{const{modelValue:e,fields:t}=a;return[{value:null,text:"",disabeld:!1},...t.map((t=>({value:t.name,text:t.label,disabled:e.some((e=>e.name===t.name))})))]}));function l(e){e&&t("update:modelValue",[...a.modelValue,{name:e,direction:null}])}function o(e){const t=a.fields.find((t=>t.name===e));return t&&t.orderby?t.orderby:[{value:"asc",text:"A -> Z"},{value:"desc",text:"Z -> A"}]}return(r,d)=>{const s=(0,n.resolveComponent)("fura-dropdown"),u=(0,n.resolveComponent)("llesca-stack-draggable");return(0,n.openBlock)(),(0,n.createBlock)(u,{"primary-key":"name","model-value":e.modelValue,"onUpdate:modelValue":d[0]||(d[0]=e=>t("update:modelValue",e))},{default:(0,n.withCtx)((e=>[(0,n.createElementVNode)("div",$l,[(0,n.createVNode)(s,{class:"list-view-field",options:(0,n.unref)(i),"model-value":e.item.name,"onUpdate:modelValue":n=>function(e,n){const i=[...a.modelValue];n?i[e]={name:n,direction:i[e].direction}:i.splice(e,1),t("update:modelValue",i)}(e.index,n)},null,8,["options","model-value","onUpdate:modelValue"]),(0,n.createVNode)(s,{class:"list-view-orderBy",options:o(e.item.name),"model-value":e.item.direction,"onUpdate:modelValue":n=>function(e,n){const i=[...a.modelValue];i[e]={name:i[e].name,direction:n},t("update:modelValue",i)}(e.index,n)},null,8,["options","model-value","onUpdate:modelValue"]),ql])])),footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Kl,[(0,n.createVNode)(s,{class:"list-view-field",options:(0,n.unref)(i),"onUpdate:modelValue":l},null,8,["options"]),Gl])])),_:1},8,["model-value"])}}},zl=(0,I.Z)(jl,[["__scopeId","data-v-5f58ff4a"]]),Wl={class:"layout"},Yl={class:"viewOptions"},Xl={class:"actions"},Hl={__name:"list-view-edit",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRoute)(),i=(0,r.useRouter)(),l=ue(),d=il(),s=m(),u=(0,n.computed)((()=>a.params.viewName??null)),c=(0,n.computed)((()=>d.definitions.find((e=>e[Ee]===u.value))?.[Ie])),p=(0,n.computed)((()=>t.list.name));d.loadViews(p.value).then((()=>{if(u.value){const e=d.definitions.find((e=>e[Ee]===u.value));e||alert("error"),A(e)}}));const y=t.list.fields.filter((e=>e.label)),I=(0,n.reactive)({name:"",defaultView:!1,selectedFields:[],saveFilter:!1,nameErrorMessage:null,showErrorMessage:!1}),f=(0,n.computed)((()=>Mi(I.selectedFields.filter((e=>e.name)).map((e=>({sentence:Oe(t.list.fields.find((t=>t.name===e.name))),direction:e.direction})))))),E=(0,n.computed)((()=>!d.definitions.some((e=>1===e[Te]))||d.definitions[0][Ee]===I.name));function A(e={}){const a=e?.[Ae]?.fields??[],n=_i(e?.[Ae]?.orderby??"")??[],i=a.map((e=>{const a=t.list.fields.find((t=>t.name===e));return{name:e,direction:n.find((e=>e.sentence===Oe(a)))?.direction}}));I.name=e?.[Ee]??"",I.defaultView=!!e?.[Te],I.selectedFields=i,I.saveFilter=!1}async function T(){if(function(){let e=!0;return I.nameErrorMessage=null,I.showErrorMessage=!1,I.name?d.definitions.some((e=>e[Ie]!==c.value&&e[Ee]===I.name))&&(e=!1,I.nameErrorMessage="Ja existeix una visualització amb aquest nom."):(e=!1,I.nameErrorMessage="Cal posar un nom a la visualització,"),0===I.selectedFields.length&&(e=!1,I.showErrorMessage=!0),e}()){const e=I.defaultView?d.definitions.filter((e=>e[Te])).map((e=>({atomicityGroup:"saveView",id:`saveView-patch${e[Ie]}`,method:"PATCH",url:`/${ye}(${e[Ie]})`,headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:s.jwt},body:{[Te]:0}}))):[];e.push(function(){const e=d.definitions.find((e=>e[Ee]===u.value));if(null!==u.value&&!e)throw new Error("La vista a actualitzar no s'ha trobat.");const[t,n,i]=void 0===e?["saveView-post","POST",`/${ye}`]:[`saveView-put-${e[Ie]}`,"PUT",`/${ye}(${e[Ie]})`];return{atomicityGroup:"saveView",id:t,method:n,url:i,headers:{"Content-Type":"application/json",Authorization:s.jwt},body:{[Ie]:e?.[Ie],[fe]:p.value,[Ee]:I.name,VIEWTYPE:"list",[Ae]:JSON.stringify({fields:I.selectedFields.filter((e=>e.name)).map((e=>e.name)),orderby:f.value,filter:I.saveFilter?a.query.filter||void 0:e?.[Ae].filter}),[Te]:E.value||I.defaultView?1:0}}}()),await async function(e){let t=!0;l.loadStart(`list/${p.value}/list-edit/save`);const{responses:a}=await function(e,t,a,n={},{withoutDialog:i=!1}={}){return De(Symbol("requestPost"),(()=>o.odata.requestPost([pe,e].flat(),t,a,{Authorization:m().jwt,...n})),i)}("$batch",{requests:e});return a.some((e=>201!==e.status&&204!==e.status))&&(l.alert({title:"Error",message:"Error inesperat"}),t=!1),l.loadEnd(`list/${p.value}/list-edit/save`),t}(e)&&(await d.loadViews(p.value,!0),i.push({path:`/${p.value}/view/query/${I.name}`,query:{orderby:f.value,filter:d.definitions.find((e=>e[Ee]===I.name))?.[Ae].filter}}))}}function C(){l.confirm({title:"Alerta!",message:"Esteu segurs de que voleu esborrar aquesta visualització?. Aquesta acció no es pot desfer.",accept:async()=>{await ge(`${ye}(${c.value})`),await d.loadViews(p.value,!0),i.push(`/${p.value}`)}})}function D(){A(d.definitions.find((e=>e[Ee]===u.value)))}function N(){a.query.return?i.push(a.query.return):i.push(`/${p.value}/view/query/${I.name}`)}return(t,a)=>{const i=(0,n.resolveComponent)("fura-label"),l=(0,n.resolveComponent)("fura-separator"),o=(0,n.resolveComponent)("fura-text-field"),r=(0,n.resolveComponent)("fura-checkbox"),d=(0,n.resolveComponent)("fura-button"),s=(0,n.resolveComponent)("fura-message-bar");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(hi),{class:"baseLayout",subtitle:e.list.label},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Wl,[(0,n.createVNode)(l,{class:"separatorLlista","align-content":"center"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(i,null,{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)("Llista")])),_:1})])),_:1}),(0,n.createVNode)(o,{required:"",name:"name",class:"name",label:"Nom de la visualització","error-message":I.nameErrorMessage,modelValue:I.name,"onUpdate:modelValue":[a[0]||(a[0]=e=>I.name=e),a[1]||(a[1]=e=>I.nameErrorMessage=null)]},null,8,["error-message","modelValue"]),(0,n.createElementVNode)("div",Yl,[(0,n.createVNode)(r,{name:"defaultView",label:"Visualització per defecte",disabled:(0,n.unref)(E),"model-value":(0,n.unref)(E)||I.defaultView,"onUpdate:modelValue":a[2]||(a[2]=e=>I.defaultView=e)},null,8,["disabled","model-value"]),(0,n.createVNode)(r,{name:"saveFilter",label:"Guardar el filtre actual",modelValue:I.saveFilter,"onUpdate:modelValue":a[3]||(a[3]=e=>I.saveFilter=e)},null,8,["modelValue"])]),(0,n.createVNode)(l,{class:"separatorColumnes","align-content":"center"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(i,null,{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)("Columnes")])),_:1})])),_:1}),(0,n.createVNode)((0,n.unref)(zl),{class:"fields",fields:(0,n.unref)(y),modelValue:I.selectedFields,"onUpdate:modelValue":[a[4]||(a[4]=e=>I.selectedFields=e),a[5]||(a[5]=e=>I.showErrorMessage=!1)]},null,8,["fields","modelValue"]),(0,n.createElementVNode)("div",Xl,[(0,n.createVNode)(d,{primary:"",text:"Guardar",icon:"Save",onClick:T}),(0,n.createVNode)(d,{text:"Tornar",icon:"Back",onClick:N}),(0,n.createVNode)(d,{text:"Reiniciar",icon:"Refresh",onClick:D}),null!==(0,n.unref)(u)?((0,n.openBlock)(),(0,n.createBlock)(d,{key:0,primary:"",class:"remove",text:"Eliminar",icon:"Delete",onClick:C})):(0,n.createCommentVNode)("v-if",!0)]),I.showErrorMessage?((0,n.openBlock)(),(0,n.createBlock)(s,{key:0,class:"errorMessage",type:"error",dismiss:"",onDismiss:a[6]||(a[6]=e=>I.showErrorMessage=!1)},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Cal seleccionar alguna columna. ")])),_:1})):(0,n.createCommentVNode)("v-if",!0)])])),_:1},8,["subtitle"])}}},Zl=(0,I.Z)(Hl,[["__scopeId","data-v-6591ad77"]]);function Jl(e,t){const a=(0,n.ref)(!1),i=ke((0,n.unref)(e)),l=(0,n.ref)();return(0,n.watch)((()=>(0,n.unref)(t)),(async t=>{a.value=!1,null!=t?await function(e,t){const a=m();return(0,o.entityLoad)(e,pe,{Authorization:a.jwt},t)}(i,t):Se((0,n.unref)(e),i),l.value=(0,o.entityData)(i,{depth:0}),a.value=!0}),{immediate:!0}),{entityLoaded:a,entity:i,initialData:l,resetEntity(){for(const e in l.value)i[e]=l.value[e]},entitySave(){Fe(i)},entityDelete(){$e(i)}}}const Ql={__name:"list-item-edit",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRoute)(),i=(0,r.useRouter)(),l=ue(),d=(0,o.useValidations)(),s=at(),{goBack:u}=$i(),{sendMessage:c,close:m}=Xt(),{itemId:p}=Ui("itemId",{parse:e=>null!=e?Number(e):null,stringify:e=>null!=e?String(e):void 0}),{tabName:y}=Ui("tabName"),{popup:I}=ki("popup");s.setContextName(t.list.name),s.load(t.list.name);const{entityLoaded:f,entity:E,resetEntity:A}=Jl(t.list,p);let T=!1;const C=(0,n.ref)({});(0,n.watch)(f,(e=>{e&&(C.value=t.list.permissionDenied?.(E)??{},T&&(0,n.nextTick)((()=>{T=!1,ea(E)})))}),{immediate:!0});const D=(0,n.computed)((()=>null==p.value?!C.value.create:!C.value.edit));Jt(),(0,n.onMounted)((()=>{f.value?ea(E):T=!0})),(0,n.onUnmounted)(Qt);const N=t.list.fields.find((e=>e.primary)).name,g=(0,n.computed)((()=>E[N]));d.createField(N,g);const v=(0,n.computed)((()=>t.list.form.tabs?.map((e=>({text:e.title,value:e.name,icon:e.icon,count:e.count})))??[]));function O(e){e(E)}function S(e){i.push({path:null==p.value?`/${t.list.name}/create/tab/${e}`:`/${t.list.name}/edit/${p.value}/tab/${e}`,query:{return:a.query.return,popup:I.value}})}async function b(){await d.validate(E)&&await Ji((async()=>{await Fe(E),u(`/${t.list.name}`,null,{reload:!0})}))}async function h(){await d.validate(E)&&await Ji((async()=>{await Fe(E),c({action:"save"}),m()}))}function R(){l.confirm({title:"Alerta!",message:"Esteu segurs de que voleu desfer els canvis realitzats?.",accept(){A(),(0,n.nextTick)((()=>ea(E)))}})}function _(){l.confirm({title:"Alerta!",message:"Esteu segurs de que voleu esborrar aquest element?. Aquesta acció no es pot desfer.",async accept(){await Ji((async()=>{await $e(E),u(`/${t.list.name}`,null,{reload:!0})}))}})}return(t,a)=>{const i=(0,n.resolveComponent)("router-view");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(hi),{class:"itemListEdit-container",subtitle:e.list.label},{default:(0,n.withCtx)((()=>[(0,n.unref)(f)?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Xi),{key:0,tabs:(0,n.unref)(v),"current-tab":(0,n.unref)(y),"max-width":e.list.form.maxWidth,"self-aling":e.list.form.selfAlign,"has-save":(0,n.unref)(D)&&void 0===(0,n.unref)(I),"has-save-and-close":(0,n.unref)(D)&&void 0!==(0,n.unref)(I),"has-reset":"","has-remove":null!==(0,n.unref)(p)&&!C.value.delete,"has-go-back":void 0===(0,n.unref)(I),"has-close":void 0!==(0,n.unref)(I),"onUpdate:currentTab":S,onSave:b,onSaveAndClose:h,onReset:R,onRemove:_,onGoBack:a[0]||(a[0]=t=>(0,n.unref)(u)(`/${e.list.name}`)),onClose:(0,n.unref)(m)},{default:(0,n.withCtx)((()=>["auto"===e.list.form.component?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Zi),{key:0,list:e.list,form:e.list.form,entity:(0,n.unref)(E),validations:(0,n.unref)(d),onChange:O},null,8,["list","form","entity","validations"])):((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)(e.list.form.component),{key:1,entity:(0,n.unref)(E),validations:(0,n.unref)(d),onChange:O},null,40,["entity","validations"]))])),child:(0,n.withCtx)((()=>[(0,n.createVNode)(i,{entity:(0,n.unref)(E),validations:(0,n.unref)(d),onChange:O},null,8,["entity","validations"])])),_:1},8,["tabs","current-tab","max-width","self-aling","has-save","has-save-and-close","has-remove","has-go-back","has-close","onClose"])):(0,n.createCommentVNode)("v-if",!0)])),_:1},8,["subtitle"])}}},eo=(0,I.Z)(Ql,[["__scopeId","data-v-e1f6c376"]]),to={__name:"list-item-tab-subform",props:{list:{type:Object,required:!0},subform:{type:Object,required:!0},entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e){const t=e,a=(0,n.computed)((()=>t.list.entityName||t.list.name)),i=(0,n.computed)((()=>Ci(t.list,t.subform.fields(t.entity))));return(t,l)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",{class:(0,n.normalizeClass)(e.subform.class)},[(0,n.createVNode)((0,n.unref)(Nt),{"with-area-name":"",fields:(0,n.unref)(i),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(a),onChange:l[0]||(l[0]=e=>t.$emit("change",e.action))},null,8,["fields","entity","validations","cache-name"])],2))}},ao=to,no={key:0},io={class:"cellactions"},lo={key:0},oo={key:1},ro={__name:"details-view-edit",props:{fields:{type:Array,default:()=>[]},data:{type:Array,required:!0},orderby:{type:Array,default:()=>[]},forcedOrder:{type:Boolean,default:!1},autoLayout:{type:String,default:null},compact:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1}},emits:["edit","create","update:orderby","clickCell"],setup(e,{emit:t}){const a=e,i=(0,n.computed)((()=>[...a.readonly?[]:[{key:"actions",width:"25px"}],...a.fields.map(((e,t)=>{if(e.primary)return null;{const n=Oe(e),i=a.orderby.find((e=>e.sentence===n));return{index:t,type:e.type,title:e.label,icon:Ri(i),width:e.detailsColumn?.width,align:e.detailsColumn?.align}}}))]));function l(e){const{index:n}=i.value[e];if(null!=n){const i=Oe(a.fields[n]);if(i){const n=a.orderby.map((e=>({...e}))),l=n.findIndex((e=>e.sentence===i));if(l>-1){const e=n[l];"asc"===e.direction?e.direction="desc":"desc"===e.direction?a.forcedOrder?e.direction="asc":n.splice(l,1):"none"===e.direction&&(e.direction="asc")}else{const t=n.map((e=>a.fields.findIndex((t=>Oe(t)===e.sentence))));if(t.every((e=>-1===e)))n.push({sentence:i,direction:"asc"});else{const a=[...t.entries()].filter((e=>e[1]>-1)).reduce(((t,a)=>!t||Math.abs(e-a[1])<Math.abs(e-t[1])?a:t),null),l=a[1]<e?a[0]+1:a[0];n.splice(l,0,{sentence:i,direction:"asc"})}}t("update:orderby",n)}}}return(a,o)=>{const r=(0,n.resolveComponent)("fura-button"),d=(0,n.resolveComponent)("fura-details-list");return(0,n.openBlock)(),(0,n.createBlock)(d,{columns:(0,n.unref)(i),data:e.data,"auto-layout":e.autoLayout,compact:e.compact,onClickHeader:l,onClickCell:o[1]||(o[1]=e=>t("clickCell",e))},{default:(0,n.withCtx)((i=>[(0,n.createCommentVNode)("\n        @slot Contenido de una celda.\n        @binding {number} rowIndex Índice de la fila.\n        @binding {number} columnIndex Índice de la definición de la columna.\n        @binding {string} content Contenido de la celda.\n        @binding {object} column Referencia a la definición de la columna.\n      "),(0,n.renderSlot)(a.$slots,"default",{rowIndex:i.rowIndex,row:e.data[i.rowIndex],columnIndex:i.columnIndex,column:i.column,content:i.content},(()=>["actions"===i.column.key?((0,n.openBlock)(),(0,n.createElementBlock)("div",no,[(0,n.createElementVNode)("div",io,[(0,n.createVNode)(r,{type:"icon",icon:"Edit",onClick:e=>t("edit",i.rowIndex)},null,8,["onClick"])])])):((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)((0,n.unref)(Dt)[i.column.type].detailsCell),{key:1,field:e.fields[i.column.index],row:e.data[i.rowIndex]},null,8,["field","row"]))]))])),header:(0,n.withCtx)((e=>[(0,n.createCommentVNode)("\n        @slot Contenido de una cabecera.\n        @binding {object} column Referencia a la definición de la columna.\n        @binding {number} index Índice de la definición de la columna.\n      "),(0,n.renderSlot)(a.$slots,"header",{column:e.column,index:e.index})])),bodyHeader:(0,n.withCtx)((e=>[(0,n.createCommentVNode)("\n        @slot Contenido de una celda de un encabezado de cuerpo.\n        @binding {number} groupIndex Índice de la definición del grupo.\n        @binding {object} group Referencia a la definición del grupo.\n        @binding {number} columnIndex Índice de la definición de la columna.\n        @binding {object} column Referencia a la definición de la columna.\n        @binding {Array} data Datos del grupo.\n      "),(0,n.renderSlot)(a.$slots,"bodyHeader",{groupIndex:e?.groupIndex,group:e?.group,columnIndex:e?.columnIndex,column:e?.column,data:e?.data})])),bodyFooter:(0,n.withCtx)((i=>[(0,n.createCommentVNode)("\n        @slot Contenido de una celda de un pie de cuerpo.\n        @binding {number} groupIndex Índice de la definición del grupo.\n        @binding {object} group Referencia a la definición del grupo.\n        @binding {number} columnIndex Índice de la definición de la columna.\n        @binding {object} column Referencia a la definición de la columna.\n        @binding {Array} data Datos del grupo.\n      "),(0,n.renderSlot)(a.$slots,"bodyFooter",{groupIndex:i?.groupIndex,group:i?.group,columnIndex:i?.columnIndex,column:i?.column,data:i?.data},(()=>["actions"!==i?.column?.key||e.readonly?((0,n.openBlock)(),(0,n.createElementBlock)("div",oo)):((0,n.openBlock)(),(0,n.createElementBlock)("div",lo,[(0,n.createVNode)(r,{type:"icon",icon:"Add",onClick:o[0]||(o[0]=e=>t("create"))})]))]))])),_:3},8,["columns","data","auto-layout","compact"])}}},so={__name:"list-item-tab-details",props:{list:{type:Object,required:!0},child:{type:Object,required:!0},entity:{type:Object,required:!0}},emits:["change"],setup(e){const t=e,a=(0,r.useRoute)(),i=(0,r.useRouter)(),{orderby:l,updateOrderby:o}=ki("orderby",{parse:_i,stringify:Mi}),d=(0,n.computed)((()=>Ti(t.child.listName))),s=(0,n.computed)((()=>t.child.fields.map((e=>d.value.fields.find((t=>t.name===e)))).filter((e=>e)))),u=(0,n.computed)((()=>t.entity[t.child.navigationKey||t.child.listName])),{sortedData:c}=Gi(u,l);function m(){const e=a.params.itemId,n=a.params.tabName;i.push({path:null==e?`/${t.list.name}/create/tab/${n}/create`:`/${t.list.name}/edit/${e}/tab/${n}/create`,query:a.query})}function p(e){const n=a.params.itemId,l=a.params.tabName;i.push({path:null==n?`/${t.list.name}/create/tab/${l}/edit/${e}`:`/${t.list.name}/edit/${n}/tab/${l}/edit/${e}`,query:a.query})}return(a,i)=>{const r=(0,n.resolveComponent)("router-view");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)((0,n.unref)(ro),{fields:(0,n.unref)(s),data:(0,n.unref)(c),orderby:(0,n.unref)(l),"auto-layout":e.child.autoLayout,readonly:e.child.readonly||!e.child.form,compact:"",onCreate:m,onEdit:p,"onUpdate:orderby":i[0]||(i[0]=e=>(0,n.unref)(o)(e))},null,8,["fields","data","orderby","auto-layout","readonly"]),(0,n.createVNode)(r,{list:e.list,entity:t.entity,onChange:i[1]||(i[1]=e=>a.$emit("change",e))},null,8,["list","entity"])],64)}}},uo=so,co={__name:"list-item-tab",props:{list:{type:Object,required:!0},entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,{tabName:i}=Ui("tabName"),l=(0,n.computed)((()=>a.list.form.tabs.find((e=>e.name===i.value))));return(a,i)=>"child"===(0,n.unref)(l).type?((0,n.openBlock)(),(0,n.createBlock)(uo,{key:0,list:e.list,child:(0,n.unref)(l),entity:e.entity,onChange:i[0]||(i[0]=e=>t("change",e))},null,8,["list","child","entity"])):((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:1},["auto"===(0,n.unref)(l).component?((0,n.openBlock)(),(0,n.createBlock)(ao,{key:0,list:e.list,subform:(0,n.unref)(l),entity:e.entity,validations:e.validations,onChange:i[1]||(i[1]=e=>t("change",e))},null,8,["list","subform","entity","validations"])):((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)((0,n.unref)(l).component),{key:1,list:e.list,child:(0,n.unref)(l),entity:e.entity,validations:e.validations,onChange:i[2]||(i[2]=e=>t("change",e))},null,40,["list","child","entity","validations"]))],64))}},mo={__name:"list-item-tab-child",props:{list:{type:Object,required:!0},entity:{type:Object,required:!0},splitted:{type:Boolean,default:!1}},emits:["change"],setup(e,{emit:t}){const a=e;(0,n.useCssVars)((e=>({"4c00a527":(0,n.unref)(S)})));const i=(0,r.useRoute)(),l=(0,r.useRouter)(),d=ue(),s=(0,o.useValidations)(),{sendMessage:u}=Xt(),c=(0,n.ref)(!1),{itemId:m}=Ui("itemId",{parse:e=>null!=e?Number(e):null}),{childId:p}=Ui("childId",{parse:e=>e?Number(e):null,handleLeave:!0}),{tabName:y}=Ui("tabName"),{popup:I}=ki("popup"),f=(0,n.computed)((()=>a.list.permissionDenied?.(a.entity)??{})),E=(0,n.computed)((()=>null==m.value?!f.value.create:!f.value.edit)),A=(0,n.computed)((()=>a.list.form.tabs.find((e=>e.name===y.value)))),T=(0,n.computed)((()=>Ti(A.value.listName))),C=(0,n.ref)({}),D=(0,n.getCurrentScope)();function N(e){const t=A.value.navigationKey||A.value.listName;null==e?(C.value=a.entity[t].create(),Se(T.value,C.value,{notOverwrite:!0})):C.value=(0,o.entityClone)(a.entity[t][e],{scope:D}),c.value&&(0,n.nextTick)((()=>ea(C.value)))}Jt(),(0,n.onMounted)((()=>{c.value=!0,N(p.value)})),(0,n.onUnmounted)(Qt);const g=a.list.fields.find((e=>e.primary)).name,v=(0,n.computed)((()=>C.value[g]));s.createField(g,v);const O=(0,n.computed)((()=>null===p.value?"Entrada nou element":"Modificació")),S=(0,n.computed)((()=>A.value.form.maxWidth));function b(e){e(C.value)}async function h(){if(await s.validate(C.value)){const e=A.value.navigationKey||A.value.listName;return a.splitted?await Ji((async()=>{if(await Fe(C.value),null==p.value){const e=A.value.navigationKey||A.value.listName;a.entity[e].add(C.value)}void 0!==I.value&&u({action:"save"})})):null==p.value?t("change",(t=>{t[e].add(C.value)})):t("change",(t=>{(0,o.entitySyncState)(t[e][p.value],C.value)})),!0}return!1}function R(){c.value=!1,(0,n.nextTick)((()=>l.push({path:null===m.value?`/${a.list.name}/create/tab/${y.value}`:`/${a.list.name}/edit/${m.value}/tab/${y.value}`,query:i.query})))}async function _(){await h()&&R()}async function M(){await h()&&(l.push({path:null===m.value?`/${a.list.name}/create/tab/${y.value}/create`:`/${a.list.name}/edit/${m.value}/tab/${y.value}/create`,query:i.query}),N())}function x(){d.confirm({title:"Alerta!",message:"Esteu segurs de que voleu desfer els canvis realitzats?.",accept(){N(p.value)}})}function L(){d.confirm({title:"Alerta!",message:"Esteu segurs de que voleu esborrar aquest element?. Aquesta acció no es pot desfer.",async accept(){const e=A.value.navigationKey||A.value.listName;a.splitted?await Ji((async()=>{await $e(C.value)})):t("change",(t=>{t[e].delete(p.value)})),R()}})}return(e,t)=>{const a=(0,n.resolveComponent)("fura-dialog"),i=(0,n.resolveComponent)("fura-overlay"),l=(0,n.resolveComponent)("fura-modal");return(0,n.openBlock)(),(0,n.createBlock)(l,{open:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(i,{class:"listItemEditTabChild-overlay",fixed:"",dark:""},{default:(0,n.withCtx)((()=>[c.value?((0,n.openBlock)(),(0,n.createBlock)(a,{key:0,class:"listItemEditTabChild-dialog",header:(0,n.unref)(O)},{default:(0,n.withCtx)((()=>[(0,n.createVNode)((0,n.unref)(Xi),{"max-width":(0,n.unref)(S),"self-aling":(0,n.unref)(A).form.selfAlign,"has-save":(0,n.unref)(E),"has-save-and-new":(0,n.unref)(E),"has-reset":"","has-remove":null!==(0,n.unref)(p)&&((0,n.unref)(E)||!(0,n.unref)(f).delete),"has-go-back":"",onSave:_,onSaveAndNew:M,onReset:x,onRemove:L,onGoBack:R},{default:(0,n.withCtx)((()=>["auto"===(0,n.unref)(A).form.component?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Zi),{key:0,list:(0,n.unref)(T),form:(0,n.unref)(A).form,entity:C.value,validations:(0,n.unref)(s),onChange:b},null,8,["list","form","entity","validations"])):((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)((0,n.unref)(A).form.component),{key:1,entity:C.value,validations:(0,n.unref)(s),onChange:b},null,40,["entity","validations"]))])),_:1},8,["max-width","self-aling","has-save","has-save-and-new","has-remove"])])),_:1},8,["header"])):(0,n.createCommentVNode)("v-if",!0)])),_:1})])),_:1})}}},po=(0,I.Z)(mo,[["__scopeId","data-v-5697d378"]]),yo={class:"dialogFooter"},Io={__name:"list-item-delete",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRouter)(),i=(0,r.useRoute)(),{itemId:l}=Ui("itemId",{parse:e=>null!=e?Number(e):null,stringify:e=>null!=e?String(e):void 0});function o(){a.push({path:`/${t.list.name}/view/query/${i.query.viewName}`,query:{...i.query,viewName:void 0}})}return(r,d)=>{const s=(0,n.resolveComponent)("fura-button"),u=(0,n.resolveComponent)("fura-dialog"),c=(0,n.resolveComponent)("fura-overlay");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(hi),{class:"itemListEdit-container","hide-menu":"",subtitle:e.list.label},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(c,{class:"modalOverlay",fixed:"",dark:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(u,{class:"dialogMessage",type:"close",header:"Confirmació d'eliminació",text:"Esteu segurs que voleu esborrar l'element?",onClick:o},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",yo,[(0,n.createVNode)(s,{primary:"",text:"Eliminar",onClick:d[0]||(d[0]=e=>async function(){await Ji((async()=>{await ge(`${t.list.name}(${l.value})`),a.push({path:`/${t.list.name}/view/query/${i.query.viewName}`,query:{...i.query,selectedItemId:void 0,viewName:void 0}})}))}())}),(0,n.createVNode)(s,{text:"Cancel·lar",onClick:o})])])),_:1})])),_:1})])),_:1},8,["subtitle"])}}};function fo(e){return[{path:`/${e.name}`,component:e.routes?.overrideControls?.ListDetailsDefault??rl,props:{list:e}},{path:`/${e.name}/view/query/:viewName`,component:e.routes?.overrideControls?.ListDetails??dl,props:{list:e},children:[{path:"filter",component:e.routes?.overrideControls?.ListDetailsFilterPanel??Ll,props:{list:e}},{path:"export",component:e.routes?.overrideControls?.ListDetailsExport??kl,props:{list:e}},...e.routes?.detailsListChildRoutes??[]]},{path:`/${e.name}/view/grid/:viewName`,component:e.routes?.overrideControls?.ListDetailsGrid??Tl,props:{list:e}},{path:`/${e.name}/view/create`,component:e.routes?.overrideControls?.ListViewEdit??Zl,props:{list:e}},{path:`/${e.name}/view/edit/:viewName`,component:e.routes?.overrideControls?.ListViewEdit??Zl,props:{list:e}},{path:`/${e.name}/create`,component:e.routes?.overrideControls?.ListItemEdit??eo,props:{list:e},children:[{path:"tab/:tabName",component:e.routes?.overrideControls?.ListItemTab??co,props:{list:e},children:[{path:"create",component:e.routes?.overrideControls?.ListItemTabChild??po,props:{list:e}},{path:"edit/:childId",component:e.routes?.overrideControls?.ListItemTabChild??po,props:{list:e}}]}]},{path:`/${e.name}/edit/:itemId`,component:e.routes?.overrideControls?.ListItemEdit??eo,props:{list:e},children:[{path:"tab/:tabName",component:e.routes?.overrideControls?.ListItemTab??co,props:{list:e},children:[{path:"create",component:e.routes?.overrideControls?.ListItemTabChild??po,props:{list:e}},{path:"edit/:childId",component:e.routes?.overrideControls?.ListItemTabChild??po,props:{list:e}}]}]},{path:`/${e.name}/delete/:itemId`,component:e.routes?.overrideControls?.ListItemDelete??Io,props:{list:e}},...e.routes?.cusomRoutes??[]]}const Eo={__name:"list-item-create",props:{list:{type:Object,required:!0},splitted:{type:Boolean,default:!1}},setup(e){const t=e,a=(0,r.useRoute)(),i=(0,r.useRouter)(),l=ue(),d=(0,o.useValidations)(),s=at(),{goBack:u}=$i(),{sendMessage:c,close:m}=Xt(),{tabName:p}=Ui("tabName"),{popup:y}=ki("popup");s.setContextName(t.list.name),s.load(t.list.name);const{entityLoaded:I,entity:f,resetEntity:E}=Jl(t.list);Jt(),(0,n.onMounted)((()=>ea(f))),(0,n.onUnmounted)(Qt);const A=t.list.fields.find((e=>e.primary)).name,T=(0,n.computed)((()=>f[A]));d.createField(A,T);const C=(0,n.computed)((()=>t.list.permissionDenied?.()??{})),D=(0,n.computed)((()=>t.list.form.tabs?.filter((e=>"child"!==e.type))?.map((e=>({text:e.title,value:e.name,icon:e.icon,count:e.count})))??[]));function N(e){e(f)}function g(e){i.push({path:`/${t.list.name}/create/tab/${e}`,query:{return:a.query.return,popup:y.value}})}async function v(){await d.validate(f)&&await Ji((async()=>{await Fe(f),u(`/${t.list.name}`,null,{reload:!0})}))}async function O(){await d.validate(f)&&await Ji((async()=>{await Fe(f),c({action:"save"}),m()}))}function S(){l.confirm({title:"Alerta!",message:"Esteu segurs de que voleu desfer els canvis realitzats?.",accept(){E(),(0,n.nextTick)((()=>ea(f)))}})}return(t,a)=>{const i=(0,n.resolveComponent)("router-view");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(hi),{class:"itemListEdit-container",subtitle:e.list.label},{default:(0,n.withCtx)((()=>[(0,n.unref)(I)?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Xi),{key:0,tabs:(0,n.unref)(D),"current-tab":(0,n.unref)(p),"max-width":e.list.form.maxWidth,"self-aling":e.list.form.selfAlign,"has-save":!(0,n.unref)(C).create&&void 0===(0,n.unref)(y),"has-save-and-close":!(0,n.unref)(C).create&&void 0!==(0,n.unref)(y),"has-reset":"","has-go-back":void 0===(0,n.unref)(y),"has-close":void 0!==(0,n.unref)(y),"onUpdate:currentTab":g,onSave:v,onSaveAndClose:O,onReset:S,onGoBack:a[0]||(a[0]=t=>(0,n.unref)(u)(`/${e.list.name}`)),onClose:(0,n.unref)(m)},{default:(0,n.withCtx)((()=>["auto"===e.list.form.component?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Zi),{key:0,list:e.list,form:e.list.form,entity:(0,n.unref)(f),validations:(0,n.unref)(d),onChange:N},null,8,["list","form","entity","validations"])):((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)(e.list.form.component),{key:1,entity:(0,n.unref)(f),validations:(0,n.unref)(d),onChange:N},null,40,["entity","validations"]))])),child:(0,n.withCtx)((()=>[(0,n.createVNode)(i,{entity:(0,n.unref)(f),validations:(0,n.unref)(d),onChange:N},null,8,["entity","validations"])])),_:1},8,["tabs","current-tab","max-width","self-aling","has-save","has-save-and-close","has-go-back","has-close","onClose"])):(0,n.createCommentVNode)("v-if",!0)])),_:1},8,["subtitle"])}}},Ao=(0,I.Z)(Eo,[["__scopeId","data-v-a1813330"]]);function To(e){return[{path:`/${e.name}`,component:e.routes?.overrideControls?.ListDetailsDefault??rl,props:{list:e}},{path:`/${e.name}/view/query/:viewName`,component:e.routes?.overrideControls?.ListDetails??dl,props:{list:e},children:[{path:"filter",component:e.routes?.overrideControls?.ListDetailsFilterPanel??Ll,props:{list:e}},{path:"export",component:e.routes?.overrideControls?.ListDetailsExport??kl,props:{list:e}},...e.routes?.detailsListChildRoutes??[]]},{path:`/${e.name}/view/grid/:viewName`,component:e.routes?.overrideControls?.ListDetailsGrid??Tl,props:{list:e}},{path:`/${e.name}/view/create`,component:e.routes?.overrideControls?.ListViewEdit??Zl,props:{list:e}},{path:`/${e.name}/view/edit/:viewName`,component:e.routes?.overrideControls?.ListViewEdit??Zl,props:{list:e}},{path:`/${e.name}/create`,component:e.routes?.overrideControls?.ListItemCreate??Ao,props:{list:e},children:[{path:"tab/:tabName",component:e.routes?.overrideControls?.ListItemTab??co,props:{list:e},children:[{path:"create",component:e.routes?.overrideControls?.ListItemTabChild??po,props:{list:e,splitted:!0}},{path:"edit/:childId",component:e.routes?.overrideControls?.ListItemTabChild??po,props:{list:e,splitted:!0}}]}]},{path:`/${e.name}/edit/:itemId`,component:e.routes?.overrideControls?.ListItemEdit??eo,props:{list:e,splitted:!0},children:[{path:"tab/:tabName",component:e.routes?.overrideControls?.ListItemTab??co,props:{list:e},children:[{path:"create",component:e.routes?.overrideControls?.ListItemTabChild??po,props:{list:e,splitted:!0}},{path:"edit/:childId",component:e.routes?.overrideControls?.ListItemTabChild??po,props:{list:e,splitted:!0}}]}]},{path:`/${e.name}/delete/:itemId`,component:e.routes?.overrideControls?.ListItemDelete??Io,props:{list:e}},...e.routes?.cusomRoutes??[]]}const Co={dictionary:e,listJoined:t,listSplitted:a},Do={class:"layout"},No={class:"form"},go={class:"logo"},vo=["src"],Oo=["onSubmit"],So={class:"label"},bo=["textContent"],ho=(e=>((0,n.pushScopeId)("data-v-5bb68f00"),e=e(),(0,n.popScopeId)(),e))((()=>(0,n.createElementVNode)("br",null,null,-1))),Ro={class:"buttons"},_o={class:"recovery"},Mo={__name:"user-login",setup(e){const t=(0,r.useRouter)(),a=m(),i=ue(),l=(0,n.reactive)({username:"",password:""});async function o(e){i.loadStart("user-login");const n=await fetch(`${pe}/authenticator/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(200===n.status){const e=await n.text();a.setJwt(e),t.push(Ce)}else if(401===n.status){const e=await n.text();i.alert({title:"Error:",message:e})}else i.alert({title:"Error:",message:"Error inesperat."});i.loadEnd("user-login")}return(0,n.onMounted)((()=>{a.jwt&&t.push(Ce)})),(e,a)=>{const i=(0,n.resolveComponent)("fura-text-field"),r=(0,n.resolveComponent)("fura-button"),d=(0,n.resolveComponent)("fura-link");return(0,n.openBlock)(),(0,n.createElementBlock)("div",Do,[(0,n.createElementVNode)("div",No,[(0,n.createElementVNode)("div",go,[(0,n.createElementVNode)("img",{src:`/${(0,n.unref)(ce)}/images/logo.png`,width:"160"},null,8,vo)]),(0,n.createElementVNode)("form",{onSubmit:(0,n.withModifiers)(o,["prevent"])},[(0,n.createElementVNode)("div",So,[(0,n.createElementVNode)("span",{style:{"font-weight":"600"},textContent:(0,n.toDisplayString)((0,n.unref)(me))},null,8,bo),ho,(0,n.createTextVNode)(" Entrada al sistema ")]),(0,n.createVNode)(i,{label:"Nom d'usuari",icon:"Contact",modelValue:l.username,"onUpdate:modelValue":a[0]||(a[0]=e=>l.username=e)},null,8,["modelValue"]),(0,n.createVNode)(i,{label:"Clau d'acces",password:"",icon:"Permissions",modelValue:l.password,"onUpdate:modelValue":a[1]||(a[1]=e=>l.password=e)},null,8,["modelValue"]),(0,n.createElementVNode)("div",Ro,[(0,n.createVNode)(r,{primary:"",text:"Entra","form-role":"submit"}),(0,n.createElementVNode)("div",_o,[(0,n.createVNode)(d,{onClick:a[2]||(a[2]=e=>(0,n.unref)(t).push("/password-reset-request"))},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Recupera la clau d'acces ")])),_:1})])])],40,Oo)])])}}},xo=(0,I.Z)(Mo,[["__scopeId","data-v-5bb68f00"]]),Lo=e=>((0,n.pushScopeId)("data-v-31aa8ac4"),e=e(),(0,n.popScopeId)(),e),Po={class:"layout"},wo={class:"form"},Vo={class:"logo"},Bo=["src"],Uo=["onSubmit"],ko={class:"label"},Fo=["textContent"],$o=Lo((()=>(0,n.createElementVNode)("br",null,null,-1))),qo=Lo((()=>(0,n.createElementVNode)("br",null,null,-1))),Ko={class:"buttons"},Go={__name:"user-password-reset-request",setup(e){const t=(0,r.useRouter)(),a=ue(),i=(0,n.ref)("");async function l(e){a.loadStart("password-reset"),200===(await fetch(`${pe}/authenticator/requestResetPassword`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Username:i.value})})).status?a.alert({title:"Acceptat!",message:"Sol·licitud acceptada, en breu rebrà un correu electronic amb les instruccions.",close:()=>t.push("/")}):a.alert({title:"Error",message:"No s'ha trobat l'usuari."}),a.loadEnd("password-reset")}return(e,t)=>{const a=(0,n.resolveComponent)("fura-text-field"),o=(0,n.resolveComponent)("fura-button");return(0,n.openBlock)(),(0,n.createElementBlock)("div",Po,[(0,n.createElementVNode)("div",wo,[(0,n.createElementVNode)("div",Vo,[(0,n.createElementVNode)("img",{src:`/${(0,n.unref)(ce)}/images/logo.png`,width:"160"},null,8,Bo)]),(0,n.createElementVNode)("form",{onSubmit:(0,n.withModifiers)(l,["prevent"])},[(0,n.createElementVNode)("div",ko,[(0,n.createElementVNode)("span",{style:{"font-weight":"600"},textContent:(0,n.toDisplayString)((0,n.unref)(me))},null,8,Fo),$o,(0,n.createTextVNode)(" Sol·licitar una nova clau d'accés "),qo]),(0,n.createVNode)(a,{label:"Nom d'usuari o adreça de correu electronic",icon:"Contact",modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=e=>i.value=e)},null,8,["modelValue"]),(0,n.createElementVNode)("div",Ko,[(0,n.createVNode)(o,{primary:"",text:"Sol·licitar canvi de clau d'acces","form-role":"submit"})])],40,Uo)])])}}},jo=(0,I.Z)(Go,[["__scopeId","data-v-31aa8ac4"]]),zo=e=>((0,n.pushScopeId)("data-v-57aae25c"),e=e(),(0,n.popScopeId)(),e),Wo={class:"layout"},Yo={class:"form"},Xo={class:"logo"},Ho=["src"],Zo=["onSubmit"],Jo={class:"label"},Qo=["textContent"],er=zo((()=>(0,n.createElementVNode)("br",null,null,-1))),tr=zo((()=>(0,n.createElementVNode)("br",null,null,-1))),ar={class:"showChars"},nr={class:"buttons"},ir={__name:"user-password-reset",setup(e){const t=(0,r.useRoute)(),a=(0,r.useRouter)(),i=ue(),l=(0,n.ref)(""),o=(0,n.ref)(""),d=(0,n.ref)(!1);async function s(e){i.loadStart("password-reset");const n=await fetch(`${pe}/authenticator/resetPassword`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:t.query.token},body:JSON.stringify({password:l.value})});if(200===n.status)i.alert({title:"Atenció!",message:"S'ha actualitzat la clau d'acces.",close:()=>a.push("/")});else if(401===n.status){const e=await n.text();i.alert({title:"Error",message:e})}else i.alert({title:"Error",message:"Error inesperat"});i.loadEnd("password-reset")}return(0,n.onMounted)((()=>{t.query.token||a.push("/")})),(e,t)=>{const a=(0,n.resolveComponent)("fura-text-field"),i=(0,n.resolveComponent)("fura-toggle"),r=(0,n.resolveComponent)("fura-button");return(0,n.openBlock)(),(0,n.createElementBlock)("div",Wo,[(0,n.createElementVNode)("div",Yo,[(0,n.createElementVNode)("div",Xo,[(0,n.createElementVNode)("img",{src:`/${(0,n.unref)(ce)}/images/logo.png`,width:"160"},null,8,Ho)]),(0,n.createElementVNode)("form",{onSubmit:(0,n.withModifiers)(s,["prevent"])},[(0,n.createElementVNode)("div",Jo,[(0,n.createElementVNode)("span",{style:{"font-weight":"600"},textContent:(0,n.toDisplayString)((0,n.unref)(me))},null,8,Qo),er,(0,n.createTextVNode)(" Establir la clau d'accés "),tr]),(0,n.createVNode)(a,{label:"Clau d'acces",password:!d.value,icon:"Permissions",modelValue:l.value,"onUpdate:modelValue":t[0]||(t[0]=e=>l.value=e)},null,8,["password","modelValue"]),(0,n.createVNode)(a,{label:"Repetir clau d'acces",password:!d.value,icon:"RepeatAll",modelValue:o.value,"onUpdate:modelValue":t[1]||(t[1]=e=>o.value=e)},null,8,["password","modelValue"]),(0,n.createElementVNode)("div",ar,[(0,n.createVNode)(i,{inline:"",label:"Mostrar caracters ",modelValue:d.value,"onUpdate:modelValue":t[2]||(t[2]=e=>d.value=e)},null,8,["modelValue"])]),(0,n.createElementVNode)("div",nr,[(0,n.createVNode)(r,{primary:"",text:"Canviar clau",disabled:!l.value||l.value!==o.value,"form-role":"submit"},null,8,["disabled"])])],40,Zo)])])}}},lr=(0,I.Z)(ir,[["__scopeId","data-v-57aae25c"]]),or={class:"layout"},rr={class:"form"},dr={class:"logo"},sr=["src"],ur=["onSubmit"],cr={class:"label"},mr=["textContent"],pr=(e=>((0,n.pushScopeId)("data-v-5d7407a6"),e=e(),(0,n.popScopeId)(),e))((()=>(0,n.createElementVNode)("br",null,null,-1))),yr={class:"showChars"},Ir={class:"buttons"},fr={__name:"user-password-change",setup(e){const t=(0,r.useRouter)(),a=m(),i=ue(),l=(0,n.ref)(""),o=(0,n.ref)(""),d=(0,n.ref)(""),s=(0,n.ref)(!1);async function u(e){i.loadStart("password-reset");const n=await fetch(`${pe}/authenticator/changePassword`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:a.jwt},body:JSON.stringify({oldPassword:l.value,newPassword:o.value})});if(406===n.status)i.alert({title:"Error",message:"Antiga clau d'acces incorrecte."});else if(200===n.status)i.alert({title:"Atenció!",message:"S'ha actualitzat la clau d'acces.",close:()=>{a.setJwt(),t.push("/")}});else if(401===n.status){const e=await n.text();i.alert({title:"Error",message:e})}else i.alert({title:"Error",message:"Error inesperat"});i.loadEnd("password-reset")}return(e,t)=>{const a=(0,n.resolveComponent)("fura-text-field"),i=(0,n.resolveComponent)("fura-toggle"),r=(0,n.resolveComponent)("fura-button");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(hi),{class:"baseLayout",subtitle:"Canvi de clau d'acces"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",or,[(0,n.createElementVNode)("div",rr,[(0,n.createElementVNode)("div",dr,[(0,n.createElementVNode)("img",{src:`/${(0,n.unref)(ce)}/images/logo.png`,width:"160"},null,8,sr)]),(0,n.createElementVNode)("form",{onSubmit:(0,n.withModifiers)(u,["prevent"])},[(0,n.createElementVNode)("div",cr,[(0,n.createElementVNode)("span",{style:{"font-weight":"600"},textContent:(0,n.toDisplayString)((0,n.unref)(me))},null,8,mr),pr,(0,n.createTextVNode)(" Canviar la paraula clau ")]),(0,n.createVNode)(a,{class:"oldPassword",label:"Antiga clau d'acces",password:!s.value,icon:"Permissions",modelValue:l.value,"onUpdate:modelValue":t[0]||(t[0]=e=>l.value=e)},null,8,["password","modelValue"]),(0,n.createVNode)(a,{label:"Nova clau d'acces",password:!s.value,icon:"PasswordField",modelValue:o.value,"onUpdate:modelValue":t[1]||(t[1]=e=>o.value=e)},null,8,["password","modelValue"]),(0,n.createVNode)(a,{label:"Repetir nova clau d'acces",password:!s.value,icon:"RepeatAll",modelValue:d.value,"onUpdate:modelValue":t[2]||(t[2]=e=>d.value=e)},null,8,["password","modelValue"]),(0,n.createElementVNode)("div",yr,[(0,n.createVNode)(i,{inline:"",label:"Mostrar caracters ",modelValue:s.value,"onUpdate:modelValue":t[3]||(t[3]=e=>s.value=e)},null,8,["modelValue"])]),(0,n.createElementVNode)("div",Ir,[(0,n.createVNode)(r,{primary:"",text:"Canviar clau",disabled:!o.value||o.value!==d.value,"form-role":"submit"},null,8,["disabled"])])],40,ur)])])])),_:1})}}},Er=(0,I.Z)(fr,[["__scopeId","data-v-5d7407a6"]]),Ar={__name:"home-view",setup:e=>(e,t)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(hi),{subtitle:"Inici"}))},Tr={class:"notFound-buttons"},Cr={__name:"not-found",setup:e=>(e,t)=>{const a=(0,n.resolveComponent)("fura-button"),i=(0,n.resolveComponent)("fura-dialog"),l=(0,n.resolveComponent)("fura-overlay");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(hi),{subtitle:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(l,{class:"notFound-overlay"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(i,{class:"notFound-dialog",header:"Error!",text:"Aquesta pàgina no esta definida."},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Tr,[(0,n.createVNode)(a,{icon:"Home",text:"Ves al inci",onClick:t[0]||(t[0]=t=>e.$router.push((0,n.unref)(Ce)))}),(0,n.createVNode)(a,{icon:"Back",text:"Torna enrere.",onClick:t[1]||(t[1]=t=>e.$router.go(-1))})])])),_:1})])),_:1})])),_:1})}},Dr=(0,I.Z)(Cr,[["__scopeId","data-v-5023a390"]]);async function Nr(e){for(let t=0;t<e.length;t++){if(e[t].links&&e[t].links.length>0)for(let a=0;a<e[t].links.length;a++)e[t].links[a].target.LINKTITLE=e[t].links[a].text;e[t].pares=[]}const t=e.map((e=>({ID_PROCES:e.ID_PROCES,CODI:e.CODI,TITLE:e.TITLE,NOMCURT:e.NOMCURT,ID_FORMABPMN:e.ID_FORMABPMN,ID_AGENT:e.ID_AGENT,ID_TIPUSAGENT:e.ID_TIPUSAGENT,ID_TIPUSTASCA:e.ID_TIPUSTASCA,DESCRIPCIO:e.DESCRIPCIO})));t.length>0&&vr(e,t,0)}function gr(e){function t(e,t){return[...e.querySelectorAll(t)]}function a(e,a,l,o,r){return function(e,a){return t(e,"GenericNode").filter((e=>a.every((a=>function(e,a,n){return t(e,`StyleProperties > Property[name="${a}"][value="${n}"]`).length>0}(e,a.name,a.value)))))}(e,l).map((e=>function(e,t,a,l){const o=[...t.querySelectorAll("node > data[key]")].filter((e=>l.some((t=>t.id===e.getAttribute("key"))))).map((e=>({id:e.getAttribute("key"),value:e.textContent||"(en blanc)"}))),r=o.length>0?o.reduce(((e,t)=>(e[l.find((e=>e.id===t.id)).name]=t.value,e)),{}):void 0,d=t.querySelector('Property[class="com.yworks.yfiles.bpmn.view.BPMNTypeEnum"][name="com.yworks.bpmn.type"]');return{id:t.attributes.id.value,label:n(t.querySelector("NodeLabel").textContent||"(en blanc)"),agent:i(e,t.querySelector("Geometry")),bpmnType:d?d.getAttribute("value"):void 0,childs:[],links:[],taskType:a,customProps:r}}(a,e.parentNode.parentNode,o,r)))}function n(e){return"string"==typeof e?e.replace(/\r\b|\r|\n/g," ").replace(/\s+/g," ").replace(/^\s+|\s+$/g,""):""}function i(e,t){const a=Number(t.getAttribute("x"));return e.find((e=>e.offset<=a&&a<e.offset+e.width))?.title}const l=(new DOMParser).parseFromString(e,"text/xml"),o=function(e,t){return[...e.querySelectorAll('graphml > key[for="node"][attr\\.name]')].filter((e=>t.includes(e.getAttribute("attr.name")))).map((e=>({name:e.getAttribute("attr.name"),id:e.getAttribute("id")})))}(l,["CODI","NOMTASCA","TIPUSTASCA","description"]),r=function(e){const t=e.querySelector("TableNode"),a=[...t.querySelectorAll("Columns > Column")].map((e=>({id:e.getAttribute("id"),width:Number(e.getAttribute("width")),title:n(t.querySelector(`ColumnNodeLabelModelParameter[id="${e.getAttribute("id")}"]`).parentNode.parentNode.textContent||"(en blanc)")})));return a.forEach(((e,t,a)=>e.offset=t>0?a[t-1].width+a[t-1].offset:0)),a}(l),d=[].concat(...[{name:"Inici de procés",styleProperties:[{name:"com.yworks.bpmn.type",value:"EVENT_TYPE_PLAIN"},{name:"com.yworks.bpmn.characteristic",value:"EVENT_CHARACTERISTIC_START"}]},{name:"Esdeveniment",styleProperties:[{name:"com.yworks.bpmn.type",value:"EVENT_TYPE_PLAIN"},{name:"com.yworks.bpmn.characteristic",value:"EVENT_CHARACTERISTIC_INTERMEDIATE_CATCHING"}]},{name:"Termini",styleProperties:[{name:"com.yworks.bpmn.type",value:"EVENT_TYPE_TIMER"},{name:"com.yworks.bpmn.characteristic",value:"EVENT_CHARACTERISTIC_INTERMEDIATE_CATCHING"}]},{name:"Missatge",styleProperties:[{name:"com.yworks.bpmn.type",value:"EVENT_TYPE_MESSAGE"},{name:"com.yworks.bpmn.characteristic",value:"EVENT_CHARACTERISTIC_INTERMEDIATE_CATCHING"}]},{name:"Interrupció del procés",styleProperties:[{name:"com.yworks.bpmn.type",value:"EVENT_TYPE_TERMINATE"},{name:"com.yworks.bpmn.characteristic",value:"EVENT_CHARACTERISTIC_END"}]},{name:"Fi de procés",styleProperties:[{name:"com.yworks.bpmn.type",value:"EVENT_TYPE_PLAIN"},{name:"com.yworks.bpmn.characteristic",value:"EVENT_CHARACTERISTIC_END"}]},{name:"Tasca",styleProperties:[{name:"com.yworks.bpmn.activityType",value:"ACTIVITY_TYPE_TASK"}]},{name:"Subprocés",styleProperties:[{name:"com.yworks.bpmn.activityType",value:"ACTIVITY_TYPE_TRANSACTION"}]},{name:"Gateway",styleProperties:[{name:"com.yworks.bpmn.type",value:"GATEWAY_TYPE_PLAIN"}]},{name:"Gateway exclusiu",styleProperties:[{name:"com.yworks.bpmn.type",value:"GATEWAY_TYPE_DATA_BASED_EXCLUSIVE"}]},{name:"Gateway inclusiu",styleProperties:[{name:"com.yworks.bpmn.type",value:"GATEWAY_TYPE_INCLUSIVE"}]},{name:"Gateway paral·lel",styleProperties:[{name:"com.yworks.bpmn.type",value:"GATEWAY_TYPE_PARALLEL"}]},{name:"Evidència d'entrada",styleProperties:[{name:"com.yworks.bpmn.dataObjectType",value:"DATA_OBJECT_TYPE_INPUT"}]},{name:"Evidència de sortida",styleProperties:[{name:"com.yworks.bpmn.dataObjectType",value:"DATA_OBJECT_TYPE_OUTPUT"}]}].map((e=>a(l,r,e.styleProperties,e.name,o)))),s=t(l,"edge");for(const e of s){const t=e.attributes.source.value,a=e.attributes.target.value,i=d.find((e=>e.id===t)),l=d.find((e=>e.id===a));if(!i||!l)continue;i.childs.push(l);const o=e.querySelector("EdgeLabel");o&&i.links.push({text:n(o.textContent||"(en blanc)"),target:l})}return d}async function vr(e,t,a){const n=m(),i=ue();0===a&&i.alert({title:"Importació",message:"Gravant tasques"});const l=await fetch(`${pe}/TASCA`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:n.jwt},body:JSON.stringify(t[a])}),o=await l.text();if(201!==l.status)i.alert({title:"Importació diagrama yEd",message:`Error al gravar la tasca "${e[a].NOMCURT||""}". Procés finalitzat`});else if(a<t.length-1)e[a].ID=JSON.parse(o).ID,vr(e,t,a+1);else{e[a].ID=JSON.parse(o).ID;for(let t=0;t<e.length;t++)if(e[t].ID&&e[t].ID>0&&e[t].childs&&e[t].childs.length>0)for(let a=0;a<e[t].childs.length;a++)e[t].childs[a]&&e[t].childs[a].pares&&e[t].childs[a].pares.push(e[t].ID);await Or(e,0),i.alertClose(),i.alert({title:"Importació diagrama yEd",message:"Càrrega de tasques finalitzada"})}}async function Or(e,t){const a=m();if(e[t].pares.length>0){for(let n=0;n<e[t].pares.length;n++)await fetch(`${pe}/TASCA_PRECEDENT`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:a.jwt},body:JSON.stringify({ID_TASCA:e[t].ID,ID_TASCA_PRECEDENT:e[t].pares[n]})});t<e.length-1&&Or(e,t+1)}else t<e.length-1&&Or(e,t+1)}const Sr={class:"IMPORTAR_FLOW_CHART"},br={style:{"grid-area":"BOTONS","margin-top":"24px","text-align":"center"}},hr={__name:"importar-flowchart",setup(e){const t=(0,r.useRouter)(),a=(0,r.useRoute)(),i=(0,n.reactive)({agentsFlow:[],agents:[]});let l=null;const o=ue(),d=(0,n.computed)((()=>0===i.agentsFlow.length||i.agentsFlow.length!==i.agentsFlow.filter((e=>!!e.ID)).length)),s=[{title:"Agent definit en el diagrama yEd",key:"TITLE"},{title:"Agent a assignar (cal assignar-los tots)",key:"ID"}];function u(){const e=a.query.return.includes("?")?"&":"?";t.push(`${a.query.return}${e}reload=true`)}return(0,n.onMounted)((async()=>{document.getElementById("upload")&&document.getElementById("upload").remove();const e=document.createElement("input");e.accept=".graphml",e.type="file",e.id="upload",e.style.visibility="hidden",document.body.appendChild(e);const t=document.getElementById("upload");t.addEventListener("change",(function(){t.files.length>0&&async function(e){o.alert({title:"Importació",message:"Llegint diagrama yEd"});const t=await Ne("AGENT",{$select:["ID","CODIINOM","ID_TIPUSAGENT"],$orderby:"CODIINOM"});i.agents=t.value.map((e=>({value:e.ID,text:e.CODIINOM,ID_TIPUSAGENT:e.ID_TIPUSAGENT})));const a=new FileReader(e);a.onload=async function(){const e=a.result.replace(/\r\n/g,"");l=gr(e);for(let e=0;e<l.length;e++)0===i.agentsFlow.filter((t=>t.TITLE===l[e].agent)).length&&i.agentsFlow.push({TITLE:l[e].agent,ID:i.agents.find((t=>t.text===l[e].agent))?.value});o.alertClose()},a.readAsText(e.files[0])}(t)}),!1),t.click()})),(e,t)=>{const r=(0,n.resolveComponent)("fura-dropdown"),c=(0,n.resolveComponent)("fura-details-list"),m=(0,n.resolveComponent)("fura-button");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(hi),{subtitle:"Importar flow-chart yEd"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Sr,[(0,n.createVNode)(c,{style:{"grid-area":"AGENTS"},columns:s,data:i.agentsFlow},{default:(0,n.withCtx)((e=>["ID"===e.column.key?((0,n.openBlock)(),(0,n.createBlock)(r,{key:0,options:i.agents,"model-value":i.agentsFlow[e.rowIndex].ID,"onUpdate:modelValue":t=>function(e,t){i.agentsFlow[e].ID=t}(e.rowIndex,t)},null,8,["options","model-value","onUpdate:modelValue"])):(0,n.createCommentVNode)("v-if",!0)])),_:1},8,["data"]),(0,n.createElementVNode)("div",br,[(0,n.createVNode)(m,{class:"boto",text:"Importar",icon:"PDF",disabled:(0,n.unref)(d),onClick:t[0]||(t[0]=e=>async function(){const e=(await Ne("TIPUSTASCA",{$select:"ID, TITLE"})).value,t=(await Ne("FORMA_BPMN",{$select:"ID, TITLE",$expand:"TIPUSTASCA_FORMABPMN($select=ID_TIPUSTASCA)",$orderby:"ID"})).value;for(let n=0;n<l.length;n++)l[n].ID_PROCES=parseInt(a.query.id),l[n].TITLE=l[n]?.customProps?.NOMTASCA||l[n].label||"(en blanc)",l[n].NOMCURT=l[n].label||"(en blanc)",l[n].ID_FORMABPMN=t.find((e=>e.TITLE===l[n].taskType))?.ID,l[n].ID_AGENT=i.agentsFlow.find((e=>e.TITLE===l[n].agent))?.ID,l[n].ID_TIPUSAGENT=i.agents.find((e=>e.value===l[n].ID_AGENT))?.ID_TIPUSAGENT,l[n].DESCRIPCIO=l[n].customProps?.description,l[n].CODI=l[n].customProps&&l[n].customProps.CODI?l[n].customProps.CODI:"T-"+(10*(n+1)).toString(),l[n].customProps&&l[n].customProps.TIPUSTASCA?l[n].ID_TIPUSTASCA=e.find((e=>e.TITLE===l[n].customProps.TIPUSTASCA))?.ID||2:t.find((e=>e.ID===l[n].ID_FORMABPMN)).length>0?l[n].ID_TIPUSTASCA=t.find((e=>e.ID===l[n].ID_FORMABPMN))[0].TIPUSTASCA_FORMABPMN[0].ID_TIPUSTASCA:l[n].ID_TIPUSTASCA=1;const n=l.find(((e,t,a)=>l.some(((a,n)=>e.CODI===a.CODI&&t!==n)))),r=l.filter((e=>1===e.ID_FORMABPMN)).length;1!==r?o.alert({title:"Importació diagrama yEd",message:0===r?"Manca tasca d'inici":"Hi ha més d'una tasca d'inici"}):n?o.alert({title:"Importació diagrama yEd",message:`Tasca "${n.NOMCURT}" té el codi "${n.CODI}" que també té una altre tasca`}):await Nr(l),u()}())},null,8,["disabled"]),(0,n.createVNode)(m,{class:"boto",text:"Tornar",icon:"ChromeClose",onClick:u})])])])),_:1})}}},Rr=(0,I.Z)(hr,[["__scopeId","data-v-0a2b7754"]]),_r=[];for(const e of Ti()){const t=Co[e.type];t&&t.getRoutes&&_r.push(...t.getRoutes(e))}const Mr=(0,r.createRouter)({history:(0,r.createWebHistory)(ce),routes:_r.concat([{path:"/",component:xo,meta:{anonymousAccess:!0}},{path:"/password-reset-request",component:jo,meta:{anonymousAccess:!0}},{path:"/password-reset",component:lr,meta:{anonymousAccess:!0}},{path:"/password-change",component:Er},{path:"/home",component:Ar},{path:"/importarFlowChart",component:Rr},{path:"/:catchAll(.*)",component:Dr}])});Mr.beforeEach((e=>{const t=m();if(!e.meta.anonymousAccess&&!t.jwt)return{path:"/",query:{redirect:e.fullPath}}}));const xr=Mr,Lr={__name:"dialog-loading",setup(e){const t=ue();return(e,a)=>{const i=(0,n.resolveComponent)("fura-spinner"),l=(0,n.resolveComponent)("fura-dialog"),o=(0,n.resolveComponent)("fura-overlay"),r=(0,n.resolveComponent)("fura-modal");return(0,n.openBlock)(),(0,n.createBlock)(r,{open:(0,n.unref)(t).loading.size>0},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(o,{class:"dialogLoading-overlay",fixed:"",dark:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(l,{class:"dialogLoading-loading"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(i,{label:"Carregant..."})])),_:1})])),_:1})])),_:1},8,["open"])}}},Pr=(0,I.Z)(Lr,[["__scopeId","data-v-69be9a34"]]),wr={class:"dialogAlert-close"},Vr={__name:"dialog-alert",setup(e){const t=ue(),a=(0,n.computed)((()=>t.alertList.length>0)),i=(0,n.computed)((()=>t.alertList[0]));return(e,l)=>{const o=(0,n.resolveComponent)("fura-button"),r=(0,n.resolveComponent)("fura-dialog"),d=(0,n.resolveComponent)("fura-overlay"),s=(0,n.resolveComponent)("fura-modal");return(0,n.openBlock)(),(0,n.createBlock)(s,{open:(0,n.unref)(a)},{default:(0,n.withCtx)((()=>[(0,n.unref)(a)?((0,n.openBlock)(),(0,n.createBlock)(d,{key:0,class:"dialogAlert-overlay",fixed:"",dark:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(r,{class:"dialogAlert-dialog",type:"close",header:(0,n.unref)(i).title,text:(0,n.unref)(i).message,onClick:l[1]||(l[1]=e=>(0,n.unref)(t).alertClose())},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",wr,[(0,n.createVNode)(o,{text:"Tancar",onClick:l[0]||(l[0]=e=>(0,n.unref)(t).alertClose())})])])),_:1},8,["header","text"])])),_:1})):(0,n.createCommentVNode)("v-if",!0)])),_:1},8,["open"])}}},Br=(0,I.Z)(Vr,[["__scopeId","data-v-69b9f90a"]]),Ur={class:"dialogConfirm-close"},kr={__name:"dialog-confirm",setup(e){const t=ue(),a=(0,n.computed)((()=>t.confirmList.length>0)),i=(0,n.computed)((()=>t.confirmList[0]));return(e,l)=>{const o=(0,n.resolveComponent)("fura-button"),r=(0,n.resolveComponent)("fura-dialog"),d=(0,n.resolveComponent)("fura-overlay"),s=(0,n.resolveComponent)("fura-modal");return(0,n.openBlock)(),(0,n.createBlock)(s,{open:(0,n.unref)(a)},{default:(0,n.withCtx)((()=>[(0,n.unref)(a)?((0,n.openBlock)(),(0,n.createBlock)(d,{key:0,class:"dialogConfirm-overlay",fixed:"",dark:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(r,{class:"dialogConfirm-dialog",header:(0,n.unref)(i).title,text:(0,n.unref)(i).message},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Ur,[(0,n.createVNode)(o,{primary:"",text:(0,n.unref)(i).confirmButton||"Si",onClick:l[0]||(l[0]=e=>(0,n.unref)(t).confirmAccept())},null,8,["text"]),(0,n.createVNode)(o,{text:(0,n.unref)(i).cancelButton||"No",onClick:l[1]||(l[1]=e=>(0,n.unref)(t).confirmCancel())},null,8,["text"])])])),_:1},8,["header","text"])])),_:1})):(0,n.createCommentVNode)("v-if",!0)])),_:1},8,["open"])}}},Fr=(0,I.Z)(kr,[["__scopeId","data-v-0cb2bae0"]]),$r={__name:"app",setup:e=>(e,t)=>{const a=(0,n.resolveComponent)("router-view");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)(a),(0,n.createVNode)((0,n.unref)(Pr)),(0,n.createVNode)((0,n.unref)(Br)),(0,n.createVNode)((0,n.unref)(Fr))],64)}},qr=(0,n.createApp)($r);qr.use((0,i.createPinia)()),qr.use(l),qr.use(o),qr.use(xr),qr.mount("#app");const Kr=qr})(),u.default})()));
